2025-06-09 16:23:20,922 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_da640d6c_01010101_caja_cerveza_tecate_24_piezas: '_GeneratorContextManager' object has no attribute 'query'
2025-06-09 16:23:20,925 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process sample_test.xml: '_GeneratorContextManager' object has no attribute 'close'
2025-06-09 16:23:20,955 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:23:20,957 - __main__ - ERROR - File: main.py - File: main.py - File: main.py - File: main.py - File: main.py - Single file processing failed
2025-06-09 16:30:26,068 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_141a86f5_10161506_naranja: '_GeneratorContextManager' object has no attribute 'query'
2025-06-09 16:30:26,070 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml: '_GeneratorContextManager' object has no attribute 'close'
2025-06-09 16:30:26,100 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:30:26,102 - __main__ - ERROR - File: main.py - File: main.py - File: main.py - File: main.py - File: main.py - Single file processing failed
2025-06-09 16:38:05,395 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:05,397 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_141a86f5_10161506_naranja: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:08,409 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:08,411 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:08,412 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:08,415 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_9a57e1c2_50304100_limon_sin_semilla: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:11,464 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:11,472 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9a57e1c2_50304100_limon_sin_semilla: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:11,479 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:11,488 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:14,506 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:14,509 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:14,514 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:14,520 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:17,536 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:17,538 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:17,541 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:17,549 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_3823c19d_50405300_cebolla_blanca: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:20,565 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:20,568 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_3823c19d_50405300_cebolla_blanca: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:20,574 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:20,582 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_65d00f8a_50404101_albahaca: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:23,596 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:23,600 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_65d00f8a_50404101_albahaca: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:23,605 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:23,610 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_44f0bbec_50403900_calabaza_negra: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:26,623 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:26,626 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_44f0bbec_50403900_calabaza_negra: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:26,628 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:26,631 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_9694c503_50403500_berenjena: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:29,646 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:29,647 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9694c503_50403500_berenjena: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:29,655 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:29,657 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_09573e71_50417006_arugula: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:32,668 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:32,670 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_09573e71_50417006_arugula: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:32,672 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:32,676 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_6a416cf3_50131800_queso_fresco: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:35,687 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:35,688 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a416cf3_50131800_queso_fresco: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:35,691 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:35,697 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_2df84722_50221001_arroz_verde_valle_500gr: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:38,710 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:38,713 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_2df84722_50221001_arroz_verde_valle_500gr: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:38,717 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:38,719 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_c0496069_50406500_tomate_salades: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:41,731 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:41,733 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_c0496069_50406500_tomate_salades: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:41,735 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:41,739 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_11cd495e_50401700_aguacate: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:44,752 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:44,756 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_11cd495e_50401700_aguacate: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:44,763 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:44,769 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_ac43b4be_27112003_rastrillo: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:47,794 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:47,796 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_ac43b4be_27112003_rastrillo: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:47,806 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:47,814 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:50,833 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:50,835 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:50,839 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:50,840 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_d71b9f5d_52152200_fibra: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:53,850 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:53,852 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_d71b9f5d_52152200_fibra: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:53,855 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: [<class 'decimal.ConversionSyntax'>]
2025-06-09 16:38:53,856 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: [<class 'decimal.ConversionSyntax'>]
2025-06-09 16:38:53,857 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml: Failed to save invoice to database
2025-06-09 16:38:53,859 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:53,862 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:53,884 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:53,886 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_da640d6c_01010101_caja_cerveza_tecate_24_piezas: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:56,920 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:56,922 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_da640d6c_01010101_caja_cerveza_tecate_24_piezas: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:56,926 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:56,931 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_c7a4b12e_01010102_cebolla_blanca: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:59,939 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:59,942 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_c7a4b12e_01010102_cebolla_blanca: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:38:59,947 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:38:59,949 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_da1ad129_01010103_huevos_blancos_paquete_12_piezas: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:02,958 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:39:02,959 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_da1ad129_01010103_huevos_blancos_paquete_12_piezas: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:39:02,961 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:02,963 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_804563e4_01010104_aceite_vegetal_1_litro: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:05,993 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:39:05,993 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_804563e4_01010104_aceite_vegetal_1_litro: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:39:05,995 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:05,996 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Error checking approved SKU sku_530c4adf_80161500_servicio_de_entrega: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:09,006 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:39:09,007 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_530c4adf_80161500_servicio_de_entrega: Gemini API failed after 3 attempts: Unknown field for GenerateContentRequest: request_options
2025-06-09 16:39:09,011 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:09,012 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:09,015 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process sample_test.xml: Failed to save invoice to database
2025-06-09 16:39:09,019 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:39:09,022 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[InvoiceMetadata(invoice_metadata)]'. Original exception was: Mapper 'Mapper[Invoice(invoices)]' has no property 'metadata'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-09 16:41:01,657 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: [<class 'decimal.ConversionSyntax'>]
2025-06-09 16:41:01,659 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: [<class 'decimal.ConversionSyntax'>]
2025-06-09 16:41:01,660 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml: Failed to save invoice to database
2025-06-09 16:42:49,696 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: [<class 'decimal.ConversionSyntax'>]
2025-06-09 16:42:49,699 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: [<class 'decimal.ConversionSyntax'>]
2025-06-09 16:42:49,701 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml: Failed to save invoice to database
2025-06-09 16:48:22,698 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 16:48:22,700 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 16:48:26,923 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 16:48:26,931 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9a57e1c2_50304100_limon_sin_semilla: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 16:48:30,568 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 16:48:30,575 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:26,514 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:26,519 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:30,034 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:30,040 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9a57e1c2_50304100_limon_sin_semilla: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:33,548 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:33,561 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:37,090 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:03:37,093 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:23,095 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:23,100 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:26,606 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:26,609 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9a57e1c2_50304100_limon_sin_semilla: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:30,090 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:30,091 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:33,573 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:09:33,578 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:11:28,610 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:11:28,617 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:34:36,839 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:34:36,840 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:09,764 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:09,765 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_141a86f5_10161506_naranja: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:13,235 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:13,240 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9a57e1c2_50304100_limon_sin_semilla: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:16,716 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:16,720 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:20,193 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:20,197 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:23,690 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:23,692 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_3823c19d_50405300_cebolla_blanca: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:27,214 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:27,217 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_65d00f8a_50404101_albahaca: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:30,701 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:30,704 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_44f0bbec_50403900_calabaza_negra: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:34,181 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:34,186 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_9694c503_50403500_berenjena: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:37,644 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:37,646 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_09573e71_50417006_arugula: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:41,119 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:41,121 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a416cf3_50131800_queso_fresco: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:44,617 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:44,620 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_2df84722_50221001_arroz_verde_valle_500gr: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:48,134 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:48,186 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_c0496069_50406500_tomate_salades: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:51,833 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:51,835 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_11cd495e_50401700_aguacate: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:55,350 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:55,354 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_ac43b4be_27112003_rastrillo: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:58,878 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:40:58,878 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_6a2cfbaf_50131612_huevo_cartera_con_30pz: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:41:02,408 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:41:02,410 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_d71b9f5d_52152200_fibra: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-09 17:41:02,455 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (sqlite3.IntegrityError) UNIQUE constraint failed: invoices.uuid
[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', None, '50389', 'I', '4.0', '2025-06-10 00:41:02.419626', None, '2025-06-10 00:41:02.438807', '2025-06-10 00:41:02.438807', 'PIVV******RR4', 'VANESSA IVON PIÑUELAS VERDUGO', '612', None, None, None, 'YUGY******FK4', 'YASSER YUSSIF GONZALEZ', '23300', None, None, None, '99', None, 'PPD', None, 'MXN', 1.0, 1109.9, 0.0, 6.9, 0.0, 1116.8, 'aQfQopzRPLxulkiqjktVYxiduTpNrSwDB4dZP7PvCBUrQRR/5XUvRHyKPVX61EQKhLEtbj5g2e14t+RfCi5th3rxKRsSQZatC8ftc9fPXtn6MoSywmSTLDz8MnUjHtvHfEd2AHn3UshIjneQOCBbR ... (46 characters truncated) ... rrDojl3CGXeigZqDuSgBIdy6YMzLYlsUN1AomwMjwQI3a61pF3RBsIfZwnmvRHsUa0EOLHc+F5GQJHpWDynRz3zuGjxjQal24uz2XiSUXLqjGYLo3CrxBe+XbGJ8/wXE5Z5POE3AJ0QuszTCyyw==', '00001000000705018977', None, 'gJTwCIW7z1Ill/xpC6f2EBZYisQKGq7LKRPZyZ7Oq8fC074zWIb8qCpOIKEUNeEWBE1V+7PUvxSA44RrhqKq6+k1RZojgIrm8xqPO4uiItCDVFwlPK0Vyi6wUJNfrgnx2yCLped62LdAxyQrL+Gc4 ... (46 characters truncated) ... yPIGMDuKo3U+wIpQ2QhnK4R1ZFm/foyowBdQ8XzMXH2tw/9L1PSn1rUIZC0RpV7kOfmS5WQXsIOpkA6VQnRH7cNVBjC3XgOU1wyxKYRq9QBpE2aCA1wqm4qvDaofIEgXZRUjWTGBaz/JUfWpjoQ==', None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', '2025-06-10 00:41:02.421845', None, None, None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml', 10794, None, None, 'processed')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-09 17:41:02,460 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (sqlite3.IntegrityError) UNIQUE constraint failed: invoices.uuid
[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', None, '50389', 'I', '4.0', '2025-06-10 00:41:02.419626', None, '2025-06-10 00:41:02.438807', '2025-06-10 00:41:02.438807', 'PIVV******RR4', 'VANESSA IVON PIÑUELAS VERDUGO', '612', None, None, None, 'YUGY******FK4', 'YASSER YUSSIF GONZALEZ', '23300', None, None, None, '99', None, 'PPD', None, 'MXN', 1.0, 1109.9, 0.0, 6.9, 0.0, 1116.8, 'aQfQopzRPLxulkiqjktVYxiduTpNrSwDB4dZP7PvCBUrQRR/5XUvRHyKPVX61EQKhLEtbj5g2e14t+RfCi5th3rxKRsSQZatC8ftc9fPXtn6MoSywmSTLDz8MnUjHtvHfEd2AHn3UshIjneQOCBbR ... (46 characters truncated) ... rrDojl3CGXeigZqDuSgBIdy6YMzLYlsUN1AomwMjwQI3a61pF3RBsIfZwnmvRHsUa0EOLHc+F5GQJHpWDynRz3zuGjxjQal24uz2XiSUXLqjGYLo3CrxBe+XbGJ8/wXE5Z5POE3AJ0QuszTCyyw==', '00001000000705018977', None, 'gJTwCIW7z1Ill/xpC6f2EBZYisQKGq7LKRPZyZ7Oq8fC074zWIb8qCpOIKEUNeEWBE1V+7PUvxSA44RrhqKq6+k1RZojgIrm8xqPO4uiItCDVFwlPK0Vyi6wUJNfrgnx2yCLped62LdAxyQrL+Gc4 ... (46 characters truncated) ... yPIGMDuKo3U+wIpQ2QhnK4R1ZFm/foyowBdQ8XzMXH2tw/9L1PSn1rUIZC0RpV7kOfmS5WQXsIOpkA6VQnRH7cNVBjC3XgOU1wyxKYRq9QBpE2aCA1wqm4qvDaofIEgXZRUjWTGBaz/JUfWpjoQ==', None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', '2025-06-10 00:41:02.421845', None, None, None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml', 10794, None, None, 'processed')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-09 17:41:02,468 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml: Failed to save invoice to database
2025-06-09 17:42:09,167 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (sqlite3.IntegrityError) UNIQUE constraint failed: invoices.uuid
[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', None, '50389', 'I', '4.0', '2025-06-10 00:42:09.105549', None, '2025-06-10 00:42:09.139907', '2025-06-10 00:42:09.139907', 'PIVV******RR4', 'VANESSA IVON PIÑUELAS VERDUGO', '612', None, None, None, 'YUGY******FK4', 'YASSER YUSSIF GONZALEZ', '23300', None, None, None, '99', None, 'PPD', None, 'MXN', 1.0, 1109.9, 0.0, 6.9, 0.0, 1116.8, 'aQfQopzRPLxulkiqjktVYxiduTpNrSwDB4dZP7PvCBUrQRR/5XUvRHyKPVX61EQKhLEtbj5g2e14t+RfCi5th3rxKRsSQZatC8ftc9fPXtn6MoSywmSTLDz8MnUjHtvHfEd2AHn3UshIjneQOCBbR ... (46 characters truncated) ... rrDojl3CGXeigZqDuSgBIdy6YMzLYlsUN1AomwMjwQI3a61pF3RBsIfZwnmvRHsUa0EOLHc+F5GQJHpWDynRz3zuGjxjQal24uz2XiSUXLqjGYLo3CrxBe+XbGJ8/wXE5Z5POE3AJ0QuszTCyyw==', '00001000000705018977', None, 'gJTwCIW7z1Ill/xpC6f2EBZYisQKGq7LKRPZyZ7Oq8fC074zWIb8qCpOIKEUNeEWBE1V+7PUvxSA44RrhqKq6+k1RZojgIrm8xqPO4uiItCDVFwlPK0Vyi6wUJNfrgnx2yCLped62LdAxyQrL+Gc4 ... (46 characters truncated) ... yPIGMDuKo3U+wIpQ2QhnK4R1ZFm/foyowBdQ8XzMXH2tw/9L1PSn1rUIZC0RpV7kOfmS5WQXsIOpkA6VQnRH7cNVBjC3XgOU1wyxKYRq9QBpE2aCA1wqm4qvDaofIEgXZRUjWTGBaz/JUfWpjoQ==', None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', '2025-06-10 00:42:09.115910', None, None, None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml', 10794, None, None, 'processed')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-09 17:42:09,181 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (sqlite3.IntegrityError) UNIQUE constraint failed: invoices.uuid
[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ('AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', None, '50389', 'I', '4.0', '2025-06-10 00:42:09.105549', None, '2025-06-10 00:42:09.139907', '2025-06-10 00:42:09.139907', 'PIVV******RR4', 'VANESSA IVON PIÑUELAS VERDUGO', '612', None, None, None, 'YUGY******FK4', 'YASSER YUSSIF GONZALEZ', '23300', None, None, None, '99', None, 'PPD', None, 'MXN', 1.0, 1109.9, 0.0, 6.9, 0.0, 1116.8, 'aQfQopzRPLxulkiqjktVYxiduTpNrSwDB4dZP7PvCBUrQRR/5XUvRHyKPVX61EQKhLEtbj5g2e14t+RfCi5th3rxKRsSQZatC8ftc9fPXtn6MoSywmSTLDz8MnUjHtvHfEd2AHn3UshIjneQOCBbR ... (46 characters truncated) ... rrDojl3CGXeigZqDuSgBIdy6YMzLYlsUN1AomwMjwQI3a61pF3RBsIfZwnmvRHsUa0EOLHc+F5GQJHpWDynRz3zuGjxjQal24uz2XiSUXLqjGYLo3CrxBe+XbGJ8/wXE5Z5POE3AJ0QuszTCyyw==', '00001000000705018977', None, 'gJTwCIW7z1Ill/xpC6f2EBZYisQKGq7LKRPZyZ7Oq8fC074zWIb8qCpOIKEUNeEWBE1V+7PUvxSA44RrhqKq6+k1RZojgIrm8xqPO4uiItCDVFwlPK0Vyi6wUJNfrgnx2yCLped62LdAxyQrL+Gc4 ... (46 characters truncated) ... yPIGMDuKo3U+wIpQ2QhnK4R1ZFm/foyowBdQ8XzMXH2tw/9L1PSn1rUIZC0RpV7kOfmS5WQXsIOpkA6VQnRH7cNVBjC3XgOU1wyxKYRq9QBpE2aCA1wqm4qvDaofIEgXZRUjWTGBaz/JUfWpjoQ==', None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8', '2025-06-10 00:42:09.115910', None, None, None, 'AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml', 10794, None, None, 'processed')]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-09 17:42:09,202 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AB31CFD1-C61A-4637-A9C0-71B7C676AAA8.xml: Failed to save invoice to database
2025-06-12 18:38:43,184 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-12 18:38:43,188 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_7e77527c_30111601_cemento_gris_holcim_25kg: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-12 18:38:46,888 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-06-12 18:38:46,899 - src.processing.gemini_classifier - ERROR - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - File: gemini_classifier.py - Classification failed for sku_14c77eea_50414500_kale: Gemini API failed after 3 attempts: 400 API key not valid. Please pass a valid API key. [reason: "API_KEY_INVALID"
domain: "googleapis.com"
metadata {
  key: "service"
  value: "generativelanguage.googleapis.com"
}
, locale: "en-US"
message: "API key not valid. Please pass a valid API key."
]
2025-07-10 12:14:12,717 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:12,720 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:12,722 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 04061ab5-c50d-46f3-aba1-148bdc5c2333.xml: Failed to save invoice to database
2025-07-10 12:14:23,799 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:23,803 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:23,803 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml: Failed to save invoice to database
2025-07-10 12:14:27,607 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:27,607 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:27,607 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 0F8A00BD-D32D-4F47-851A-F1EBC7AEE7B3.xml: Failed to save invoice to database
2025-07-10 12:14:29,257 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:29,259 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:29,260 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml: Failed to save invoice to database
2025-07-10 12:14:34,463 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:34,466 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:34,466 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 14EC3352-40A7-4008-9A6F-882A27D4E343.xml: Failed to save invoice to database
2025-07-10 12:14:44,804 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:44,807 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:44,810 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 1C3D24B8-AE7B-4C38-9F3A-39BA15225883.xml: Failed to save invoice to database
2025-07-10 12:14:48,498 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:48,499 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:48,499 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 285452E8-72C8-4188-BB11-4170D357CC9B.xml: Failed to save invoice to database
2025-07-10 12:14:51,624 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:51,624 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:51,627 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml: Failed to save invoice to database
2025-07-10 12:14:53,365 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:53,367 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:14:53,371 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2DE2FB0E-380D-4DB4-801D-2DA95A989235.xml: Failed to save invoice to database
2025-07-10 12:15:08,936 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:08,941 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:08,943 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2b474195-45f6-4055-9848-2ca0f8e44f7a.xml: Failed to save invoice to database
2025-07-10 12:15:10,875 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:10,880 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:10,880 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 329AE5C9-CDB1-434B-B2FC-FFC6932E8DE8.xml: Failed to save invoice to database
2025-07-10 12:15:12,604 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:12,607 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:12,613 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 3F78A759-2E37-432D-A905-710FAA2EA1F4.xml: Failed to save invoice to database
2025-07-10 12:15:15,826 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:15,827 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:15,828 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 57D8103E-6131-4D36-A212-4039A44C74EA.xml: Failed to save invoice to database
2025-07-10 12:15:23,538 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:23,538 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:23,540 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml: Failed to save invoice to database
2025-07-10 12:15:26,867 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:26,870 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:26,872 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 670587E2-F5A5-4A27-8F10-58F5C605B1EC.xml: Failed to save invoice to database
2025-07-10 12:15:26,932 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:26,933 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:26,935 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 67F16CA4-C800-409C-97D7-5B366AE5E6D4.xml: Failed to save invoice to database
2025-07-10 12:15:28,696 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:28,698 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:28,699 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 6F0697AD-B159-42DD-8CEC-3E553EA1C944.xml: Failed to save invoice to database
2025-07-10 12:15:28,849 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:28,852 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:28,857 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 6F69F65C-0943-4D1B-91AF-3102A0D41C4D.xml: Failed to save invoice to database
2025-07-10 12:15:43,178 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:43,179 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:43,182 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7579E18A-2439-4BFF-A0F7-96B110FB3A40.xml: Failed to save invoice to database
2025-07-10 12:15:43,374 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:43,377 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:43,379 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7CB73D45-AF0A-434F-A1E0-902AC8314AC1.xml: Failed to save invoice to database
2025-07-10 12:15:53,950 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:53,952 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:53,953 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7D2019DB-CD61-4600-8F65-DD44ADF4FC0E.xml: Failed to save invoice to database
2025-07-10 12:15:55,460 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:55,461 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:55,462 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7E6332A9-BF15-4F9F-BE4F-CEADDF154AD7.xml: Failed to save invoice to database
2025-07-10 12:15:55,538 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:55,540 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:55,541 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml: Failed to save invoice to database
2025-07-10 12:15:55,743 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:55,744 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:55,746 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml: Failed to save invoice to database
2025-07-10 12:15:58,711 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:58,712 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:15:58,715 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 8AC2BFA4-8362-4291-B692-9C2D450198E4.xml: Failed to save invoice to database
2025-07-10 12:16:11,234 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:11,237 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:11,239 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 8CCD00E8-8EAC-4926-BE8F-0B57C8856E84.xml: Failed to save invoice to database
2025-07-10 12:16:13,212 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:13,213 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:13,213 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 978d18b7-b0c4-420d-9529-6c3eb2cac218.xml: Failed to save invoice to database
2025-07-10 12:16:13,318 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:13,319 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:13,320 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 9B316DDF-0827-4012-B8E8-9C08161BF41B.xml: Failed to save invoice to database
2025-07-10 12:16:14,643 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:14,646 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:14,647 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process ACF5E9D9-459A-485E-A8DF-9A2E14F03941.xml: Failed to save invoice to database
2025-07-10 12:16:16,386 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:16,387 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:16,388 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B696B7FF-E66C-46CF-A45D-D819C44431A3.xml: Failed to save invoice to database
2025-07-10 12:16:18,014 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:18,014 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:18,016 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process C8E39A35-3357-4C8F-AF22-534AFE703FEA.xml: Failed to save invoice to database
2025-07-10 12:16:22,677 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:22,678 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:22,679 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml: Failed to save invoice to database
2025-07-10 12:16:25,930 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:25,938 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:25,940 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml: Failed to save invoice to database
2025-07-10 12:16:29,714 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:29,714 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:29,722 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E3BAA208-BB42-49C5-9E72-D7702308F471.xml: Failed to save invoice to database
2025-07-10 12:16:31,118 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:31,124 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:31,125 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E507A17F-A130-4C08-8B4F-0FD300D02C85.xml: Failed to save invoice to database
2025-07-10 12:16:32,981 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:32,983 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:32,983 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process EFCD0679-9CE8-400D-8869-9B9D2C51DE62.xml: Failed to save invoice to database
2025-07-10 12:16:38,134 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:38,134 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:38,142 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml: Failed to save invoice to database
2025-07-10 12:16:40,912 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:40,913 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:40,913 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml: Failed to save invoice to database
2025-07-10 12:16:52,124 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:52,126 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 12:16:52,129 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process db7ca908-83b2-49ab-8c86-649a9b9ba470.xml: Failed to save invoice to database
2025-07-10 16:30:46,999 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:30:47,000 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:30:47,002 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 04061ab5-c50d-46f3-aba1-148bdc5c2333.xml: Failed to save invoice to database
2025-07-10 16:30:56,433 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:30:56,434 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:30:56,435 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml: Failed to save invoice to database
2025-07-10 16:30:57,896 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:30:57,898 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:30:57,899 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml: Failed to save invoice to database
2025-07-10 16:31:02,304 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:02,320 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:02,320 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml: Failed to save invoice to database
2025-07-10 16:31:09,074 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:09,075 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:09,078 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml: Failed to save invoice to database
2025-07-10 16:31:09,148 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:09,149 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:09,153 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml: Failed to save invoice to database
2025-07-10 16:31:09,195 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:09,198 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:09,199 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml: Failed to save invoice to database
2025-07-10 16:31:11,014 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:11,015 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:11,017 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 978d18b7-b0c4-420d-9529-6c3eb2cac218.xml: Failed to save invoice to database
2025-07-10 16:31:15,197 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:15,200 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:15,202 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B696B7FF-E66C-46CF-A45D-D819C44431A3.xml: Failed to save invoice to database
2025-07-10 16:31:19,395 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:19,397 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:19,398 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml: Failed to save invoice to database
2025-07-10 16:31:24,866 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:24,867 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:24,869 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml: Failed to save invoice to database
2025-07-10 16:31:26,171 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:26,171 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:26,171 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E507A17F-A130-4C08-8B4F-0FD300D02C85.xml: Failed to save invoice to database
2025-07-10 16:31:31,106 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:31,106 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:31,107 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml: Failed to save invoice to database
2025-07-10 16:31:33,754 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:33,755 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:33,757 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml: Failed to save invoice to database
2025-07-10 16:31:42,996 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:42,999 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:31:42,999 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process db7ca908-83b2-49ab-8c86-649a9b9ba470.xml: Failed to save invoice to database
2025-07-10 16:34:14,317 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:14,319 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:14,319 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 0F8A00BD-D32D-4F47-851A-F1EBC7AEE7B3.xml: Failed to save invoice to database
2025-07-10 16:34:18,977 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:18,982 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:18,984 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 14EC3352-40A7-4008-9A6F-882A27D4E343.xml: Failed to save invoice to database
2025-07-10 16:34:30,912 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:30,913 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:30,913 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 1C3D24B8-AE7B-4C38-9F3A-39BA15225883.xml: Failed to save invoice to database
2025-07-10 16:34:34,522 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:34,524 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:34,525 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 285452E8-72C8-4188-BB11-4170D357CC9B.xml: Failed to save invoice to database
2025-07-10 16:34:36,242 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:36,246 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:36,248 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2DE2FB0E-380D-4DB4-801D-2DA95A989235.xml: Failed to save invoice to database
2025-07-10 16:34:50,082 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:50,084 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:50,087 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2b474195-45f6-4055-9848-2ca0f8e44f7a.xml: Failed to save invoice to database
2025-07-10 16:34:51,548 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:51,549 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:51,551 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 329AE5C9-CDB1-434B-B2FC-FFC6932E8DE8.xml: Failed to save invoice to database
2025-07-10 16:34:55,717 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:55,719 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:34:55,721 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 3F78A759-2E37-432D-A905-710FAA2EA1F4.xml: Failed to save invoice to database
2025-07-10 16:35:00,428 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:00,430 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:00,431 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 57D8103E-6131-4D36-A212-4039A44C74EA.xml: Failed to save invoice to database
2025-07-10 16:35:03,548 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:03,551 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:03,552 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 670587E2-F5A5-4A27-8F10-58F5C605B1EC.xml: Failed to save invoice to database
2025-07-10 16:35:03,614 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:03,615 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:03,616 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 67F16CA4-C800-409C-97D7-5B366AE5E6D4.xml: Failed to save invoice to database
2025-07-10 16:35:06,574 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:06,576 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:06,578 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 6F0697AD-B159-42DD-8CEC-3E553EA1C944.xml: Failed to save invoice to database
2025-07-10 16:35:09,617 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:09,621 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:09,621 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 6F69F65C-0943-4D1B-91AF-3102A0D41C4D.xml: Failed to save invoice to database
2025-07-10 16:35:23,523 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:23,527 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:23,530 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7579E18A-2439-4BFF-A0F7-96B110FB3A40.xml: Failed to save invoice to database
2025-07-10 16:35:23,577 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:23,579 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:23,580 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7CB73D45-AF0A-434F-A1E0-902AC8314AC1.xml: Failed to save invoice to database
2025-07-10 16:35:32,771 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:32,771 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:32,771 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7D2019DB-CD61-4600-8F65-DD44ADF4FC0E.xml: Failed to save invoice to database
2025-07-10 16:35:34,104 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:34,117 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:34,118 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7E6332A9-BF15-4F9F-BE4F-CEADDF154AD7.xml: Failed to save invoice to database
2025-07-10 16:35:36,867 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:36,867 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:36,868 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 8AC2BFA4-8362-4291-B692-9C2D450198E4.xml: Failed to save invoice to database
2025-07-10 16:35:47,840 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:47,840 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:47,843 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 8CCD00E8-8EAC-4926-BE8F-0B57C8856E84.xml: Failed to save invoice to database
2025-07-10 16:35:48,112 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:48,113 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:48,113 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 9B316DDF-0827-4012-B8E8-9C08161BF41B.xml: Failed to save invoice to database
2025-07-10 16:35:49,380 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:49,380 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:49,382 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process ACF5E9D9-459A-485E-A8DF-9A2E14F03941.xml: Failed to save invoice to database
2025-07-10 16:35:51,154 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:51,156 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:51,158 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process C8E39A35-3357-4C8F-AF22-534AFE703FEA.xml: Failed to save invoice to database
2025-07-10 16:35:54,630 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:54,630 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:54,632 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E3BAA208-BB42-49C5-9E72-D7702308F471.xml: Failed to save invoice to database
2025-07-10 16:35:56,312 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:56,313 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: 'datetime.datetime' object has no attribute 'strip'
2025-07-10 16:35:56,313 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process EFCD0679-9CE8-400D-8869-9B9D2C51DE62.xml: Failed to save invoice to database
2025-07-11 16:38:34,545 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:38:34,551 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:38:46,456 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:38:46,457 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:38:48,745 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:38:48,746 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:38:54,288 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:38:54,289 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:03,418 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:03,420 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:05,708 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:05,711 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:06,485 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:06,487 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:09,428 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:09,430 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:15,188 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:15,189 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:21,567 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:21,568 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:28,612 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:28,613 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:30,438 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:30,439 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:36,232 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:36,235 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:40,021 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:40,022 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-11 16:39:50,991 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: 37 values for 38 columns
2025-07-11 16:39:50,992 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [PURCHASE_DETAILS] Failed to save to purchase_details table: 37 values for 38 columns
2025-07-14 14:22:35,464 - __main__ - ERROR - File: migrate_data.py - File: migrate_data.py - File: migrate_data.py - File: migrate_data.py - File: migrate_data.py - DATABASE_URL in .env file is not a PostgreSQL URL.
2025-07-14 14:34:01,005 - __main__ - ERROR - File: migrate_data.py - File: migrate_data.py - File: migrate_data.py - File: migrate_data.py - File: migrate_data.py - FAILED to migrate table 'invoice_items': (psycopg2.ProgrammingError) can't adapt type 'dict'
[SQL: INSERT INTO invoice_items (id, invoice_id, line_number, product_code, internal_code, description, quantity, unit_code, unit_description, units_per_package, package_description, unit_price, subtotal, discount, transferred_taxes, withheld_taxes, total_ ... 772648 characters truncated ... %(classification_timestamp__999)s, %(custom_fields__999)s, %(created_at__999)s, %(updated_at__999)s)]
[parameters: {'package_description__0': 'Saco', 'quantity__0': 5.0, 'sub_sub_category__0': 'Mantenimiento y conservación Oficina', 'category__0': 'Gastos Generales', 'standardized_unit__0': 'Kilogramos', 'conversion_factor__0': 25.0, 'created_at__0': datetime.datetime(2025, 6, 17, 23, 26, 55, 484636), 'standardized_quantity__0': 125.0, 'updated_at__0': datetime.datetime(2025, 6, 17, 23, 26, 55, 484636), 'subtotal__0': 797.41, 'sku_key__0': 'sku_7e77527c_30111601_cemento_gris_holcim_25kg', 'unit_description__0': None, 'withheld_taxes__0': None, 'subcategory__0': 'Mantenimiento y conservación Oficina', 'line_number__0': 1, 'total_amount__0': 925.0, 'unit_price__0': 159.482, 'invoice_id__0': 1, 'description__0': 'CEMENTO GRIS HOLCIM 25KG', 'unit_code__0': 'H87', 'classification_source__0': 'gemini_api', 'classification_timestamp__0': datetime.datetime(2025, 6, 17, 23, 26, 55, 484636), 'custom_fields__0': {'processing_time': 2.403921127319336, 'api_attempt': 1, 'reasoning': "Cement is a construction material, so it falls under 'Suministros'. Since it's  ... (19 characters truncated) ... hen supply, it's classified as 'Otros' within 'Suministros Cocina'. The description indicates a 25kg bag, so units_per_package is 25.", 'error': None}, 'product_code__0': '30111601', 'total_tax_amount__0': 0, 'units_per_package__0': 25.0, 'discount__0': 0.0, 'id__0': 1, 'approval_status__0': 'approved', 'internal_code__0': None, 'transferred_taxes__0': None, 'category_confidence__0': 0.95, 'package_description__1': None, 'quantity__1': 0.46, 'sub_sub_category__1': 'Col', 'category__1': 'Vegetales', 'standardized_unit__1': 'Kilogramos', 'conversion_factor__1': 1.0, 'created_at__1': datetime.datetime(2025, 6, 17, 23, 27, 9, 841983), 'standardized_quantity__1': 0.46, 'updated_at__1': datetime.datetime(2025, 6, 17, 23, 27, 9, 841983), 'subtotal__1': 184.0, 'sku_key__1': 'sku_14c77eea_50414500_kale', 'unit_description__1': None, 'withheld_taxes__1': None, 'subcategory__1': 'Verduras', 'line_number__1': 1, 'total_amount__1': 184.0, 'unit_price__1': 400.0, 'invoice_id__1': 2 ... 31900 parameters truncated ... 'line_number__998': 11, 'total_amount__998': 120.0, 'unit_price__998': 240.0, 'invoice_id__998': 115, 'description__998': 'SHALLOT', 'unit_code__998': 'KGM', 'classification_source__998': 'approved_sku', 'classification_timestamp__998': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'custom_fields__998': {'processing_time': 0.0, 'api_attempt': None, 'reasoning': None, 'error': None}, 'product_code__998': '50403800', 'total_tax_amount__998': 0, 'units_per_package__998': 1.0, 'discount__998': 0.0, 'id__998': 999, 'approval_status__998': 'approved', 'internal_code__998': None, 'transferred_taxes__998': None, 'category_confidence__998': 1.0, 'package_description__999': None, 'quantity__999': 1.0, 'sub_sub_category__999': 'Lechuga Mixta', 'category__999': 'Vegetales', 'standardized_unit__999': 'Kilogramos', 'conversion_factor__999': 0.454, 'created_at__999': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'standardized_quantity__999': 1.0, 'updated_at__999': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'subtotal__999': 130.0, 'sku_key__999': 'sku_f6ce5c99_50404600_lechuga_mixta', 'unit_description__999': None, 'withheld_taxes__999': None, 'subcategory__999': 'Verduras', 'line_number__999': 12, 'total_amount__999': 130.0, 'unit_price__999': 130.0, 'invoice_id__999': 115, 'description__999': 'LECHUGA MIXTA', 'unit_code__999': 'H87', 'classification_source__999': 'gemini_api', 'classification_timestamp__999': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'custom_fields__999': {'processing_time': 1.4898877143859863, 'api_attempt': 1, 'reasoning': "The item is 'LECHUGA MIXTA' which is 'Lechuga Mixta' in the Vegetables > Verdu ... (23 characters truncated) ... s a vegetable, the standardized unit is Kilogramos. The quantity is 1 and there is no package information, so units_per_package is 1.", 'error': None}, 'product_code__999': '50404600', 'total_tax_amount__999': 0, 'units_per_package__999': 0.454, 'discount__999': 0.0, 'id__999': 1000, 'approval_status__999': 'approved', 'internal_code__999': None, 'transferred_taxes__999': None, 'category_confidence__999': 0.95}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 2112, in _exec_insertmany_context
    dialect.do_execute(
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
psycopg2.ProgrammingError: can't adapt type 'dict'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\Lenovo.DESKTOP-IFK4702\Desktop\02. PROGRAMACION\01. TRAINING EXCERSISES\01. Proyecto Costeo Facturas_v3\scripts\migrate_data.py", line 120, in migrate_data
    df.to_sql(
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\core\generic.py", line 3084, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py", line 1567, in insert_records
    raise err
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\pandas\io\sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 1416, in execute
    return meth(
           ^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\sql\elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 1843, in _execute_context
    return self._exec_insertmany_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 2120, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\base.py", line 2112, in _exec_insertmany_context
    dialect.do_execute(
  File "C:\Users\Lenovo.DESKTOP-IFK4702\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sqlalchemy\engine\default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'dict'
[SQL: INSERT INTO invoice_items (id, invoice_id, line_number, product_code, internal_code, description, quantity, unit_code, unit_description, units_per_package, package_description, unit_price, subtotal, discount, transferred_taxes, withheld_taxes, total_ ... 772648 characters truncated ... %(classification_timestamp__999)s, %(custom_fields__999)s, %(created_at__999)s, %(updated_at__999)s)]
[parameters: {'package_description__0': 'Saco', 'quantity__0': 5.0, 'sub_sub_category__0': 'Mantenimiento y conservación Oficina', 'category__0': 'Gastos Generales', 'standardized_unit__0': 'Kilogramos', 'conversion_factor__0': 25.0, 'created_at__0': datetime.datetime(2025, 6, 17, 23, 26, 55, 484636), 'standardized_quantity__0': 125.0, 'updated_at__0': datetime.datetime(2025, 6, 17, 23, 26, 55, 484636), 'subtotal__0': 797.41, 'sku_key__0': 'sku_7e77527c_30111601_cemento_gris_holcim_25kg', 'unit_description__0': None, 'withheld_taxes__0': None, 'subcategory__0': 'Mantenimiento y conservación Oficina', 'line_number__0': 1, 'total_amount__0': 925.0, 'unit_price__0': 159.482, 'invoice_id__0': 1, 'description__0': 'CEMENTO GRIS HOLCIM 25KG', 'unit_code__0': 'H87', 'classification_source__0': 'gemini_api', 'classification_timestamp__0': datetime.datetime(2025, 6, 17, 23, 26, 55, 484636), 'custom_fields__0': {'processing_time': 2.403921127319336, 'api_attempt': 1, 'reasoning': "Cement is a construction material, so it falls under 'Suministros'. Since it's  ... (19 characters truncated) ... hen supply, it's classified as 'Otros' within 'Suministros Cocina'. The description indicates a 25kg bag, so units_per_package is 25.", 'error': None}, 'product_code__0': '30111601', 'total_tax_amount__0': 0, 'units_per_package__0': 25.0, 'discount__0': 0.0, 'id__0': 1, 'approval_status__0': 'approved', 'internal_code__0': None, 'transferred_taxes__0': None, 'category_confidence__0': 0.95, 'package_description__1': None, 'quantity__1': 0.46, 'sub_sub_category__1': 'Col', 'category__1': 'Vegetales', 'standardized_unit__1': 'Kilogramos', 'conversion_factor__1': 1.0, 'created_at__1': datetime.datetime(2025, 6, 17, 23, 27, 9, 841983), 'standardized_quantity__1': 0.46, 'updated_at__1': datetime.datetime(2025, 6, 17, 23, 27, 9, 841983), 'subtotal__1': 184.0, 'sku_key__1': 'sku_14c77eea_50414500_kale', 'unit_description__1': None, 'withheld_taxes__1': None, 'subcategory__1': 'Verduras', 'line_number__1': 1, 'total_amount__1': 184.0, 'unit_price__1': 400.0, 'invoice_id__1': 2 ... 31900 parameters truncated ... 'line_number__998': 11, 'total_amount__998': 120.0, 'unit_price__998': 240.0, 'invoice_id__998': 115, 'description__998': 'SHALLOT', 'unit_code__998': 'KGM', 'classification_source__998': 'approved_sku', 'classification_timestamp__998': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'custom_fields__998': {'processing_time': 0.0, 'api_attempt': None, 'reasoning': None, 'error': None}, 'product_code__998': '50403800', 'total_tax_amount__998': 0, 'units_per_package__998': 1.0, 'discount__998': 0.0, 'id__998': 999, 'approval_status__998': 'approved', 'internal_code__998': None, 'transferred_taxes__998': None, 'category_confidence__998': 1.0, 'package_description__999': None, 'quantity__999': 1.0, 'sub_sub_category__999': 'Lechuga Mixta', 'category__999': 'Vegetales', 'standardized_unit__999': 'Kilogramos', 'conversion_factor__999': 0.454, 'created_at__999': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'standardized_quantity__999': 1.0, 'updated_at__999': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'subtotal__999': 130.0, 'sku_key__999': 'sku_f6ce5c99_50404600_lechuga_mixta', 'unit_description__999': None, 'withheld_taxes__999': None, 'subcategory__999': 'Verduras', 'line_number__999': 12, 'total_amount__999': 130.0, 'unit_price__999': 130.0, 'invoice_id__999': 115, 'description__999': 'LECHUGA MIXTA', 'unit_code__999': 'H87', 'classification_source__999': 'gemini_api', 'classification_timestamp__999': datetime.datetime(2025, 7, 11, 23, 38, 46, 301985), 'custom_fields__999': {'processing_time': 1.4898877143859863, 'api_attempt': 1, 'reasoning': "The item is 'LECHUGA MIXTA' which is 'Lechuga Mixta' in the Vegetables > Verdu ... (23 characters truncated) ... s a vegetable, the standardized unit is Kilogramos. The quantity is 1 and there is no package information, so units_per_package is 1.", 'error': None}, 'product_code__999': '50404600', 'total_tax_amount__999': 0, 'units_per_package__999': 0.454, 'discount__999': 0.0, 'id__999': 1000, 'approval_status__999': 'approved', 'internal_code__999': None, 'transferred_taxes__999': None, 'category_confidence__999': 0.95}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-17 18:49:41,451 - __main__ - ERROR - File: main.py - File: main.py - File: main.py - File: main.py - File: main.py - Purchase_details table creation failed
2025-07-18 15:20:59,837 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'details': '{"filename": "04061ab5-c50d-46f3-aba1-148bdc5c2333.xml", "processing_time": 3.393923759460449, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 04061ab5-c50d-46f3-aba1-148bdc5c2333 already exists"}', 'execution_time': 3.393923759460449, 'memory_usage': None, 'filename': '04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 20, 59, 291984)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:20:59,838 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'details': '{"filename": "04061ab5-c50d-46f3-aba1-148bdc5c2333.xml", "processing_time": 3.393923759460449, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 04061ab5-c50d-46f3-aba1-148bdc5c2333 already exists"}', 'execution_time': 3.393923759460449, 'memory_usage': None, 'filename': '04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 20, 59, 291984)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:01,261 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'details': '{"filename": "0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml", "processing_time": 0.7303338050842285, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 0781DA3A-D65A-4B8C-827C-104B8D3F52F8 already exists"}', 'execution_time': 0.7303338050842285, 'memory_usage': None, 'filename': '0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 0, 743128)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:01,262 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'details': '{"filename": "0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml", "processing_time": 0.7303338050842285, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 0781DA3A-D65A-4B8C-827C-104B8D3F52F8 already exists"}', 'execution_time': 0.7303338050842285, 'memory_usage': None, 'filename': '0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 0, 743128)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:09,137 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'series': None, 'folio': '52221', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 53), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 8, 579759), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 8, 579761), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('724.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('724.000000'), 'digital_stamp': 'gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[:10]***MASKED***gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[-10:] ... (46 characters truncated) ... JYLPQdJSeXpKETRpGHVMyykXTYgEm6dUJMj6tSAnbERaeRS1Hhaq8zpK10/2HC3sgLSTLR3jfQgcQ9hPd8OBHLUwMDn6hAFuV2pXbfpu4d6PS/WcR/zSsNndBEruKcUFqXjr7M5izdxVycWoA5g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZLPyGoiFgRZmiGRStJ32HDEOSrGYDVBJJOBpqjLIaOi02K74T14XQ885lnGE4cOLn9phVwtgGtHHd0u2mi2n3xjaxSPN0B6L683ctc7CU7w12u1bDGxzo3Fp+2Drpx8OXvyb3xMngp27XBlCTWF3H ... (46 characters truncated) ... BjITV4l5CyNhstxNVYCJVFm/0XntgTaQtFbN5ZtHVBNsLcBctbmXxbyzSYVqVDlCtuNMCyUewEpX8PPR+abAf7EA5u92C/k+GBL4vpKa8WCE845IXNnSRqi5X4/1s03v3WJmFu4jozojHDmG0tA==', 'sat_certificate': None, 'fiscal_folio': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 54), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'xml_file_size': 6129, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:09,139 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'series': None, 'folio': '52221', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 53), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 8, 579759), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 8, 579761), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('724.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('724.000000'), 'digital_stamp': 'gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[:10]***MASKED***gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[-10:] ... (46 characters truncated) ... JYLPQdJSeXpKETRpGHVMyykXTYgEm6dUJMj6tSAnbERaeRS1Hhaq8zpK10/2HC3sgLSTLR3jfQgcQ9hPd8OBHLUwMDn6hAFuV2pXbfpu4d6PS/WcR/zSsNndBEruKcUFqXjr7M5izdxVycWoA5g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZLPyGoiFgRZmiGRStJ32HDEOSrGYDVBJJOBpqjLIaOi02K74T14XQ885lnGE4cOLn9phVwtgGtHHd0u2mi2n3xjaxSPN0B6L683ctc7CU7w12u1bDGxzo3Fp+2Drpx8OXvyb3xMngp27XBlCTWF3H ... (46 characters truncated) ... BjITV4l5CyNhstxNVYCJVFm/0XntgTaQtFbN5ZtHVBNsLcBctbmXxbyzSYVqVDlCtuNMCyUewEpX8PPR+abAf7EA5u92C/k+GBL4vpKa8WCE845IXNnSRqi5X4/1s03v3WJmFu4jozojHDmG0tA==', 'sat_certificate': None, 'fiscal_folio': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 54), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'xml_file_size': 6129, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:09,141 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 09627427-807D-48B0-A15C-DD43CB94F1FC.xml: Failed to save invoice to database
2025-07-18 15:21:09,883 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'details': '{"filename": "09627427-807D-48B0-A15C-DD43CB94F1FC.xml", "processing_time": 7.876753807067871, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.876753807067871, 'memory_usage': None, 'filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 9, 322647)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:09,884 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'details': '{"filename": "09627427-807D-48B0-A15C-DD43CB94F1FC.xml", "processing_time": 7.876753807067871, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.876753807067871, 'memory_usage': None, 'filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 9, 322647)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:11,337 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'details': '{"filename": "109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml", "processing_time": 0.7365381717681885, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 109BCCAF-DC6E-4C71-B0B4-468D3D894E02 already exists"}', 'execution_time': 0.7365381717681885, 'memory_usage': None, 'filename': '109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 10, 806463)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:11,338 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'details': '{"filename": "109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml", "processing_time": 0.7365381717681885, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 109BCCAF-DC6E-4C71-B0B4-468D3D894E02 already exists"}', 'execution_time': 0.7365381717681885, 'memory_usage': None, 'filename': '109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 10, 806463)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:13,974 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'series': None, 'folio': '52010', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 32, 41), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 13, 386686), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 13, 386689), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('77.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('77.000000'), 'digital_stamp': 'Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[:10]***MASKED***Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[-10:] ... (46 characters truncated) ... Yz+Lt1zvd9nMmtXq4OpOEkS+n0XbRpzg1TbFxlR8Xi5xNuw3SKDLcHk723JS/A/CTh9vrk/nKfyQakFlZu0vVeW/qwbU7woMIJB1UHftDKafuVNcOpxJi6+FFP9+XR8RsPPmybbxF8l9VV/tyzw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mCu5XSPDBNOoek+ZOA150LoylOdJ+osEeL1esq/KgIPS5+02pxuU/54eauQ/CHqOj4GEKI9DysriwF4o4rY8pwTtT/Q1PcEENX7SIN2iizxbAH+TMuiqaxJ202AfzjSKQLp4GOY/6C5IIVEoJGylp ... (46 characters truncated) ... 7vc5X/PWRtXxSkJe59bF+j22tG/ocA/peR4asfJDf6WjF7VHP4Ytmam+uaAJ28Wj2Rf2Em6I1nLtgPtxeKvQhRZpIjVC17CuR7qC/S1fzFWGlkRBXjt0o7HdO+VoHmItjN1MkphQyGP357SmELQ==', 'sat_certificate': None, 'fiscal_folio': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 32, 42), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'xml_file_size': 5355, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:13,975 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'series': None, 'folio': '52010', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 32, 41), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 13, 386686), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 13, 386689), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('77.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('77.000000'), 'digital_stamp': 'Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[:10]***MASKED***Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[-10:] ... (46 characters truncated) ... Yz+Lt1zvd9nMmtXq4OpOEkS+n0XbRpzg1TbFxlR8Xi5xNuw3SKDLcHk723JS/A/CTh9vrk/nKfyQakFlZu0vVeW/qwbU7woMIJB1UHftDKafuVNcOpxJi6+FFP9+XR8RsPPmybbxF8l9VV/tyzw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mCu5XSPDBNOoek+ZOA150LoylOdJ+osEeL1esq/KgIPS5+02pxuU/54eauQ/CHqOj4GEKI9DysriwF4o4rY8pwTtT/Q1PcEENX7SIN2iizxbAH+TMuiqaxJ202AfzjSKQLp4GOY/6C5IIVEoJGylp ... (46 characters truncated) ... 7vc5X/PWRtXxSkJe59bF+j22tG/ocA/peR4asfJDf6WjF7VHP4Ytmam+uaAJ28Wj2Rf2Em6I1nLtgPtxeKvQhRZpIjVC17CuR7qC/S1fzFWGlkRBXjt0o7HdO+VoHmItjN1MkphQyGP357SmELQ==', 'sat_certificate': None, 'fiscal_folio': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 32, 42), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'xml_file_size': 5355, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:13,977 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 138216B8-116F-4B41-A4C0-296EE6B52B1D.xml: Failed to save invoice to database
2025-07-18 15:21:14,733 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'details': '{"filename": "138216B8-116F-4B41-A4C0-296EE6B52B1D.xml", "processing_time": 2.6362318992614746, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.6362318992614746, 'memory_usage': None, 'filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 14, 161108)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:14,734 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'details': '{"filename": "138216B8-116F-4B41-A4C0-296EE6B52B1D.xml", "processing_time": 2.6362318992614746, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.6362318992614746, 'memory_usage': None, 'filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 14, 161108)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:19,052 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'series': None, 'folio': '52185', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 25), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 18, 459799), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 18, 459802), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1489.320000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1489.320000'), 'digital_stamp': 'R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[:10]***MASKED***R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[-10:] ... (46 characters truncated) ... oppbyOvk8fHHSVqjxDoy+DIKDukU37ztcAXYkTgRdAXqT1Rcr37OP0EtcG8Om4Uw0Uc1DcB6XYcamoEnnszrKxZQKDPpZ1kMt13sX0/PXvQNKICM9GIyv/Vb8ZegLkscBeyFqImTJDoZFRSoGog==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'iPs3rAtLFvrkpxRe1HQb0XGqFsBdeuX4shi9l9e2Op7VKEvjd2b5GT8XsSDnx3MCFnbn0/QMvcfga4RxgZtuZ9Y0hIloxhn58K6jvsk6V1NJdpUZAGC/2o7b+KWeh31TZLrPnO9AXWgNsKy1lwZwV ... (46 characters truncated) ... DtTobBt0LrsAKU6LWfnCpt5N9c1EWNzc05e3xT3bUVxpTo41szvYtk0zJ3qnZKVtWykVOYGyuj+d4RqCFlmmAWvoQMhOOTDxkevntk3u7CVM/0Bw2xXr34jfPuB2pV9UDkPq8zuE0ZGIGjIqYhg==', 'sat_certificate': None, 'fiscal_folio': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 26), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'xml_file_size': 5376, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:19,054 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'series': None, 'folio': '52185', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 25), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 18, 459799), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 18, 459802), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1489.320000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1489.320000'), 'digital_stamp': 'R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[:10]***MASKED***R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[-10:] ... (46 characters truncated) ... oppbyOvk8fHHSVqjxDoy+DIKDukU37ztcAXYkTgRdAXqT1Rcr37OP0EtcG8Om4Uw0Uc1DcB6XYcamoEnnszrKxZQKDPpZ1kMt13sX0/PXvQNKICM9GIyv/Vb8ZegLkscBeyFqImTJDoZFRSoGog==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'iPs3rAtLFvrkpxRe1HQb0XGqFsBdeuX4shi9l9e2Op7VKEvjd2b5GT8XsSDnx3MCFnbn0/QMvcfga4RxgZtuZ9Y0hIloxhn58K6jvsk6V1NJdpUZAGC/2o7b+KWeh31TZLrPnO9AXWgNsKy1lwZwV ... (46 characters truncated) ... DtTobBt0LrsAKU6LWfnCpt5N9c1EWNzc05e3xT3bUVxpTo41szvYtk0zJ3qnZKVtWykVOYGyuj+d4RqCFlmmAWvoQMhOOTDxkevntk3u7CVM/0Bw2xXr34jfPuB2pV9UDkPq8zuE0ZGIGjIqYhg==', 'sat_certificate': None, 'fiscal_folio': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 26), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'xml_file_size': 5376, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:19,055 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 252AD822-768F-420F-BFF0-DFBECEEB3658.xml: Failed to save invoice to database
2025-07-18 15:21:19,863 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'details': '{"filename": "252AD822-768F-420F-BFF0-DFBECEEB3658.xml", "processing_time": 4.319532871246338, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.319532871246338, 'memory_usage': None, 'filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 19, 239437)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:19,864 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'details': '{"filename": "252AD822-768F-420F-BFF0-DFBECEEB3658.xml", "processing_time": 4.319532871246338, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.319532871246338, 'memory_usage': None, 'filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 19, 239437)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:21,452 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'details': '{"filename": "29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml", "processing_time": 0.8055803775787354, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F already exists"}', 'execution_time': 0.8055803775787354, 'memory_usage': None, 'filename': '29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 20, 865195)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:21,453 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'details': '{"filename": "29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml", "processing_time": 0.8055803775787354, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F already exists"}', 'execution_time': 0.8055803775787354, 'memory_usage': None, 'filename': '29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 20, 865195)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:24,049 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'series': None, 'folio': '52047', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 11, 13, 8), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 23, 440116), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 23, 440119), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('414.260000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('414.260000'), 'digital_stamp': 'Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[:10]***MASKED***Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[-10:] ... (46 characters truncated) ... y2MnPhimpvnAXKFfTzwml0GtTN0LCTO0VoneF1A/5pK8fbfCKq+Slq1kjVEF7rZQY6lZNhOXt2lS8FvczqoDi8ez9u87/BlLkJzu4QDhvXafMoR6nC7Gn/+4ajvCWf1w6Pb1pKo6UkMo/TO6QLw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CQPuu3j+VkN3Dj7MjAMx0FOKB5VlqE6415C/27WjQBdK049zdrOmJf0paAF7FPXuOiiNO0v7QEc71F0YM9lxYRthoXPsIvtViarP7rggMFWKiyq+0Htsr5YQIcxBDwTBSVKk4yD+TrWvgQio/3Tgn ... (46 characters truncated) ... yR6ZAaUE/QzBtc1OrPqZeIhdIJWk+7fJE4UenQSp22m0uFjiz4KDZQ0XXAjj8g/3MPWnqWXsgbG1n0w/E3y2MPERF01GMOaq3hJHyQr6m4FgqJIJ9fW0aIjwmL2twyly/qmGTZO4e90YiXYyrTQ==', 'sat_certificate': None, 'fiscal_folio': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'stamp_datetime': datetime.datetime(2025, 7, 13, 12, 13, 9), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'xml_file_size': 6122, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:24,051 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'series': None, 'folio': '52047', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 11, 13, 8), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 23, 440116), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 23, 440119), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('414.260000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('414.260000'), 'digital_stamp': 'Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[:10]***MASKED***Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[-10:] ... (46 characters truncated) ... y2MnPhimpvnAXKFfTzwml0GtTN0LCTO0VoneF1A/5pK8fbfCKq+Slq1kjVEF7rZQY6lZNhOXt2lS8FvczqoDi8ez9u87/BlLkJzu4QDhvXafMoR6nC7Gn/+4ajvCWf1w6Pb1pKo6UkMo/TO6QLw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CQPuu3j+VkN3Dj7MjAMx0FOKB5VlqE6415C/27WjQBdK049zdrOmJf0paAF7FPXuOiiNO0v7QEc71F0YM9lxYRthoXPsIvtViarP7rggMFWKiyq+0Htsr5YQIcxBDwTBSVKk4yD+TrWvgQio/3Tgn ... (46 characters truncated) ... yR6ZAaUE/QzBtc1OrPqZeIhdIJWk+7fJE4UenQSp22m0uFjiz4KDZQ0XXAjj8g/3MPWnqWXsgbG1n0w/E3y2MPERF01GMOaq3hJHyQr6m4FgqJIJ9fW0aIjwmL2twyly/qmGTZO4e90YiXYyrTQ==', 'sat_certificate': None, 'fiscal_folio': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'stamp_datetime': datetime.datetime(2025, 7, 13, 12, 13, 9), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'xml_file_size': 6122, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:24,053 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml: Failed to save invoice to database
2025-07-18 15:21:24,811 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'details': '{"filename": "2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml", "processing_time": 2.5974130630493164, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5974130630493164, 'memory_usage': None, 'filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 24, 232040)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:24,812 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'details': '{"filename": "2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml", "processing_time": 2.5974130630493164, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5974130630493164, 'memory_usage': None, 'filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 24, 232040)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:27,406 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'series': 'F', 'folio': '8430256535', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 20, 43, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 26, 839658), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 26, 839661), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('151.720000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('24.280000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('176.000000'), 'digital_stamp': 'SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[:10]***MASKED***SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[-10:] ... (46 characters truncated) ... IxGABS1htWPXUwJNt35iB1Bemr2LlP823qRKZ4lWulJAIEMvmPXMhk1MBp/dYWjdHwIWLd/SBJjbwcY1v7JO1pk0M647BBF0QvpIoq0O9cpuSOB7zG6OMhD0ByjVQjTJB3OmWZJcheOy0HqTRqw==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'OsyP/uN+8mozwfdUd//LYrv+MKXDLWB84808aMhKldwU+IOj/VGAelpfkznfKH4ohuA+eCbSFHE8VfmFu4NFzUK6VvbrB8znDH5B2C95yynSZP5gE+jqeqpfqnw+yrF1zGFoJfJphkoAMdnvXTz5C ... (46 characters truncated) ... F0tPmUIEc/EZa+snebHibUdv4VA9rdqopnvINg3r3Rfl36wcASj8OPkNacTRmn5WR2g00p9baBpGCjCBljpd0isPG5D/x2iHUG4QZuXqo9ZlMMn3h8pnKcuc60fIK13f/C39KSAI9gAVRpOPHyA==', 'sat_certificate': None, 'fiscal_folio': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 43, 32), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'xml_file_size': 5106, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:27,407 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'series': 'F', 'folio': '8430256535', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 20, 43, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 26, 839658), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 26, 839661), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('151.720000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('24.280000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('176.000000'), 'digital_stamp': 'SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[:10]***MASKED***SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[-10:] ... (46 characters truncated) ... IxGABS1htWPXUwJNt35iB1Bemr2LlP823qRKZ4lWulJAIEMvmPXMhk1MBp/dYWjdHwIWLd/SBJjbwcY1v7JO1pk0M647BBF0QvpIoq0O9cpuSOB7zG6OMhD0ByjVQjTJB3OmWZJcheOy0HqTRqw==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'OsyP/uN+8mozwfdUd//LYrv+MKXDLWB84808aMhKldwU+IOj/VGAelpfkznfKH4ohuA+eCbSFHE8VfmFu4NFzUK6VvbrB8znDH5B2C95yynSZP5gE+jqeqpfqnw+yrF1zGFoJfJphkoAMdnvXTz5C ... (46 characters truncated) ... F0tPmUIEc/EZa+snebHibUdv4VA9rdqopnvINg3r3Rfl36wcASj8OPkNacTRmn5WR2g00p9baBpGCjCBljpd0isPG5D/x2iHUG4QZuXqo9ZlMMn3h8pnKcuc60fIK13f/C39KSAI9gAVRpOPHyA==', 'sat_certificate': None, 'fiscal_folio': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 43, 32), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'xml_file_size': 5106, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:27,409 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml: Failed to save invoice to database
2025-07-18 15:21:28,134 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'details': '{"filename": "37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml", "processing_time": 2.5948266983032227, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5948266983032227, 'memory_usage': None, 'filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 27, 591738)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:28,135 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'details': '{"filename": "37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml", "processing_time": 2.5948266983032227, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5948266983032227, 'memory_usage': None, 'filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 27, 591738)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:30,573 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'series': None, 'folio': '51946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 56, 56), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 30, 21322), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 30, 21325), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('184.800000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('184.800000'), 'digital_stamp': 'gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[:10]***MASKED***gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[-10:] ... (46 characters truncated) ... e+1kqtwfA+4iuiSdqhSt5suCPW+v7PQTI841ierDEewHOOVtETpZ8/Qe7n4DJyMBj2uNevgFeQ159sqSlGxhdgSxQzA7DBFR/mDv7F4muXRtHyyolGMjbR0ASvgES2ZfWfIyXcaPpLEXzwQ0+Zg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'k/qYxNSoMTFjIV6uWQRJy+tBCc1tzc3AgOcbagLSy1eca8ZitxIwxGopqI4kUgCD7xq4/BAUZoj51E5W5gl8+KLtZwoLnMjBHSHJ0yrhFKUAKKTP6E8ST9uF9FgeU0mARbYuYtJQO6E/PCK++d63q ... (46 characters truncated) ... 6mRc4RhfFCz6Y2tYDkT4KukfPcd4RxF2LVDa8a2hSaDGiar5oWALzD2mkNXLa3kQvrfOJF/e+ZhkNRJROJWdKe6d5IT5XCDkqf23wCAt3QGZyeksJSjVhQtj3GypGxkAVBGrvopIRbiLqax2X4A==', 'sat_certificate': None, 'fiscal_folio': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 56, 57), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'xml_file_size': 5720, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:30,575 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'series': None, 'folio': '51946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 56, 56), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 30, 21322), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 30, 21325), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('184.800000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('184.800000'), 'digital_stamp': 'gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[:10]***MASKED***gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[-10:] ... (46 characters truncated) ... e+1kqtwfA+4iuiSdqhSt5suCPW+v7PQTI841ierDEewHOOVtETpZ8/Qe7n4DJyMBj2uNevgFeQ159sqSlGxhdgSxQzA7DBFR/mDv7F4muXRtHyyolGMjbR0ASvgES2ZfWfIyXcaPpLEXzwQ0+Zg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'k/qYxNSoMTFjIV6uWQRJy+tBCc1tzc3AgOcbagLSy1eca8ZitxIwxGopqI4kUgCD7xq4/BAUZoj51E5W5gl8+KLtZwoLnMjBHSHJ0yrhFKUAKKTP6E8ST9uF9FgeU0mARbYuYtJQO6E/PCK++d63q ... (46 characters truncated) ... 6mRc4RhfFCz6Y2tYDkT4KukfPcd4RxF2LVDa8a2hSaDGiar5oWALzD2mkNXLa3kQvrfOJF/e+ZhkNRJROJWdKe6d5IT5XCDkqf23wCAt3QGZyeksJSjVhQtj3GypGxkAVBGrvopIRbiLqax2X4A==', 'sat_certificate': None, 'fiscal_folio': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 56, 57), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'xml_file_size': 5720, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:30,576 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 38CBAC2B-A89B-4309-B925-4801B835A59F.xml: Failed to save invoice to database
2025-07-18 15:21:31,295 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'details': '{"filename": "38CBAC2B-A89B-4309-B925-4801B835A59F.xml", "processing_time": 2.439814329147339, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.439814329147339, 'memory_usage': None, 'filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 30, 748165)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:31,296 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'details': '{"filename": "38CBAC2B-A89B-4309-B925-4801B835A59F.xml", "processing_time": 2.439814329147339, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.439814329147339, 'memory_usage': None, 'filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 30, 748165)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:39,147 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'series': 'B', 'folio': '120892235', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 19, 45, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 38, 576708), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 38, 576713), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('991.370000'), 'total_discount': Decimal('245.930000'), 'total_transferred_taxes': Decimal('119.270000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('864.710000'), 'digital_stamp': 'KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[:10]***MASKED***KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[-10:] ... (46 characters truncated) ... bt8dmNOobNN/ehF8iPvOJ8OjmRyZdKiq1ixJFZmg9OEP8Q8rt6j3tATPYQhdWQRTbYiLfgxFxZtECMQQDi4/eMK7TpWtJ69kstS4LsBPYK3vpPd/uS2VmSPGtheDluEr1fkNA39/kXA42uKkJtg==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'abRVjQq2R/iM4ChtjW3mWx0jBk1dmIbpp1OWN0V8f6K8C9bhLBfirEnJ2CnvRBjBg0BLtXYZ/ihkDZlCJ416OPdR7dFeHUHUgtapZHJxDpLPKGjQV/TLBQZukPZVn9hPdFXm+AbYRyUiZ+ZDMjD2c ... (46 characters truncated) ... qjn6cGieiOP1R79L6GIMbwYWHRYQTNcG2orU1iRQGgIqUeohD8E0lgUxfdrsYUfDsytMIWmFYR13lC2SApMpDpjNx9YlJ6bEc+YxIXkDvkOaybm4sgHgSaWhBDS4rtrP9C+NBNchIhyIRpfRyyw==', 'sat_certificate': None, 'fiscal_folio': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 45, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'xml_file_size': 6651, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:39,149 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'series': 'B', 'folio': '120892235', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 19, 45, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 38, 576708), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 38, 576713), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('991.370000'), 'total_discount': Decimal('245.930000'), 'total_transferred_taxes': Decimal('119.270000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('864.710000'), 'digital_stamp': 'KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[:10]***MASKED***KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[-10:] ... (46 characters truncated) ... bt8dmNOobNN/ehF8iPvOJ8OjmRyZdKiq1ixJFZmg9OEP8Q8rt6j3tATPYQhdWQRTbYiLfgxFxZtECMQQDi4/eMK7TpWtJ69kstS4LsBPYK3vpPd/uS2VmSPGtheDluEr1fkNA39/kXA42uKkJtg==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'abRVjQq2R/iM4ChtjW3mWx0jBk1dmIbpp1OWN0V8f6K8C9bhLBfirEnJ2CnvRBjBg0BLtXYZ/ihkDZlCJ416OPdR7dFeHUHUgtapZHJxDpLPKGjQV/TLBQZukPZVn9hPdFXm+AbYRyUiZ+ZDMjD2c ... (46 characters truncated) ... qjn6cGieiOP1R79L6GIMbwYWHRYQTNcG2orU1iRQGgIqUeohD8E0lgUxfdrsYUfDsytMIWmFYR13lC2SApMpDpjNx9YlJ6bEc+YxIXkDvkOaybm4sgHgSaWhBDS4rtrP9C+NBNchIhyIRpfRyyw==', 'sat_certificate': None, 'fiscal_folio': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 45, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'xml_file_size': 6651, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:39,150 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml: Failed to save invoice to database
2025-07-18 15:21:39,891 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'details': '{"filename": "39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml", "processing_time": 7.85218358039856, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.85218358039856, 'memory_usage': None, 'filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 39, 329459)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:39,892 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'details': '{"filename": "39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml", "processing_time": 7.85218358039856, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.85218358039856, 'memory_usage': None, 'filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 39, 329459)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:46,375 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'series': None, 'folio': '52009', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 28, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 45, 769570), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 45, 769574), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('634.600000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('634.600000'), 'digital_stamp': 'cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[:10]***MASKED***cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[-10:] ... (46 characters truncated) ... H9nhL5S8syZmxiuN2/Dl8ErCv7am+uSCeMKtmfVX7R0v5XZg2ptY0eLx2wF97Vcn+PuRWlAo8itLAKlvvwKtnbaoFHFNh4MxeUU2ZdJhTanuqxw+5x7yfTa7nS6pRaED3/RxspIdWk/Q39KZUVg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'SWsuq7E9Lbh1Gj4EH31OJU+TRkzxX2oM0lNi/UIhLo54sHjcvnchdxVuQ5sHxX9zNhHvaJAhH53kN8urH9Bz9f3Rpnx+sCy+1C5SvDkqgJR6dgU2gJnXl+73MDwDM8Pp2MwrRHa1ep8ZyoxABEN53 ... (46 characters truncated) ... vi8nfJtCZ+jMfXybIno8dcxxcjimbgG95PtHypOcZv9niEJupYNo3mRz5ANKoUABU6rp7idPkMD0Z1YTRdRQ2T5l1g2p8aCMJHfSAg9azN8nYSgZWtf0glU8Gjf95HVhTDgtIYyBQRZwQCw0cNA==', 'sat_certificate': None, 'fiscal_folio': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 28, 10), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'xml_file_size': 6482, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:46,377 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'series': None, 'folio': '52009', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 28, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 45, 769570), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 45, 769574), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('634.600000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('634.600000'), 'digital_stamp': 'cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[:10]***MASKED***cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[-10:] ... (46 characters truncated) ... H9nhL5S8syZmxiuN2/Dl8ErCv7am+uSCeMKtmfVX7R0v5XZg2ptY0eLx2wF97Vcn+PuRWlAo8itLAKlvvwKtnbaoFHFNh4MxeUU2ZdJhTanuqxw+5x7yfTa7nS6pRaED3/RxspIdWk/Q39KZUVg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'SWsuq7E9Lbh1Gj4EH31OJU+TRkzxX2oM0lNi/UIhLo54sHjcvnchdxVuQ5sHxX9zNhHvaJAhH53kN8urH9Bz9f3Rpnx+sCy+1C5SvDkqgJR6dgU2gJnXl+73MDwDM8Pp2MwrRHa1ep8ZyoxABEN53 ... (46 characters truncated) ... vi8nfJtCZ+jMfXybIno8dcxxcjimbgG95PtHypOcZv9niEJupYNo3mRz5ANKoUABU6rp7idPkMD0Z1YTRdRQ2T5l1g2p8aCMJHfSAg9azN8nYSgZWtf0glU8Gjf95HVhTDgtIYyBQRZwQCw0cNA==', 'sat_certificate': None, 'fiscal_folio': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 28, 10), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'xml_file_size': 6482, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:46,378 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 45C65D2A-1889-4BCE-93CD-10119064B54C.xml: Failed to save invoice to database
2025-07-18 15:21:47,150 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'details': '{"filename": "45C65D2A-1889-4BCE-93CD-10119064B54C.xml", "processing_time": 6.483758449554443, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.483758449554443, 'memory_usage': None, 'filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 46, 557091)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:47,151 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'details': '{"filename": "45C65D2A-1889-4BCE-93CD-10119064B54C.xml", "processing_time": 6.483758449554443, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.483758449554443, 'memory_usage': None, 'filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 46, 557091)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:50,729 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'series': None, 'folio': '52187', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 51, 31), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 50, 169936), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 50, 169939), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('235.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('235.500000'), 'digital_stamp': 'Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[:10]***MASKED***Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[-10:] ... (46 characters truncated) ... ejLxZpPpZKvKxKfmcng7/rTdKGe22GHtTCcmuXvlPXtVHXzGOdLWDRcJWxG6N8euJB8Q4T5x3JbdA5LRqvwbJnXK3nR53qoJXGkZbd7eTAPehb+rLBFzAAS/lsXf6eFlK/dqyUHCQ24EW+jRwQw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'cpQ7Do7csXdZuSIWekby7gMIDslJYnYSllru1bJEf/HHaYE43IuerihfS3UadDy93skUvJv1f5zACKkZGjSaM/h08R0GtlwfOygodob5b6ih++BYcL7qaZeEGQK2pqZ9XuQ38qkrr/GMdq6LWsZu5 ... (46 characters truncated) ... vGyAltLMKmy/xs3NhU1a2lr+V8guRfVLIcvjo1u0D46dPhvuDQQxcldUi7ZZWufyMQ1cbJAzqDdsFAgtNoa2zbiukNPaMBvzY50uAjRMU5gh3FocvFLq+LTQf/BJHVzVRtJ0oLBM4ZA8Hy0XvVA==', 'sat_certificate': None, 'fiscal_folio': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 51, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'xml_file_size': 5743, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:50,731 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'series': None, 'folio': '52187', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 51, 31), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 50, 169936), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 50, 169939), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('235.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('235.500000'), 'digital_stamp': 'Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[:10]***MASKED***Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[-10:] ... (46 characters truncated) ... ejLxZpPpZKvKxKfmcng7/rTdKGe22GHtTCcmuXvlPXtVHXzGOdLWDRcJWxG6N8euJB8Q4T5x3JbdA5LRqvwbJnXK3nR53qoJXGkZbd7eTAPehb+rLBFzAAS/lsXf6eFlK/dqyUHCQ24EW+jRwQw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'cpQ7Do7csXdZuSIWekby7gMIDslJYnYSllru1bJEf/HHaYE43IuerihfS3UadDy93skUvJv1f5zACKkZGjSaM/h08R0GtlwfOygodob5b6ih++BYcL7qaZeEGQK2pqZ9XuQ38qkrr/GMdq6LWsZu5 ... (46 characters truncated) ... vGyAltLMKmy/xs3NhU1a2lr+V8guRfVLIcvjo1u0D46dPhvuDQQxcldUi7ZZWufyMQ1cbJAzqDdsFAgtNoa2zbiukNPaMBvzY50uAjRMU5gh3FocvFLq+LTQf/BJHVzVRtJ0oLBM4ZA8Hy0XvVA==', 'sat_certificate': None, 'fiscal_folio': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 51, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'xml_file_size': 5743, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:50,732 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 51968191-3B2B-444A-9C5E-4EC226E5FF63.xml: Failed to save invoice to database
2025-07-18 15:21:51,496 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'details': '{"filename": "51968191-3B2B-444A-9C5E-4EC226E5FF63.xml", "processing_time": 3.579427480697632, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.579427480697632, 'memory_usage': None, 'filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 50, 920591)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:51,497 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'details': '{"filename": "51968191-3B2B-444A-9C5E-4EC226E5FF63.xml", "processing_time": 3.579427480697632, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.579427480697632, 'memory_usage': None, 'filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 50, 920591)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:53,059 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'series': 'F', 'folio': '8430688765', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 21, 43, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 52, 478282), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 52, 478285), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('85.340000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('13.650000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('98.990000'), 'digital_stamp': 'cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[:10]***MASKED***cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[-10:] ... (46 characters truncated) ... RL3masOApqBeG3955Sov7rluDItM2zfjoNofySeoOWVBNnaKoMsV3eTDLD9VPK8W0hno39+FPLBqUI+7Sr3ZRJERef6Yz3Ib0BTDkvwevTBGbAtaZAw+D4Sn+Rrhj5JvDe1CF8962L+4QzTDv8w==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'g93X1GAC2UouRg+BS9N7SSLdpx+EGRntJXKx3C/D+XWacr3F8ZwSGzoCalpiese7+WOpLkOdCuPA6KNoIXGr2Zx6H7GaI3bGeiFgxejepAiOpSmOLMJqzHnvm37rHKuKuWBvY0lSZkZClfYNol/n2 ... (46 characters truncated) ... IPyfDrZYc9/cu9325wKg1TmqzjOOFJlE+my66s/ikj7PBYrHSaAnqs0aL6EAM1RPnxsAZvIZSWIz7QYIhNaZAYSr054ATZyPJ7hdGp0sJYG27xxlwyn5w/OtBJY37yy8+B1GbNf+LQ+f3IwLmxg==', 'sat_certificate': None, 'fiscal_folio': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 43, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'xml_file_size': 5100, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:53,060 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'series': 'F', 'folio': '8430688765', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 21, 43, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 52, 478282), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 52, 478285), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('85.340000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('13.650000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('98.990000'), 'digital_stamp': 'cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[:10]***MASKED***cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[-10:] ... (46 characters truncated) ... RL3masOApqBeG3955Sov7rluDItM2zfjoNofySeoOWVBNnaKoMsV3eTDLD9VPK8W0hno39+FPLBqUI+7Sr3ZRJERef6Yz3Ib0BTDkvwevTBGbAtaZAw+D4Sn+Rrhj5JvDe1CF8962L+4QzTDv8w==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'g93X1GAC2UouRg+BS9N7SSLdpx+EGRntJXKx3C/D+XWacr3F8ZwSGzoCalpiese7+WOpLkOdCuPA6KNoIXGr2Zx6H7GaI3bGeiFgxejepAiOpSmOLMJqzHnvm37rHKuKuWBvY0lSZkZClfYNol/n2 ... (46 characters truncated) ... IPyfDrZYc9/cu9325wKg1TmqzjOOFJlE+my66s/ikj7PBYrHSaAnqs0aL6EAM1RPnxsAZvIZSWIz7QYIhNaZAYSr054ATZyPJ7hdGp0sJYG27xxlwyn5w/OtBJY37yy8+B1GbNf+LQ+f3IwLmxg==', 'sat_certificate': None, 'fiscal_folio': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 43, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'xml_file_size': 5100, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:53,063 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml: Failed to save invoice to database
2025-07-18 15:21:53,831 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'details': '{"filename": "5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml", "processing_time": 1.5632908344268799, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.5632908344268799, 'memory_usage': None, 'filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 53, 241085)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:53,832 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'details': '{"filename": "5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml", "processing_time": 1.5632908344268799, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.5632908344268799, 'memory_usage': None, 'filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 53, 241085)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:56,360 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'series': None, 'folio': '52124', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 14, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 55, 802068), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 55, 802071), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('83.940000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('83.940000'), 'digital_stamp': 'b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[:10]***MASKED***b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[-10:] ... (46 characters truncated) ... Ov4y2QecQIEwuQ1/4jSYc/+Q2JEsT6qoVxze7kJXnBV40+CzFQhHfv2t6pO0qoIT2/5/CA/ABva6RVCxvDEPvHhtt1jfFLbyI8i4JjzafLUnVPhIeL1bSqzUh62/GGBeEqFd6LsXYmZEHYCh/8Q==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'Q33Rj5Z4wz4QuCKH5/UDLd9w+vb9vn27KPsN948hTyWBi3VJoUYmfCW85ELrGJA7agM8IyAfbv8Oi1XbOcFDNCOdie5a5/nxWubds4wsL+8wg1EfwDsWLC/EBxuYSMXeJRQuKrUqhx5cU3qfm/rTt ... (46 characters truncated) ... Av+C1X0rfYblcfKwsRP9VT8EnjXsSsnvfouZrxKwRmk5YJ1lguPDXKZpWA99/FvuiOVDZWcjZ0Aeog+g4+b56+gr19wVkaBqsA+QnF0MuPHB1CNbstGi26vvtCEL1v5Th6XzG6pLa+0mEvSDzNQ==', 'sat_certificate': None, 'fiscal_folio': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 14, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'xml_file_size': 5739, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:56,362 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'series': None, 'folio': '52124', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 14, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 55, 802068), 'updated_at': datetime.datetime(2025, 7, 18, 22, 21, 55, 802071), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('83.940000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('83.940000'), 'digital_stamp': 'b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[:10]***MASKED***b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[-10:] ... (46 characters truncated) ... Ov4y2QecQIEwuQ1/4jSYc/+Q2JEsT6qoVxze7kJXnBV40+CzFQhHfv2t6pO0qoIT2/5/CA/ABva6RVCxvDEPvHhtt1jfFLbyI8i4JjzafLUnVPhIeL1bSqzUh62/GGBeEqFd6LsXYmZEHYCh/8Q==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'Q33Rj5Z4wz4QuCKH5/UDLd9w+vb9vn27KPsN948hTyWBi3VJoUYmfCW85ELrGJA7agM8IyAfbv8Oi1XbOcFDNCOdie5a5/nxWubds4wsL+8wg1EfwDsWLC/EBxuYSMXeJRQuKrUqhx5cU3qfm/rTt ... (46 characters truncated) ... Av+C1X0rfYblcfKwsRP9VT8EnjXsSsnvfouZrxKwRmk5YJ1lguPDXKZpWA99/FvuiOVDZWcjZ0Aeog+g4+b56+gr19wVkaBqsA+QnF0MuPHB1CNbstGi26vvtCEL1v5Th6XzG6pLa+0mEvSDzNQ==', 'sat_certificate': None, 'fiscal_folio': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 14, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'xml_file_size': 5739, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:56,364 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml: Failed to save invoice to database
2025-07-18 15:21:57,160 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'details': '{"filename": "5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml", "processing_time": 2.5301361083984375, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5301361083984375, 'memory_usage': None, 'filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 56, 552315)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:57,161 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'details': '{"filename": "5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml", "processing_time": 2.5301361083984375, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5301361083984375, 'memory_usage': None, 'filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 56, 552315)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:58,663 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'details': '{"filename": "5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml", "processing_time": 0.7663891315460205, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6 already exists"}', 'execution_time': 0.7663891315460205, 'memory_usage': None, 'filename': '5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 58, 121436)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:21:58,664 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'details': '{"filename": "5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml", "processing_time": 0.7663891315460205, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6 already exists"}', 'execution_time': 0.7663891315460205, 'memory_usage': None, 'filename': '5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 21, 58, 121436)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:12,688 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5EF48096-4938-424D-A25F-FB33575C2180', 'series': None, 'folio': '52045', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 20, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 12, 133474), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 12, 133477), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1006.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1006.960000'), 'digital_stamp': 'EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[:10]***MASKED***EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[-10:] ... (46 characters truncated) ... Di8WxNWW797Sg7qcx77Hn2YdrO9uyTkpmVQswY4mbxKKBiriJ6raNcfdRwdP/j9fFHOTZC+DZSg5QrapFNoPnGP/Cw3lD0Ki55BR3EuBEMazG778XGOecBetatA58Ct5wS/0GjdXmEjE1in64nQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'DZ0zh0G2ENJSczU4Q2PvLxa6FiB6XjCIgcu45AzM2DxpVU+kPbIuDqyXZGsoEodqe0eW0w27KXM+SExT6UasFSRTXTjhWqGa1DBTysB+DDqYU6/W52zlcEOAVg4JVventBUtWUASMoT0e+s6FCbhP ... (46 characters truncated) ... abmtPb6ANITcsFNRAd4pJF7tGA+0tIA+3po8DbtM5uthpJCX4hRZ7OL/a7msjhq6HpKwKPi8iqfOpU94TL5/Gr1T9TAmFeeyNKpCpOhXyrZ+4/lqul+JKEDN2089gFUqrLhSEwup5cozgzGD+kA==', 'sat_certificate': None, 'fiscal_folio': '5EF48096-4938-424D-A25F-FB33575C2180', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 20, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'xml_file_size': 9128, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:12,690 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5EF48096-4938-424D-A25F-FB33575C2180', 'series': None, 'folio': '52045', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 20, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 12, 133474), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 12, 133477), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1006.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1006.960000'), 'digital_stamp': 'EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[:10]***MASKED***EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[-10:] ... (46 characters truncated) ... Di8WxNWW797Sg7qcx77Hn2YdrO9uyTkpmVQswY4mbxKKBiriJ6raNcfdRwdP/j9fFHOTZC+DZSg5QrapFNoPnGP/Cw3lD0Ki55BR3EuBEMazG778XGOecBetatA58Ct5wS/0GjdXmEjE1in64nQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'DZ0zh0G2ENJSczU4Q2PvLxa6FiB6XjCIgcu45AzM2DxpVU+kPbIuDqyXZGsoEodqe0eW0w27KXM+SExT6UasFSRTXTjhWqGa1DBTysB+DDqYU6/W52zlcEOAVg4JVventBUtWUASMoT0e+s6FCbhP ... (46 characters truncated) ... abmtPb6ANITcsFNRAd4pJF7tGA+0tIA+3po8DbtM5uthpJCX4hRZ7OL/a7msjhq6HpKwKPi8iqfOpU94TL5/Gr1T9TAmFeeyNKpCpOhXyrZ+4/lqul+JKEDN2089gFUqrLhSEwup5cozgzGD+kA==', 'sat_certificate': None, 'fiscal_folio': '5EF48096-4938-424D-A25F-FB33575C2180', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 20, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'xml_file_size': 9128, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:12,691 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5EF48096-4938-424D-A25F-FB33575C2180.xml: Failed to save invoice to database
2025-07-18 15:22:13,386 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5EF48096-4938-424D-A25F-FB33575C2180.xml', 'details': '{"filename": "5EF48096-4938-424D-A25F-FB33575C2180.xml", "processing_time": 14.025076866149902, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 14.025076866149902, 'memory_usage': None, 'filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 12, 868350)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:13,387 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5EF48096-4938-424D-A25F-FB33575C2180.xml', 'details': '{"filename": "5EF48096-4938-424D-A25F-FB33575C2180.xml", "processing_time": 14.025076866149902, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 14.025076866149902, 'memory_usage': None, 'filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 12, 868350)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:19,860 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'series': None, 'folio': '52220', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 19, 288542), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 19, 288544), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('970.580000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('970.580000'), 'digital_stamp': 'VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[:10]***MASKED***VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[-10:] ... (46 characters truncated) ... xldewdCxxwaMYlRYfFPk9BbVMf/Ep7rVDiBMknjq3GXd8opsxzm4+LAVgPS7Fa9+PmmbDAZf+PlPU0QXHU4krDpX92jleHKwa1LAPqKcJUoMNrIqAbLKKVRiZiBivXhlva3mzVBkHXecX1wv/Gw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ULv/oCJLkbYUNM7xpb9xgZRomeqf2C2pE+tf2LeNIi87yuif+ox33qjwRxn/TzcTeYzGU7Aq73FA/J9u0nCH23SvjxJWKVTj7CKLlSaoEeVRpQ4eenvrh5MmMyxorkAZBRacm3SGWb/WvtdpDc0jr ... (46 characters truncated) ... vx3OKnr80IfWwpoOj7Bq0W07thQ5BOcmzLBoNj2Nv2HQ9fLfhewoLPzEMx+NOkGNwV8V2ZeQF6rGh+Il2HAnradpamkEgvQfjKx8gIDDtvsl1MjN0cXPlze/UWVqinq7pYCRp9wdvs6xRngFQiA==', 'sat_certificate': None, 'fiscal_folio': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'xml_file_size': 8012, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:19,862 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'series': None, 'folio': '52220', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 19, 288542), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 19, 288544), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('970.580000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('970.580000'), 'digital_stamp': 'VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[:10]***MASKED***VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[-10:] ... (46 characters truncated) ... xldewdCxxwaMYlRYfFPk9BbVMf/Ep7rVDiBMknjq3GXd8opsxzm4+LAVgPS7Fa9+PmmbDAZf+PlPU0QXHU4krDpX92jleHKwa1LAPqKcJUoMNrIqAbLKKVRiZiBivXhlva3mzVBkHXecX1wv/Gw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ULv/oCJLkbYUNM7xpb9xgZRomeqf2C2pE+tf2LeNIi87yuif+ox33qjwRxn/TzcTeYzGU7Aq73FA/J9u0nCH23SvjxJWKVTj7CKLlSaoEeVRpQ4eenvrh5MmMyxorkAZBRacm3SGWb/WvtdpDc0jr ... (46 characters truncated) ... vx3OKnr80IfWwpoOj7Bq0W07thQ5BOcmzLBoNj2Nv2HQ9fLfhewoLPzEMx+NOkGNwV8V2ZeQF6rGh+Il2HAnradpamkEgvQfjKx8gIDDtvsl1MjN0cXPlze/UWVqinq7pYCRp9wdvs6xRngFQiA==', 'sat_certificate': None, 'fiscal_folio': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'xml_file_size': 8012, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:19,863 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml: Failed to save invoice to database
2025-07-18 15:22:20,603 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'details': '{"filename": "61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml", "processing_time": 6.473923921585083, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.473923921585083, 'memory_usage': None, 'filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 20, 46840)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:20,604 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'details': '{"filename": "61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml", "processing_time": 6.473923921585083, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.473923921585083, 'memory_usage': None, 'filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 20, 46840)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:24,977 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'series': 'AA', 'folio': '98310', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 46, 43), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 24, 430632), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 24, 430635), 'issuer_rfc': 'AAE******3E6', 'issuer_name': 'ABASTECEDORA DE ALIMENTOS Y EMBUTIDOS VALLE HERMANOS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('2642.760000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('2642.760000'), 'digital_stamp': 'eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[:10]***MASKED***eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[-10:] ... (46 characters truncated) ... RrIJSadcJ3mzkuDdQPidA044+IzxtdR39XllOHhu6jOQx8xYNbD9yTkkLY7l41siqGOfBk1qy5g/ljtE+QeM24Oiv1jtsBWVNwj4utibT1YCDsu+3bdGIT42d1fyh8QkXcy0xTbbtnBegU1kY7A==', 'certificate_number': '00001000000514916510', 'certificate': None, 'sat_seal': 'G8ZhU7xmP1x6ezossLC1pwNDxLCPOz5PnIvHtS8a7zmzXs3+jG/zeZn42rVXj41+AhCTTm+JRLEB4D8rS2LfI/6RFQEas1mqyFOOoW2Uh7MQ052nvb/0q3LRMjc3rpeVIOCGFqRSQExPvz+HjnwaL ... (46 characters truncated) ... geNm9rffGT2s1Ms7S1X9DAJuIgyWsltA1oAotcizT6KkbVRBEVhUs5FgbqimZ+zp7eUjJuju5Z+EdZGejgvBBQrEyuOy3yXpQJC0fjmxE9wZAhG6RM9foQORRKdMnQ5DSphBT0oYF3Dq5Z5S/gQ==', 'sat_certificate': None, 'fiscal_folio': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 46, 48), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'xml_file_size': 6778, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:24,979 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'series': 'AA', 'folio': '98310', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 46, 43), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 24, 430632), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 24, 430635), 'issuer_rfc': 'AAE******3E6', 'issuer_name': 'ABASTECEDORA DE ALIMENTOS Y EMBUTIDOS VALLE HERMANOS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('2642.760000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('2642.760000'), 'digital_stamp': 'eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[:10]***MASKED***eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[-10:] ... (46 characters truncated) ... RrIJSadcJ3mzkuDdQPidA044+IzxtdR39XllOHhu6jOQx8xYNbD9yTkkLY7l41siqGOfBk1qy5g/ljtE+QeM24Oiv1jtsBWVNwj4utibT1YCDsu+3bdGIT42d1fyh8QkXcy0xTbbtnBegU1kY7A==', 'certificate_number': '00001000000514916510', 'certificate': None, 'sat_seal': 'G8ZhU7xmP1x6ezossLC1pwNDxLCPOz5PnIvHtS8a7zmzXs3+jG/zeZn42rVXj41+AhCTTm+JRLEB4D8rS2LfI/6RFQEas1mqyFOOoW2Uh7MQ052nvb/0q3LRMjc3rpeVIOCGFqRSQExPvz+HjnwaL ... (46 characters truncated) ... geNm9rffGT2s1Ms7S1X9DAJuIgyWsltA1oAotcizT6KkbVRBEVhUs5FgbqimZ+zp7eUjJuju5Z+EdZGejgvBBQrEyuOy3yXpQJC0fjmxE9wZAhG6RM9foQORRKdMnQ5DSphBT0oYF3Dq5Z5S/gQ==', 'sat_certificate': None, 'fiscal_folio': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 46, 48), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'xml_file_size': 6778, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:24,980 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml: Failed to save invoice to database
2025-07-18 15:22:25,702 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'details': '{"filename": "67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml", "processing_time": 4.374145746231079, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.374145746231079, 'memory_usage': None, 'filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 25, 160003)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:25,703 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'details': '{"filename": "67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml", "processing_time": 4.374145746231079, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.374145746231079, 'memory_usage': None, 'filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 25, 160003)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:31,111 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'series': None, 'folio': '51945', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 52, 28), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 30, 519229), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 30, 519233), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1108.300000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1108.300000'), 'digital_stamp': 'Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[:10]***MASKED***Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[-10:] ... (46 characters truncated) ... mO9yDGU8akqDctY9B40EdtXVfHif28phhO/haaeykGdaUVzDdWgDlXYqOWbHKIrpy2JXm+EO/SlACi1W/iohfgfmtDSat15nbw09YHBD9tDFOUZ4r2SZ0WcXwqX1bVHG09Ks+a6cZst/804/knw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WgSqOde5Bid5CM5dNiF7Q6HeDUtwwLL5AeF2yJwTpd4usxMT3LXbM1K8tZTTRT+2VtOQvtbUrJoGv4PZ0RSH0pDBYVEmPrKxcy4Ql1VUdbMIv7/cIIRRt7z0aAv52B7NNJRP2qd4sVmXoLa0P7OcJ ... (46 characters truncated) ... ZJryhPEssFMGfVx9qB/zvYqnBaoGHjEfd+q7Q0mYf7zYpBZsUA9eMNDy0JPEccBFrOhAIwUr11qR9nTfP72aQwQ8eASpodfR1tPQ+HTcI13E5Bpj5QGDgcVv31Uh2tChfvOXB3U5nvZAtfXkD8g==', 'sat_certificate': None, 'fiscal_folio': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 52, 29), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'xml_file_size': 6503, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:31,113 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'series': None, 'folio': '51945', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 52, 28), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 30, 519229), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 30, 519233), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1108.300000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1108.300000'), 'digital_stamp': 'Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[:10]***MASKED***Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[-10:] ... (46 characters truncated) ... mO9yDGU8akqDctY9B40EdtXVfHif28phhO/haaeykGdaUVzDdWgDlXYqOWbHKIrpy2JXm+EO/SlACi1W/iohfgfmtDSat15nbw09YHBD9tDFOUZ4r2SZ0WcXwqX1bVHG09Ks+a6cZst/804/knw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WgSqOde5Bid5CM5dNiF7Q6HeDUtwwLL5AeF2yJwTpd4usxMT3LXbM1K8tZTTRT+2VtOQvtbUrJoGv4PZ0RSH0pDBYVEmPrKxcy4Ql1VUdbMIv7/cIIRRt7z0aAv52B7NNJRP2qd4sVmXoLa0P7OcJ ... (46 characters truncated) ... ZJryhPEssFMGfVx9qB/zvYqnBaoGHjEfd+q7Q0mYf7zYpBZsUA9eMNDy0JPEccBFrOhAIwUr11qR9nTfP72aQwQ8eASpodfR1tPQ+HTcI13E5Bpj5QGDgcVv31Uh2tChfvOXB3U5nvZAtfXkD8g==', 'sat_certificate': None, 'fiscal_folio': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 52, 29), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'xml_file_size': 6503, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:31,114 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 68D6BCE1-2F64-4366-A174-68AB5975FD04.xml: Failed to save invoice to database
2025-07-18 15:22:31,870 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'details': '{"filename": "68D6BCE1-2F64-4366-A174-68AB5975FD04.xml", "processing_time": 5.409127235412598, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 5.409127235412598, 'memory_usage': None, 'filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 31, 290565)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:31,870 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'details': '{"filename": "68D6BCE1-2F64-4366-A174-68AB5975FD04.xml", "processing_time": 5.409127235412598, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 5.409127235412598, 'memory_usage': None, 'filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 31, 290565)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:34,382 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'series': None, 'folio': '012540015832846946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 0, 8, 4), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 33, 811394), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 33, 811397), 'issuer_rfc': 'BBA******LJ2', 'issuer_name': 'BBVA MEXICO, S.A., INSTITUCION DE BANCA MULTIPLE, GRUPO FINANCIERO BBVA MEXICO', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('0'), 'subtotal': Decimal('0.010000'), 'total_discount': Decimal('0.010000'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('0.000000'), 'digital_stamp': 'VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[:10]***MASKED***VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[-10:] ... (46 characters truncated) ... vKVUZwi6lhOLQRalJ4+1dHSayrOAC9t65uyGM7sp3LZnlSRVp2bB8uQRl7QBRMKB+72pDe46ovnRMoZyH1vhZtxVhLPffiIfWsu53F67UG9C5GuuQGW9BeCyCUVyJNiBZTwlWWJX2N5nseNoWbA==', 'certificate_number': '00001000000509478830', 'certificate': None, 'sat_seal': 'YY8ddVn3C615+iRMXrnaaHnI6S5XteXgZCuHwXVTCydxr8TSZwNhg36KMuPGv4k0E4jgEDGMehJ5qDGfqhlu1tt7Yign4pqRvKUrnt9MdwLLiVg5MMvOsg4SJqlNLquybsGtDydDIf2q51Vm7Evj5 ... (46 characters truncated) ... LmNxst5S6qB2jr6agF+7heNBgzHaLGQi8vGxBKMc8fi4Rz8b3Gbtro5k2dnNgBIz+wF8c3PuRJc6JPEecX50TP/AmqXzpzWAszR5qNvLrBee6tVydJuVNLc9QBLMqBweE8jp/kc5D3zThy6nv0g==', 'sat_certificate': None, 'fiscal_folio': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'stamp_datetime': datetime.datetime(2025, 7, 16, 5, 46, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'xml_file_size': 4838, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:34,384 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'series': None, 'folio': '012540015832846946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 0, 8, 4), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 33, 811394), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 33, 811397), 'issuer_rfc': 'BBA******LJ2', 'issuer_name': 'BBVA MEXICO, S.A., INSTITUCION DE BANCA MULTIPLE, GRUPO FINANCIERO BBVA MEXICO', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('0'), 'subtotal': Decimal('0.010000'), 'total_discount': Decimal('0.010000'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('0.000000'), 'digital_stamp': 'VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[:10]***MASKED***VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[-10:] ... (46 characters truncated) ... vKVUZwi6lhOLQRalJ4+1dHSayrOAC9t65uyGM7sp3LZnlSRVp2bB8uQRl7QBRMKB+72pDe46ovnRMoZyH1vhZtxVhLPffiIfWsu53F67UG9C5GuuQGW9BeCyCUVyJNiBZTwlWWJX2N5nseNoWbA==', 'certificate_number': '00001000000509478830', 'certificate': None, 'sat_seal': 'YY8ddVn3C615+iRMXrnaaHnI6S5XteXgZCuHwXVTCydxr8TSZwNhg36KMuPGv4k0E4jgEDGMehJ5qDGfqhlu1tt7Yign4pqRvKUrnt9MdwLLiVg5MMvOsg4SJqlNLquybsGtDydDIf2q51Vm7Evj5 ... (46 characters truncated) ... LmNxst5S6qB2jr6agF+7heNBgzHaLGQi8vGxBKMc8fi4Rz8b3Gbtro5k2dnNgBIz+wF8c3PuRJc6JPEecX50TP/AmqXzpzWAszR5qNvLrBee6tVydJuVNLc9QBLMqBweE8jp/kc5D3zThy6nv0g==', 'sat_certificate': None, 'fiscal_folio': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'stamp_datetime': datetime.datetime(2025, 7, 16, 5, 46, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'xml_file_size': 4838, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:34,385 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml: Failed to save invoice to database
2025-07-18 15:22:35,144 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'details': '{"filename": "72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml", "processing_time": 2.5129714012145996, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5129714012145996, 'memory_usage': None, 'filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 34, 574275)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:35,145 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'details': '{"filename": "72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml", "processing_time": 2.5129714012145996, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5129714012145996, 'memory_usage': None, 'filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 34, 574275)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:48,973 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'series': None, 'folio': '51947', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 57, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 48, 398877), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 48, 398879), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1063.180000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('31.720000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1094.900000'), 'digital_stamp': 'ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[:10]***MASKED***ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[-10:] ... (46 characters truncated) ... svl4JqGr5qfTiM7l2o32lR0gFNMv2KNiq6cnPNaAiaSZQdvrIf271TeB6gp83M9oQS9EpxkNFqr0OvCbgThlhQ8dh5FtIDgyaA0vAvwPcbtc+KqquKN1/lwPchtC/ffh55o3ar6I8RAs9TST8AQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CjF0ytYBzw4YQ4xvIbLpJK/02beDv7gWBYn2x1Gy+X3KasW5G3ygdRBfiIg9whVAYViNENDjSWt/eciWg4ggUGKoOrp87jdimiC1ZJx0/M/8m2u7eI+BcE3K8UiiJ5j34ZR8T+lTy6/CKnuP7E/+q ... (46 characters truncated) ... X7W2kcac//52/9Yncf2QA7eQiaqDuh0Jf6lyLg/Me8ywOSTf7oNqYPb6UeYdqLPuAzt6Wjn5vBkGixBLQmQrhrwT09YwI6IAZHs0sqqxkPlvnP12NmwAh8f6xMDY+kTs9ZXkhKAr8Fcju4amvnQ==', 'sat_certificate': None, 'fiscal_folio': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 57, 31), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'xml_file_size': 9661, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:48,974 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'series': None, 'folio': '51947', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 57, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 48, 398877), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 48, 398879), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1063.180000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('31.720000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1094.900000'), 'digital_stamp': 'ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[:10]***MASKED***ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[-10:] ... (46 characters truncated) ... svl4JqGr5qfTiM7l2o32lR0gFNMv2KNiq6cnPNaAiaSZQdvrIf271TeB6gp83M9oQS9EpxkNFqr0OvCbgThlhQ8dh5FtIDgyaA0vAvwPcbtc+KqquKN1/lwPchtC/ffh55o3ar6I8RAs9TST8AQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CjF0ytYBzw4YQ4xvIbLpJK/02beDv7gWBYn2x1Gy+X3KasW5G3ygdRBfiIg9whVAYViNENDjSWt/eciWg4ggUGKoOrp87jdimiC1ZJx0/M/8m2u7eI+BcE3K8UiiJ5j34ZR8T+lTy6/CKnuP7E/+q ... (46 characters truncated) ... X7W2kcac//52/9Yncf2QA7eQiaqDuh0Jf6lyLg/Me8ywOSTf7oNqYPb6UeYdqLPuAzt6Wjn5vBkGixBLQmQrhrwT09YwI6IAZHs0sqqxkPlvnP12NmwAh8f6xMDY+kTs9ZXkhKAr8Fcju4amvnQ==', 'sat_certificate': None, 'fiscal_folio': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 57, 31), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'xml_file_size': 9661, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:48,976 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml: Failed to save invoice to database
2025-07-18 15:22:49,733 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'details': '{"filename": "7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml", "processing_time": 13.829417705535889, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 13.829417705535889, 'memory_usage': None, 'filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 49, 165740)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:49,734 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'details': '{"filename": "7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml", "processing_time": 13.829417705535889, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 13.829417705535889, 'memory_usage': None, 'filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 49, 165740)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:53,432 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'series': None, 'folio': '51953', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 10, 17, 59), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 52, 828805), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 52, 828808), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3012.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3012.000000'), 'digital_stamp': 'I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[:10]***MASKED***I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[-10:] ... (46 characters truncated) ... W6254ZP+Jln31/46JIEITcQyaqb2QAJIC13oTUHqz2sn7uj+P3Gp+iUL1WR31hlwFOgjsjFTAPSVDxVtwGSsYsRIVKL7DfoXKf0yo88aopqTBazkM7WWmjFVPHazUy3EjVcHn/hAp8GyDyY67+g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'IA0LuN8ESSsldx/mrPnytSLLQj7Y9k64t5rKRn8vp3qOogrYyUV1AWMpZ+7TmLh8G7SPRHzQB78Zu5Y/epOBwQIGUh342rPB/8JiwtjNn3Ts3WuUy4SH5lq2HDW1r8prCzk/yr95bp2uIxg67Qe5D ... (46 characters truncated) ... omPHjnGQp6rQf8K345N0RMcFE6dGp+v9GgXU4vbhl19ntbNBpGdULDGsWTCl84Xq2zOnI8B/GcjSlr9I/2uKLQcNfDauwrYLcA+s8nCNv6VUJokis4x7b69cnv95tCM36rLBLfX83soKghAAEdA==', 'sat_certificate': None, 'fiscal_folio': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'stamp_datetime': datetime.datetime(2025, 7, 11, 11, 18), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'xml_file_size': 5362, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:53,433 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'series': None, 'folio': '51953', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 10, 17, 59), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 52, 828805), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 52, 828808), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3012.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3012.000000'), 'digital_stamp': 'I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[:10]***MASKED***I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[-10:] ... (46 characters truncated) ... W6254ZP+Jln31/46JIEITcQyaqb2QAJIC13oTUHqz2sn7uj+P3Gp+iUL1WR31hlwFOgjsjFTAPSVDxVtwGSsYsRIVKL7DfoXKf0yo88aopqTBazkM7WWmjFVPHazUy3EjVcHn/hAp8GyDyY67+g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'IA0LuN8ESSsldx/mrPnytSLLQj7Y9k64t5rKRn8vp3qOogrYyUV1AWMpZ+7TmLh8G7SPRHzQB78Zu5Y/epOBwQIGUh342rPB/8JiwtjNn3Ts3WuUy4SH5lq2HDW1r8prCzk/yr95bp2uIxg67Qe5D ... (46 characters truncated) ... omPHjnGQp6rQf8K345N0RMcFE6dGp+v9GgXU4vbhl19ntbNBpGdULDGsWTCl84Xq2zOnI8B/GcjSlr9I/2uKLQcNfDauwrYLcA+s8nCNv6VUJokis4x7b69cnv95tCM36rLBLfX83soKghAAEdA==', 'sat_certificate': None, 'fiscal_folio': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'stamp_datetime': datetime.datetime(2025, 7, 11, 11, 18), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'xml_file_size': 5362, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:53,434 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7C7ADAA8-D609-49EC-A136-064B76B76857.xml: Failed to save invoice to database
2025-07-18 15:22:54,243 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'details': '{"filename": "7C7ADAA8-D609-49EC-A136-064B76B76857.xml", "processing_time": 3.699014186859131, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.699014186859131, 'memory_usage': None, 'filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 53, 628098)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:54,244 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'details': '{"filename": "7C7ADAA8-D609-49EC-A136-064B76B76857.xml", "processing_time": 3.699014186859131, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.699014186859131, 'memory_usage': None, 'filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 53, 628098)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:58,849 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'series': None, 'folio': '52014', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 59, 20), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 58, 296156), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 58, 296159), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('261.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('261.000000'), 'digital_stamp': 'G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[:10]***MASKED***G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[-10:] ... (46 characters truncated) ... 2+ACWYOMvUC5obLOu3CdV+yvn7JvtSIvsZ4LNAHVLR0pj0NS00wqPAMNlyejo1WKyKlhso5YonRVAdbQRHuVI4RWeSW7KgZh4rNWUhgfkO//A4Khu7WIhC17aBLGZJfT8o5Jn5tA1R/5u5DzKCA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WuKCjGMjNryqj9spYRpB28VhACtB+TYM6g5PtkEZBc6i7Fi+4kaDcsxiGj7QJlo5auaeTeVY1qqzGvRKPUhZQfXaFjk3Z/EEZyl+HvSIvIPLNWkrazNtPgwzjp7rfewGkhBndIyC9lhXKCTfocc03 ... (46 characters truncated) ... X5k4nWT/KrRHwDNUe5jnBbAXCAs4NfRaW/dDjVai3kG9ojzk5CQDxlrfk99HWqOgKBxB8q2JOi+88q0yj8cSX0MCYR/e+l8GRnkAkQRh1ZkKVLnAoaF6iuK+XhPxqueDT9uF4nljvBj7IobUqsQ==', 'sat_certificate': None, 'fiscal_folio': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 59, 21), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'xml_file_size': 6884, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:58,851 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'series': None, 'folio': '52014', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 59, 20), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 58, 296156), 'updated_at': datetime.datetime(2025, 7, 18, 22, 22, 58, 296159), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('261.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('261.000000'), 'digital_stamp': 'G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[:10]***MASKED***G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[-10:] ... (46 characters truncated) ... 2+ACWYOMvUC5obLOu3CdV+yvn7JvtSIvsZ4LNAHVLR0pj0NS00wqPAMNlyejo1WKyKlhso5YonRVAdbQRHuVI4RWeSW7KgZh4rNWUhgfkO//A4Khu7WIhC17aBLGZJfT8o5Jn5tA1R/5u5DzKCA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WuKCjGMjNryqj9spYRpB28VhACtB+TYM6g5PtkEZBc6i7Fi+4kaDcsxiGj7QJlo5auaeTeVY1qqzGvRKPUhZQfXaFjk3Z/EEZyl+HvSIvIPLNWkrazNtPgwzjp7rfewGkhBndIyC9lhXKCTfocc03 ... (46 characters truncated) ... X5k4nWT/KrRHwDNUe5jnBbAXCAs4NfRaW/dDjVai3kG9ojzk5CQDxlrfk99HWqOgKBxB8q2JOi+88q0yj8cSX0MCYR/e+l8GRnkAkQRh1ZkKVLnAoaF6iuK+XhPxqueDT9uF4nljvBj7IobUqsQ==', 'sat_certificate': None, 'fiscal_folio': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 59, 21), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'xml_file_size': 6884, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:58,852 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml: Failed to save invoice to database
2025-07-18 15:22:59,586 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'details': '{"filename": "7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml", "processing_time": 4.605685472488403, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.605685472488403, 'memory_usage': None, 'filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 59, 36795)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:22:59,587 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'details': '{"filename": "7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml", "processing_time": 4.605685472488403, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.605685472488403, 'memory_usage': None, 'filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 22, 59, 36795)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:01,085 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'details': '{"filename": "7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml", "processing_time": 0.7819650173187256, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 7EC2C80D-447B-41D7-A5D7-64B42CFE6860 already exists"}', 'execution_time': 0.7819650173187256, 'memory_usage': None, 'filename': '7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 0, 543850)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:01,086 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'details': '{"filename": "7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml", "processing_time": 0.7819650173187256, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 7EC2C80D-447B-41D7-A5D7-64B42CFE6860 already exists"}', 'execution_time': 0.7819650173187256, 'memory_usage': None, 'filename': '7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 0, 543850)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:02,620 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'details': '{"filename": "86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml", "processing_time": 0.7655572891235352, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6 already exists"}', 'execution_time': 0.7655572891235352, 'memory_usage': None, 'filename': '86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 2, 27691)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:02,621 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'details': '{"filename": "86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml", "processing_time": 0.7655572891235352, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6 already exists"}', 'execution_time': 0.7655572891235352, 'memory_usage': None, 'filename': '86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 2, 27691)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:11,775 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'series': None, 'folio': '52275', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 14, 18), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 11, 229100), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 11, 229103), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3138.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3138.200000'), 'digital_stamp': 'JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[:10]***MASKED***JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[-10:] ... (46 characters truncated) ... 60yEVtjwdAwTZrLiaNcaAft67dVl+XIBpiXEgwtCXcxphW3cZbZYpThwAzpC3S9ObSQ7rF3Pv1SxyFLE5pSohnuziFHlNDJ8RTIE/bSr/F3qwzuJsENncFCcOw+DZhRttCjZgNCDS8WfRK6Bldw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'h6DA6XLBQsUGGT+itnd+6ChhvF2FK3ZtnwCVDPBQ4/vs1AvKWt2ktiF4SBgS+dHlwbRxbZ1QNOOpDxQTYWrFIxUBojnYTAY/l8tUnb3NyzNgXOqPMIdLuOxkHQPA9CzUMEadRrIGtwGrxxahSCVyD ... (46 characters truncated) ... rK8mw2/E+PMRQ6Xk5LrI2OzxnHiT5/cyuB3YMuKjLc1Haw+sqXH5uWP+b1YF/quxTL2HIZ3gLeG71ReOnXi9kGEsN45zRZNqnVJdmNb1iZtpBQEDU0epRo8EAcrAnD1rnPINGgIcRpJ5firks1Q==', 'sat_certificate': None, 'fiscal_folio': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 14, 19), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'xml_file_size': 8765, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:11,777 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'series': None, 'folio': '52275', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 14, 18), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 11, 229100), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 11, 229103), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3138.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3138.200000'), 'digital_stamp': 'JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[:10]***MASKED***JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[-10:] ... (46 characters truncated) ... 60yEVtjwdAwTZrLiaNcaAft67dVl+XIBpiXEgwtCXcxphW3cZbZYpThwAzpC3S9ObSQ7rF3Pv1SxyFLE5pSohnuziFHlNDJ8RTIE/bSr/F3qwzuJsENncFCcOw+DZhRttCjZgNCDS8WfRK6Bldw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'h6DA6XLBQsUGGT+itnd+6ChhvF2FK3ZtnwCVDPBQ4/vs1AvKWt2ktiF4SBgS+dHlwbRxbZ1QNOOpDxQTYWrFIxUBojnYTAY/l8tUnb3NyzNgXOqPMIdLuOxkHQPA9CzUMEadRrIGtwGrxxahSCVyD ... (46 characters truncated) ... rK8mw2/E+PMRQ6Xk5LrI2OzxnHiT5/cyuB3YMuKjLc1Haw+sqXH5uWP+b1YF/quxTL2HIZ3gLeG71ReOnXi9kGEsN45zRZNqnVJdmNb1iZtpBQEDU0epRo8EAcrAnD1rnPINGgIcRpJ5firks1Q==', 'sat_certificate': None, 'fiscal_folio': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 14, 19), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'xml_file_size': 8765, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:11,778 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml: Failed to save invoice to database
2025-07-18 15:23:12,560 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'details': '{"filename": "890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml", "processing_time": 9.155040502548218, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 9.155040502548218, 'memory_usage': None, 'filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 11, 963770)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:12,561 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'details': '{"filename": "890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml", "processing_time": 9.155040502548218, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 9.155040502548218, 'memory_usage': None, 'filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 11, 963770)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:19,202 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'series': None, 'folio': '52044', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 8, 50, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 18, 636568), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 18, 636571), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('109.380000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('109.380000'), 'digital_stamp': 'SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[:10]***MASKED***SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[-10:] ... (46 characters truncated) ... MfJr0ycOzaOntLYC7fqdFLbR0/IhbMXRre5/fEPC1H5hL/i/6oYsVBzp7Y1p6PoUhyxpQwnF9qCyvz/XBzwPQl6zBwPzkxyDUlPW/4dfIxtyXx3eqRufHbQhT9z/634GK9fBqf6YH1WQKmPgLkg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'H9SavebmCHIfU1/97lrmkbggBXHfxYasyiDJ8LzWpbMPfAWADJtJ+aBDsGeoTuWS/0tDpLM3ovvA9D7y/mc1MGVAG9YEEj571vi4oGjWw3+3S1kNtWnDRZzgLZ5kNbaHTCEj4Uf+UgY2ofMmYYeyL ... (46 characters truncated) ... M5Q75/moBKfVYKfAmQ49Gubw31wMexiLoIdzGXUCK0o6yCJ7RepZ8tWcEop84HqWrqxODdXcw2pXv9dQQB0ZZ6ghjW+PKielcctszhga4khRTCDalYTx/yrfEr27pkzWrvZ2R6wDQ7TtpAS0KNA==', 'sat_certificate': None, 'fiscal_folio': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'stamp_datetime': datetime.datetime(2025, 7, 13, 9, 50, 34), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'xml_file_size': 5737, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:19,204 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'series': None, 'folio': '52044', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 8, 50, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 18, 636568), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 18, 636571), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('109.380000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('109.380000'), 'digital_stamp': 'SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[:10]***MASKED***SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[-10:] ... (46 characters truncated) ... MfJr0ycOzaOntLYC7fqdFLbR0/IhbMXRre5/fEPC1H5hL/i/6oYsVBzp7Y1p6PoUhyxpQwnF9qCyvz/XBzwPQl6zBwPzkxyDUlPW/4dfIxtyXx3eqRufHbQhT9z/634GK9fBqf6YH1WQKmPgLkg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'H9SavebmCHIfU1/97lrmkbggBXHfxYasyiDJ8LzWpbMPfAWADJtJ+aBDsGeoTuWS/0tDpLM3ovvA9D7y/mc1MGVAG9YEEj571vi4oGjWw3+3S1kNtWnDRZzgLZ5kNbaHTCEj4Uf+UgY2ofMmYYeyL ... (46 characters truncated) ... M5Q75/moBKfVYKfAmQ49Gubw31wMexiLoIdzGXUCK0o6yCJ7RepZ8tWcEop84HqWrqxODdXcw2pXv9dQQB0ZZ6ghjW+PKielcctszhga4khRTCDalYTx/yrfEr27pkzWrvZ2R6wDQ7TtpAS0KNA==', 'sat_certificate': None, 'fiscal_folio': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'stamp_datetime': datetime.datetime(2025, 7, 13, 9, 50, 34), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'xml_file_size': 5737, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:19,205 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml: Failed to save invoice to database
2025-07-18 15:23:19,964 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'details': '{"filename": "89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml", "processing_time": 6.642813444137573, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.642813444137573, 'memory_usage': None, 'filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 19, 387522)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:19,965 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'details': '{"filename": "89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml", "processing_time": 6.642813444137573, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.642813444137573, 'memory_usage': None, 'filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 19, 387522)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:21,479 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'series': None, 'folio': '52281', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 14, 7, 38), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 20, 930960), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 20, 930963), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('163.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('163.200000'), 'digital_stamp': 'e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[:10]***MASKED***e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[-10:] ... (46 characters truncated) ... CKrdmJe7xZGjKk0P2UsG+6Zf9ardhKFbQ4o+LqasilLiEgmJMiqXQmxTmIOwv7p4EPkXZKOIQOAVUiVQ700xWdK9mTgcNW2pomcUAhxrgh0PnU0GfKE14W3zJv/gZ/4pnvP+mTr/JOe45lIdlDw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZtU/d9gaFDsoZPP837B5qfKCelTW7aNJzUAKMZfgZ2kBaTWT/aQl0q0gqGQ/HZ4Z4tJe+MzjUehK0o3basJ7LTdr+R5v5gRowVP1hm96amerwV1HRRa5dXBMhebTKtKno5xjNgEpR39Ya2yGIhz7i ... (46 characters truncated) ... H/pphRyJXacTC61Wpe4FFPCdt7sRONFvJdapIkUHfl7o1/0LADPQATrGFnRjlAscUB75xDRnquJeqbeRLSJxiKLO/eOyEFsfH5XWnqZThK7WvVINPDv/dpwrh8SO5TRzoApVWT329wfSRx9335Q==', 'sat_certificate': None, 'fiscal_folio': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'stamp_datetime': datetime.datetime(2025, 7, 18, 15, 7, 39), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'xml_file_size': 4979, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:21,481 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'series': None, 'folio': '52281', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 14, 7, 38), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 20, 930960), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 20, 930963), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('163.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('163.200000'), 'digital_stamp': 'e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[:10]***MASKED***e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[-10:] ... (46 characters truncated) ... CKrdmJe7xZGjKk0P2UsG+6Zf9ardhKFbQ4o+LqasilLiEgmJMiqXQmxTmIOwv7p4EPkXZKOIQOAVUiVQ700xWdK9mTgcNW2pomcUAhxrgh0PnU0GfKE14W3zJv/gZ/4pnvP+mTr/JOe45lIdlDw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZtU/d9gaFDsoZPP837B5qfKCelTW7aNJzUAKMZfgZ2kBaTWT/aQl0q0gqGQ/HZ4Z4tJe+MzjUehK0o3basJ7LTdr+R5v5gRowVP1hm96amerwV1HRRa5dXBMhebTKtKno5xjNgEpR39Ya2yGIhz7i ... (46 characters truncated) ... H/pphRyJXacTC61Wpe4FFPCdt7sRONFvJdapIkUHfl7o1/0LADPQATrGFnRjlAscUB75xDRnquJeqbeRLSJxiKLO/eOyEFsfH5XWnqZThK7WvVINPDv/dpwrh8SO5TRzoApVWT329wfSRx9335Q==', 'sat_certificate': None, 'fiscal_folio': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'stamp_datetime': datetime.datetime(2025, 7, 18, 15, 7, 39), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'xml_file_size': 4979, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:21,482 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml: Failed to save invoice to database
2025-07-18 15:23:22,246 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'details': '{"filename": "902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml", "processing_time": 1.515047311782837, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.515047311782837, 'memory_usage': None, 'filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 21, 654269)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:22,247 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'details': '{"filename": "902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml", "processing_time": 1.515047311782837, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.515047311782837, 'memory_usage': None, 'filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 21, 654269)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:26,050 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'series': None, 'folio': '52012', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 52, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 25, 484228), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 25, 484232), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('242.880000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('9.120000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('252.000000'), 'digital_stamp': 'gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[:10]***MASKED***gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[-10:] ... (46 characters truncated) ... VwAu/nayKPSJNzbZu7Gf3tlq0ox/j5qD7oQwOxGYC8y9vzkfZaizM1Q3n1ViGkI9z7ppGQVMbZDouNlBEuCZRYZmErD4AWlI0b8yBU1fis4NpTUpEkEcnhoEC81romCGvKYMuR7BVl/AX+l7H8A==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'dTccMvYzlKfBjQl2lh+gLHUlulpRI7iIyy9GG7+Rg61o+NFGQnLCekPKtrWLxYMvYfCWZocFhZ2lAeQkOZYqNOdzEMSsjFhBNv4dbsEbksL1cowkDXr45PsnA8XS5rRNC646U/Ggmu7rYYi+/E7bm ... (46 characters truncated) ... RvLu1CRy94JhZNe4usp26Ns1wRSwHYxPG+xkXvxjkSsfNIpI6qaYVeB2f1Vwgrm+VfagEVUY9dR9YkvVFfxMOPY8VDPR3kQpVtwjwW13n2Uq2En53xdQHEo2CfL0N2D50qRt5yDNqeTJk/r76DQ==', 'sat_certificate': None, 'fiscal_folio': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 52, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'xml_file_size': 5862, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:26,052 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'series': None, 'folio': '52012', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 52, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 25, 484228), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 25, 484232), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('242.880000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('9.120000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('252.000000'), 'digital_stamp': 'gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[:10]***MASKED***gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[-10:] ... (46 characters truncated) ... VwAu/nayKPSJNzbZu7Gf3tlq0ox/j5qD7oQwOxGYC8y9vzkfZaizM1Q3n1ViGkI9z7ppGQVMbZDouNlBEuCZRYZmErD4AWlI0b8yBU1fis4NpTUpEkEcnhoEC81romCGvKYMuR7BVl/AX+l7H8A==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'dTccMvYzlKfBjQl2lh+gLHUlulpRI7iIyy9GG7+Rg61o+NFGQnLCekPKtrWLxYMvYfCWZocFhZ2lAeQkOZYqNOdzEMSsjFhBNv4dbsEbksL1cowkDXr45PsnA8XS5rRNC646U/Ggmu7rYYi+/E7bm ... (46 characters truncated) ... RvLu1CRy94JhZNe4usp26Ns1wRSwHYxPG+xkXvxjkSsfNIpI6qaYVeB2f1Vwgrm+VfagEVUY9dR9YkvVFfxMOPY8VDPR3kQpVtwjwW13n2Uq2En53xdQHEo2CfL0N2D50qRt5yDNqeTJk/r76DQ==', 'sat_certificate': None, 'fiscal_folio': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 52, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'xml_file_size': 5862, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:26,053 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 91726F17-192C-440F-B346-C2D75CE9D8F5.xml: Failed to save invoice to database
2025-07-18 15:23:26,790 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'details': '{"filename": "91726F17-192C-440F-B346-C2D75CE9D8F5.xml", "processing_time": 3.8048195838928223, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.8048195838928223, 'memory_usage': None, 'filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 26, 237608)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:26,791 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'details': '{"filename": "91726F17-192C-440F-B346-C2D75CE9D8F5.xml", "processing_time": 3.8048195838928223, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.8048195838928223, 'memory_usage': None, 'filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 26, 237608)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:28,334 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'details': '{"filename": "978d18b7-b0c4-420d-9529-6c3eb2cac218.xml", "processing_time": 0.8187167644500732, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 978d18b7-b0c4-420d-9529-6c3eb2cac218 already exists"}', 'execution_time': 0.8187167644500732, 'memory_usage': None, 'filename': '978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 27, 794552)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:28,335 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'details': '{"filename": "978d18b7-b0c4-420d-9529-6c3eb2cac218.xml", "processing_time": 0.8187167644500732, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 978d18b7-b0c4-420d-9529-6c3eb2cac218 already exists"}', 'execution_time': 0.8187167644500732, 'memory_usage': None, 'filename': '978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 27, 794552)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:38,021 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'series': None, 'folio': '52013', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 58, 3), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 37, 427349), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 37, 427352), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1161.560000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1161.560000'), 'digital_stamp': 'eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[:10]***MASKED***eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[-10:] ... (46 characters truncated) ... GXr/JXM+M2F8kEDw0vkyNg+QJDL6fmWHXRtZQOYhfwO2zl2CN/w2zulKTjVLyH6ZY80+zrOSS8nz6IS7yNNldcH6TDgnQDxOF1XZmkoid4AC0WlHy9MRXRFQGGspYN7CXHmhFI76st2mWf4Pw8g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'BXwFOlIe4jWApHegUiUNupFX8guKtCkFPnQKuhiDZqOzUn7iJjD+bw67KVHuDg29419PScHapzGhYk50P+tjmb51pqjKOgsgkGJdeCBsBdORM7aaP6XV62g2rcSiU6vLrPmzuqarZlfJvWRO6Ujxu ... (46 characters truncated) ... MFkd6Ncmx/DY63ZzdpJcfyxYHVDP505OqEbg8I0Vg1EPYpxDfEcdsgHvlBrQGBtXRIe3sEQubXIhvK13sIgGPCOkkxvQnHz36UeTCvpOXBSWaSia5vt6smhurjx6JVH0JkmKaHCr4bUy4fsV28g==', 'sat_certificate': None, 'fiscal_folio': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 58, 4), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'xml_file_size': 9502, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:38,023 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'series': None, 'folio': '52013', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 58, 3), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 37, 427349), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 37, 427352), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1161.560000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1161.560000'), 'digital_stamp': 'eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[:10]***MASKED***eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[-10:] ... (46 characters truncated) ... GXr/JXM+M2F8kEDw0vkyNg+QJDL6fmWHXRtZQOYhfwO2zl2CN/w2zulKTjVLyH6ZY80+zrOSS8nz6IS7yNNldcH6TDgnQDxOF1XZmkoid4AC0WlHy9MRXRFQGGspYN7CXHmhFI76st2mWf4Pw8g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'BXwFOlIe4jWApHegUiUNupFX8guKtCkFPnQKuhiDZqOzUn7iJjD+bw67KVHuDg29419PScHapzGhYk50P+tjmb51pqjKOgsgkGJdeCBsBdORM7aaP6XV62g2rcSiU6vLrPmzuqarZlfJvWRO6Ujxu ... (46 characters truncated) ... MFkd6Ncmx/DY63ZzdpJcfyxYHVDP505OqEbg8I0Vg1EPYpxDfEcdsgHvlBrQGBtXRIe3sEQubXIhvK13sIgGPCOkkxvQnHz36UeTCvpOXBSWaSia5vt6smhurjx6JVH0JkmKaHCr4bUy4fsV28g==', 'sat_certificate': None, 'fiscal_folio': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 58, 4), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'xml_file_size': 9502, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:38,025 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml: Failed to save invoice to database
2025-07-18 15:23:38,789 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'details': '{"filename": "9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml", "processing_time": 9.687952518463135, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 9.687952518463135, 'memory_usage': None, 'filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 38, 209331)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:38,790 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'details': '{"filename": "9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml", "processing_time": 9.687952518463135, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 9.687952518463135, 'memory_usage': None, 'filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 38, 209331)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:45,051 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'series': None, 'folio': '52123', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 13, 26), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 44, 492928), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 44, 492932), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('468.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('75.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('543.990000'), 'digital_stamp': 'bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[:10]***MASKED***bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[-10:] ... (46 characters truncated) ... uPLImTofyDHIhR0Pn/U8TYfHzwq+ws56BI02Sg5t8w7wsiPo1X4kY72vsG+kF2ru+L3KfgO658alO5i4hlyiqFlonp87Go1+1lSF+IhgCOg/UNyPvZJ3fJyzlsCcl2Y8/nSMxzgwQZrkqpmSzsg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'QNrrWbSpBVgvlpJ/H1S80LpmsRtxhxSBHz5IB/x8lnpidM8ViyBU/2iYDl3FvwVPwGbakBuIn1NS9LDY00IUGRkcOAM0koKJgwapvWf4ww6/OCGbq7irGDQtyUJMUd1BaARMBfLSC5AN90EqqoMJ1 ... (46 characters truncated) ... vt9dVZEHi9yuXsvFvYhZEO//y+aZJPyngmwQ+y/Jf4NpMRtUqhi1cOy4CcC3T+iaMIbna0j4aiptj7G2iHsg9l5KTMf9Tu5SCXpQLU+6AShk9wlNPiC7rmhikWEyuuJZzOwk7EK2capbtTatziQ==', 'sat_certificate': None, 'fiscal_folio': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 13, 27), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'xml_file_size': 5787, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:45,053 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'series': None, 'folio': '52123', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 13, 26), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 44, 492928), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 44, 492932), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('468.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('75.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('543.990000'), 'digital_stamp': 'bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[:10]***MASKED***bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[-10:] ... (46 characters truncated) ... uPLImTofyDHIhR0Pn/U8TYfHzwq+ws56BI02Sg5t8w7wsiPo1X4kY72vsG+kF2ru+L3KfgO658alO5i4hlyiqFlonp87Go1+1lSF+IhgCOg/UNyPvZJ3fJyzlsCcl2Y8/nSMxzgwQZrkqpmSzsg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'QNrrWbSpBVgvlpJ/H1S80LpmsRtxhxSBHz5IB/x8lnpidM8ViyBU/2iYDl3FvwVPwGbakBuIn1NS9LDY00IUGRkcOAM0koKJgwapvWf4ww6/OCGbq7irGDQtyUJMUd1BaARMBfLSC5AN90EqqoMJ1 ... (46 characters truncated) ... vt9dVZEHi9yuXsvFvYhZEO//y+aZJPyngmwQ+y/Jf4NpMRtUqhi1cOy4CcC3T+iaMIbna0j4aiptj7G2iHsg9l5KTMf9Tu5SCXpQLU+6AShk9wlNPiC7rmhikWEyuuJZzOwk7EK2capbtTatziQ==', 'sat_certificate': None, 'fiscal_folio': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 13, 27), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'xml_file_size': 5787, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:45,054 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml: Failed to save invoice to database
2025-07-18 15:23:45,803 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'details': '{"filename": "9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml", "processing_time": 6.262282609939575, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.262282609939575, 'memory_usage': None, 'filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 45, 255701)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:45,804 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'details': '{"filename": "9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml", "processing_time": 6.262282609939575, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.262282609939575, 'memory_usage': None, 'filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 45, 255701)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:49,439 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'series': None, 'folio': '51948', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 58, 1), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 48, 843509), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 48, 843513), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('189.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('189.000000'), 'digital_stamp': 'M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[:10]***MASKED***M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[-10:] ... (46 characters truncated) ... q4kbt1HC6I8reGPsNE7XRtWGIlFxI+e+XlobsY0q5f0jUjUT5nFgbkRY6aHzO3/6NpLsUNk3PWLZX9BReLfzRz+GD43kXkz6L/vD9aftcbIw3fA6TT+iz7lJQdTNoI49e1eOZcpBy8/ze8uBkbA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'HsDEFchuSNrTOT8mjInqTIokbfeg8FGZ9ZqdFfspO6sS4Ni1N9QvgZL6dwdcQqU6kLUVsnj117kPX9pIjPs9NwUFgtjtQrKOL/gfws7frnh6w5zDVAOfFJ1cFLdlAGMkeKzPNmYgGjxFrorr0ARzb ... (46 characters truncated) ... SQ+mF+5cYZhB2fkceduIPv3rYWUrjBGXVzcgEAtMYDCoO2LZKNFlailMlQCWDrm+wiwrcoFJ8WnLpAQtVkDaFbK8/3f7wa7MyvS0c+PWPjjb1pwQkeZiUB/M5szIG/nI0st03hFDth9IJUzJyug==', 'sat_certificate': None, 'fiscal_folio': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 58, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'xml_file_size': 6490, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:49,441 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'series': None, 'folio': '51948', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 58, 1), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 48, 843509), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 48, 843513), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('189.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('189.000000'), 'digital_stamp': 'M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[:10]***MASKED***M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[-10:] ... (46 characters truncated) ... q4kbt1HC6I8reGPsNE7XRtWGIlFxI+e+XlobsY0q5f0jUjUT5nFgbkRY6aHzO3/6NpLsUNk3PWLZX9BReLfzRz+GD43kXkz6L/vD9aftcbIw3fA6TT+iz7lJQdTNoI49e1eOZcpBy8/ze8uBkbA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'HsDEFchuSNrTOT8mjInqTIokbfeg8FGZ9ZqdFfspO6sS4Ni1N9QvgZL6dwdcQqU6kLUVsnj117kPX9pIjPs9NwUFgtjtQrKOL/gfws7frnh6w5zDVAOfFJ1cFLdlAGMkeKzPNmYgGjxFrorr0ARzb ... (46 characters truncated) ... SQ+mF+5cYZhB2fkceduIPv3rYWUrjBGXVzcgEAtMYDCoO2LZKNFlailMlQCWDrm+wiwrcoFJ8WnLpAQtVkDaFbK8/3f7wa7MyvS0c+PWPjjb1pwQkeZiUB/M5szIG/nI0st03hFDth9IJUzJyug==', 'sat_certificate': None, 'fiscal_folio': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 58, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'xml_file_size': 6490, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:49,442 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process A2176A66-1047-4B31-B9D7-46930A70BB71.xml: Failed to save invoice to database
2025-07-18 15:23:50,226 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'details': '{"filename": "A2176A66-1047-4B31-B9D7-46930A70BB71.xml", "processing_time": 3.63630747795105, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.63630747795105, 'memory_usage': None, 'filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 49, 624826)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:50,227 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'details': '{"filename": "A2176A66-1047-4B31-B9D7-46930A70BB71.xml", "processing_time": 3.63630747795105, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.63630747795105, 'memory_usage': None, 'filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 49, 624826)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:54,619 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'series': 'B', 'folio': '120734893', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 20, 45), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 54, 63871), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 54, 63874), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('763.780000'), 'total_discount': Decimal('157.920000'), 'total_transferred_taxes': Decimal('96.930000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('702.790000'), 'digital_stamp': 'TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[:10]***MASKED***TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[-10:] ... (46 characters truncated) ... gYDBzhaGv6XsXSyLUKJomBlcLycVpWPotn14TUQeyolnwTceXiKF1c9DzJdM3WStPzjj4mTrqI6Gm9nbxAZsMcP1iWsrxOVw8sVfKDMF/VqqGoB1MkcD9QGON8tXY8VGYBeMsDsiblvgRCTZSAw==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'Dm2TiMEfHoq4sN+G35WGpGRW2k4cKdbAyH9K7GSnXxTTKPVPpmUVSRrPnP1IJMLsAJ2225CrUQv5rNTdUb5mg1pthcMDwS/uvjZCEK+cxuNwGRk/dBlMj0xptSDmQRdEGYWWOs2D82clKLVTxc6nP ... (46 characters truncated) ... UjSvdYQGln2UUu5I3pCBEvq5oLnOsF5SANYQqg0vfbnJh3kEl6G+wo3z2kzLkaO1tsIfZeOZhx2ipX1P4eYGMcvO01VsYp0ItKnccpKCjwI3Do4HieSULXnQ+WHT576/Vo+xMwi7cSXhm58OASA==', 'sat_certificate': None, 'fiscal_folio': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 45, 1), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'xml_file_size': 6164, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:54,621 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'series': 'B', 'folio': '120734893', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 20, 45), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 54, 63871), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 54, 63874), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('763.780000'), 'total_discount': Decimal('157.920000'), 'total_transferred_taxes': Decimal('96.930000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('702.790000'), 'digital_stamp': 'TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[:10]***MASKED***TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[-10:] ... (46 characters truncated) ... gYDBzhaGv6XsXSyLUKJomBlcLycVpWPotn14TUQeyolnwTceXiKF1c9DzJdM3WStPzjj4mTrqI6Gm9nbxAZsMcP1iWsrxOVw8sVfKDMF/VqqGoB1MkcD9QGON8tXY8VGYBeMsDsiblvgRCTZSAw==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'Dm2TiMEfHoq4sN+G35WGpGRW2k4cKdbAyH9K7GSnXxTTKPVPpmUVSRrPnP1IJMLsAJ2225CrUQv5rNTdUb5mg1pthcMDwS/uvjZCEK+cxuNwGRk/dBlMj0xptSDmQRdEGYWWOs2D82clKLVTxc6nP ... (46 characters truncated) ... UjSvdYQGln2UUu5I3pCBEvq5oLnOsF5SANYQqg0vfbnJh3kEl6G+wo3z2kzLkaO1tsIfZeOZhx2ipX1P4eYGMcvO01VsYp0ItKnccpKCjwI3Do4HieSULXnQ+WHT576/Vo+xMwi7cSXhm58OASA==', 'sat_certificate': None, 'fiscal_folio': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 45, 1), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'xml_file_size': 6164, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:54,622 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AE64C43A-6733-4033-A3B7-18926E1210E7.xml: Failed to save invoice to database
2025-07-18 15:23:55,363 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'details': '{"filename": "AE64C43A-6733-4033-A3B7-18926E1210E7.xml", "processing_time": 4.393534183502197, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.393534183502197, 'memory_usage': None, 'filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 54, 810903)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:55,363 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'details': '{"filename": "AE64C43A-6733-4033-A3B7-18926E1210E7.xml", "processing_time": 4.393534183502197, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.393534183502197, 'memory_usage': None, 'filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 54, 810903)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:58,854 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'series': None, 'folio': '52186', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 58, 290236), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 58, 290239), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1298.820000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1298.820000'), 'digital_stamp': 'fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[:10]***MASKED***fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[-10:] ... (46 characters truncated) ... d55GvEOk1N4ja85crGISWLczobZfciP3r/LnEs1+XHWAAWdB85LDms0wkdBxkdO0+3oBNUFPp01Bun760LIQOCcNVsSXGYC2V5dGa5p66ZfLNNBjL7Q3sT63Fng0Xq44fHhYME6njqkY5Laguxw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'lLhkkLQxANilHuVth2NFoQmCEVzA4vpxyE8bzqhEHQqL3eraltIatqu/30vzKD/P76vETZm/jpq+oFjNRL1DPbp3UEqZUdAwXnX+uqqJa86h+O+KrcuHKQMSCJydGajaAanbeAtz8H1KffCB+53G+ ... (46 characters truncated) ... hdP4bHpukDDb1v/Oap6M1PcwX9AI6rRqKuvNqfHCR2xhqayxahaSnvnzeqHhrFGClJLG8ouETK0FFQAU6rsd/drPQ80HUS0+ieY8C8+gL81kjp6WUQkpohfVk7M7+3hs6TpuEnNiV4CS7ka1LWg==', 'sat_certificate': None, 'fiscal_folio': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'xml_file_size': 9151, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:58,855 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'series': None, 'folio': '52186', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 58, 290236), 'updated_at': datetime.datetime(2025, 7, 18, 22, 23, 58, 290239), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1298.820000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1298.820000'), 'digital_stamp': 'fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[:10]***MASKED***fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[-10:] ... (46 characters truncated) ... d55GvEOk1N4ja85crGISWLczobZfciP3r/LnEs1+XHWAAWdB85LDms0wkdBxkdO0+3oBNUFPp01Bun760LIQOCcNVsSXGYC2V5dGa5p66ZfLNNBjL7Q3sT63Fng0Xq44fHhYME6njqkY5Laguxw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'lLhkkLQxANilHuVth2NFoQmCEVzA4vpxyE8bzqhEHQqL3eraltIatqu/30vzKD/P76vETZm/jpq+oFjNRL1DPbp3UEqZUdAwXnX+uqqJa86h+O+KrcuHKQMSCJydGajaAanbeAtz8H1KffCB+53G+ ... (46 characters truncated) ... hdP4bHpukDDb1v/Oap6M1PcwX9AI6rRqKuvNqfHCR2xhqayxahaSnvnzeqHhrFGClJLG8ouETK0FFQAU6rsd/drPQ80HUS0+ieY8C8+gL81kjp6WUQkpohfVk7M7+3hs6TpuEnNiV4CS7ka1LWg==', 'sat_certificate': None, 'fiscal_folio': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'xml_file_size': 9151, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:58,857 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B49EEC1E-7D05-4096-918C-0969423EB0C6.xml: Failed to save invoice to database
2025-07-18 15:23:59,598 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'details': '{"filename": "B49EEC1E-7D05-4096-918C-0969423EB0C6.xml", "processing_time": 3.4911367893218994, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.4911367893218994, 'memory_usage': None, 'filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 59, 40860)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:23:59,599 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'details': '{"filename": "B49EEC1E-7D05-4096-918C-0969423EB0C6.xml", "processing_time": 3.4911367893218994, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.4911367893218994, 'memory_usage': None, 'filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 23, 59, 40860)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:01,086 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(37) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'details': '{"filename": "B696B7FF-E66C-46CF-A45D-D819C44431A3.xml", "processing_time": 0.7564258575439453, "item_count": 0, "success": false, "error": "DUPLICATE: UUID B696B7FF-E66C-46CF-A45D-D819C44431A3 already exists"}', 'execution_time': 0.7564258575439453, 'memory_usage': None, 'filename': 'B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 0, 533203)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:01,087 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(37) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'details': '{"filename": "B696B7FF-E66C-46CF-A45D-D819C44431A3.xml", "processing_time": 0.7564258575439453, "item_count": 0, "success": false, "error": "DUPLICATE: UUID B696B7FF-E66C-46CF-A45D-D819C44431A3 already exists"}', 'execution_time': 0.7564258575439453, 'memory_usage': None, 'filename': 'B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 0, 533203)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:03,557 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'series': None, 'folio': '52276', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 15, 9), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 3, 1427), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 3, 1430), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('126.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('126.200000'), 'digital_stamp': 'QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[:10]***MASKED***QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[-10:] ... (46 characters truncated) ... 9OBxoARV9UOwuuIluhsdCghci3A7UFkcvmqIrCycRrCoGPXz1DQoL4KrXaV92JJ5zzZ/Y4dhOZNZ2tzv0wZiSzgBghFcRTRPlQR+stheXmdcfoWugctW+LB2OWJd1V2xPX/5f5FxeKhlvSJWaUg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'JE84V/hN1QmEfBvvEoFl3mP7MJSrHQvcvc0dQmikBSIxXdzUVmbV6U3oI0aZrujiqPhMPAdwHaZGFz5XH77/fpdr00SxMmmMUa9AnE9D0PR90IMIUBhGNOEMgm+F9UE7UuKfFZPr2TLE9Ih7sremo ... (46 characters truncated) ... DGa1jGznmkijxCfPeoiBaB63wwjnU6KLVHbeJfZPZD+Zfm/iqPWG6wB3ZIkSvPR1cD+b/xtnjHyCJUlEK+rYWLYOSB31chmADdj27BDzVwlfinZPmFsl3+ft4kyz4lio0g53vhDtrIqhHhi0nuA==', 'sat_certificate': None, 'fiscal_folio': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 15, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'xml_file_size': 6101, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:03,559 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'series': None, 'folio': '52276', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 15, 9), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 3, 1427), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 3, 1430), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('126.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('126.200000'), 'digital_stamp': 'QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[:10]***MASKED***QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[-10:] ... (46 characters truncated) ... 9OBxoARV9UOwuuIluhsdCghci3A7UFkcvmqIrCycRrCoGPXz1DQoL4KrXaV92JJ5zzZ/Y4dhOZNZ2tzv0wZiSzgBghFcRTRPlQR+stheXmdcfoWugctW+LB2OWJd1V2xPX/5f5FxeKhlvSJWaUg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'JE84V/hN1QmEfBvvEoFl3mP7MJSrHQvcvc0dQmikBSIxXdzUVmbV6U3oI0aZrujiqPhMPAdwHaZGFz5XH77/fpdr00SxMmmMUa9AnE9D0PR90IMIUBhGNOEMgm+F9UE7UuKfFZPr2TLE9Ih7sremo ... (46 characters truncated) ... DGa1jGznmkijxCfPeoiBaB63wwjnU6KLVHbeJfZPZD+Zfm/iqPWG6wB3ZIkSvPR1cD+b/xtnjHyCJUlEK+rYWLYOSB31chmADdj27BDzVwlfinZPmFsl3+ft4kyz4lio0g53vhDtrIqhHhi0nuA==', 'sat_certificate': None, 'fiscal_folio': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 15, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'xml_file_size': 6101, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:03,561 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml: Failed to save invoice to database
2025-07-18 15:24:04,292 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(38) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'details': '{"filename": "B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml", "processing_time": 2.471191167831421, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.471191167831421, 'memory_usage': None, 'filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 3, 733888)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:04,293 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(38) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'details': '{"filename": "B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml", "processing_time": 2.471191167831421, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.471191167831421, 'memory_usage': None, 'filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 3, 733888)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:10,865 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'series': None, 'folio': '52015', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 0, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 10, 306707), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 10, 306710), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('358.330000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('7.170000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('365.500000'), 'digital_stamp': 'Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[:10]***MASKED***Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[-10:] ... (46 characters truncated) ... 74s62OKvM5FdxLfo13KQ2o5rny+5aE6UI2oAOM7txqfOIzcg5BKuRjdtfbwEgzvsOdR2DIeUATeL/ZJ6jhnQQLGmwme5tklegIBDKGiUUVHEbqn04z/r9iom8MxEAIaBVT4MqViTAxZoV3wQ0yg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'MmVxeJlWCNV91IBkiq5F8WWcEMW42NI8mIJ2gvfiBaj17zSB+aJXT74sSsC7pKTW9LwNSfhOyxpHLik94ZGcp3SKP4YyikLGkhMaEY9vBE0pr2DiCGcAYK1x61ANLb5SFI5D6Ggr/6V393NW3/KXT ... (46 characters truncated) ... Oi4eTmd+q91gvVTh7Z1IMuZzrOina/dG0o/EnHJCsxswOk2sVUFCWS03oVM5wZzct9jZvNrzim5Co1tlHlJbDOQc/YVj9GJWnXa3J5v0bjdiiOBzaxXeYXuFDsqJH8KX8KhzdfRwvWFHKnLCFYQ==', 'sat_certificate': None, 'fiscal_folio': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 0, 6), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'xml_file_size': 7351, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:10,867 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'series': None, 'folio': '52015', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 0, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 10, 306707), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 10, 306710), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('358.330000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('7.170000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('365.500000'), 'digital_stamp': 'Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[:10]***MASKED***Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[-10:] ... (46 characters truncated) ... 74s62OKvM5FdxLfo13KQ2o5rny+5aE6UI2oAOM7txqfOIzcg5BKuRjdtfbwEgzvsOdR2DIeUATeL/ZJ6jhnQQLGmwme5tklegIBDKGiUUVHEbqn04z/r9iom8MxEAIaBVT4MqViTAxZoV3wQ0yg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'MmVxeJlWCNV91IBkiq5F8WWcEMW42NI8mIJ2gvfiBaj17zSB+aJXT74sSsC7pKTW9LwNSfhOyxpHLik94ZGcp3SKP4YyikLGkhMaEY9vBE0pr2DiCGcAYK1x61ANLb5SFI5D6Ggr/6V393NW3/KXT ... (46 characters truncated) ... Oi4eTmd+q91gvVTh7Z1IMuZzrOina/dG0o/EnHJCsxswOk2sVUFCWS03oVM5wZzct9jZvNrzim5Co1tlHlJbDOQc/YVj9GJWnXa3J5v0bjdiiOBzaxXeYXuFDsqJH8KX8KhzdfRwvWFHKnLCFYQ==', 'sat_certificate': None, 'fiscal_folio': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 0, 6), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'xml_file_size': 7351, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:10,869 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B8A1090C-497D-43EE-B109-CC42BF5CC627.xml: Failed to save invoice to database
2025-07-18 15:24:11,641 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(39) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'details': '{"filename": "B8A1090C-497D-43EE-B109-CC42BF5CC627.xml", "processing_time": 6.573448896408081, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.573448896408081, 'memory_usage': None, 'filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 11, 49571)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:11,642 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(39) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'details': '{"filename": "B8A1090C-497D-43EE-B109-CC42BF5CC627.xml", "processing_time": 6.573448896408081, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.573448896408081, 'memory_usage': None, 'filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 11, 49571)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:14,441 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'series': None, 'folio': '52121', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 6, 57), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 13, 879502), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 13, 879506), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('233.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('233.500000'), 'digital_stamp': 'GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[:10]***MASKED***GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[-10:] ... (46 characters truncated) ... NWauWmeETJKBI9Rww6O4b7iIvrMOPD1nR59TIqKPdGU3rpPUBspyius8on+KwzZyWliF4qp8Ef3RC+CYGJc2HeLAB/kCoJz7IW4vwYCSDcsWPcjjGeVLJDs7qMJ3Lyx2HuUTtdtPSSIl9XvzCNg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mFfQWP5GPGORG3IIxE9ChCUSA8PJ7PXmpkc5JIb0o/SeEd1PTfEzpT3nKo4se2v02U8t5/0oSloabruEJeUaMA6KVbxbqmDosZlXGaCQ8GY+Xk6aTpOEM60PaYXx/UyHZXFTb0J37BLnjM8TL0+W2 ... (46 characters truncated) ... O5By9F0ffS+eIhg7Cxb/TZiZMxTUmU5TiI2svqRFP19pKAz2PWWROFiiTB71j0yVZcm5Pz9Q8G26RigByU2lsGkd44LEFQwSxwU28NVgimmIZBOvj6VwyL9RIS+Aa4hPrUyispTiNthHoUfXYtg==', 'sat_certificate': None, 'fiscal_folio': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 6, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'xml_file_size': 5357, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:14,444 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'series': None, 'folio': '52121', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 6, 57), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 13, 879502), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 13, 879506), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('233.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('233.500000'), 'digital_stamp': 'GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[:10]***MASKED***GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[-10:] ... (46 characters truncated) ... NWauWmeETJKBI9Rww6O4b7iIvrMOPD1nR59TIqKPdGU3rpPUBspyius8on+KwzZyWliF4qp8Ef3RC+CYGJc2HeLAB/kCoJz7IW4vwYCSDcsWPcjjGeVLJDs7qMJ3Lyx2HuUTtdtPSSIl9XvzCNg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mFfQWP5GPGORG3IIxE9ChCUSA8PJ7PXmpkc5JIb0o/SeEd1PTfEzpT3nKo4se2v02U8t5/0oSloabruEJeUaMA6KVbxbqmDosZlXGaCQ8GY+Xk6aTpOEM60PaYXx/UyHZXFTb0J37BLnjM8TL0+W2 ... (46 characters truncated) ... O5By9F0ffS+eIhg7Cxb/TZiZMxTUmU5TiI2svqRFP19pKAz2PWWROFiiTB71j0yVZcm5Pz9Q8G26RigByU2lsGkd44LEFQwSxwU28NVgimmIZBOvj6VwyL9RIS+Aa4hPrUyispTiNthHoUfXYtg==', 'sat_certificate': None, 'fiscal_folio': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 6, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'xml_file_size': 5357, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:14,445 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml: Failed to save invoice to database
2025-07-18 15:24:15,207 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(40) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'details': '{"filename": "B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml", "processing_time": 2.8017566204071045, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.8017566204071045, 'memory_usage': None, 'filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 14, 631753)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:15,208 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(40) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'details': '{"filename": "B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml", "processing_time": 2.8017566204071045, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.8017566204071045, 'memory_usage': None, 'filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 14, 631753)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:18,851 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'series': None, 'folio': '52222', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 34, 11), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 18, 307994), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 18, 307998), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('206.900000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('33.100000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('240.000000'), 'digital_stamp': 'coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[:10]***MASKED***coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[-10:] ... (46 characters truncated) ... OXcfwHyoA9Bx99yeoIu7v9I/7DjZL9o/wJKjuMKQ6rFUK3zbehC5zTX4MfGWG/3+HKwMPC2B/gM1iBVmRw5NuuAPCkw8T5iE4+7PKcFzneLzUPn5hm+d6owe6EpG0BRyzAuqFqGN59Kq1ZJXKwg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'XvFKCYfPYPoGkwKTAYa2L+lvQQuQ0TueGBZRz6gCBY3ZFFfJQSIXpAm5tXUU/v7GPgWIFBaw/iCYH/lLnI2Pb6aE5ZGYOdrUH9mZPzIOfpnu8jcHNB7Ym/OKF8GvZkoW8PW3togWnsFsLeLnRAeEq ... (46 characters truncated) ... AcBxVlutJhP7YXN0HepTCsT+CUWVklPI4FkIP7u6GpB8LTRSkyo+lbsn4Abt9fs30h/WOu8t3emZnLaqnHMIpMy/9Oga8wPnFUOsfn+zG1Jq+t/ReoecvVkBM2msXBLCgUMaXIsSj5eaGKBhS1A==', 'sat_certificate': None, 'fiscal_folio': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 34, 12), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'xml_file_size': 5388, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:18,852 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'series': None, 'folio': '52222', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 34, 11), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 18, 307994), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 18, 307998), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('206.900000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('33.100000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('240.000000'), 'digital_stamp': 'coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[:10]***MASKED***coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[-10:] ... (46 characters truncated) ... OXcfwHyoA9Bx99yeoIu7v9I/7DjZL9o/wJKjuMKQ6rFUK3zbehC5zTX4MfGWG/3+HKwMPC2B/gM1iBVmRw5NuuAPCkw8T5iE4+7PKcFzneLzUPn5hm+d6owe6EpG0BRyzAuqFqGN59Kq1ZJXKwg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'XvFKCYfPYPoGkwKTAYa2L+lvQQuQ0TueGBZRz6gCBY3ZFFfJQSIXpAm5tXUU/v7GPgWIFBaw/iCYH/lLnI2Pb6aE5ZGYOdrUH9mZPzIOfpnu8jcHNB7Ym/OKF8GvZkoW8PW3togWnsFsLeLnRAeEq ... (46 characters truncated) ... AcBxVlutJhP7YXN0HepTCsT+CUWVklPI4FkIP7u6GpB8LTRSkyo+lbsn4Abt9fs30h/WOu8t3emZnLaqnHMIpMy/9Oga8wPnFUOsfn+zG1Jq+t/ReoecvVkBM2msXBLCgUMaXIsSj5eaGKBhS1A==', 'sat_certificate': None, 'fiscal_folio': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 34, 12), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'xml_file_size': 5388, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:18,854 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml: Failed to save invoice to database
2025-07-18 15:24:19,581 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(41) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'details': '{"filename": "CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml", "processing_time": 3.644198179244995, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.644198179244995, 'memory_usage': None, 'filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 19, 32887)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:19,583 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(41) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'details': '{"filename": "CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml", "processing_time": 3.644198179244995, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.644198179244995, 'memory_usage': None, 'filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 19, 32887)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:22,028 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'series': None, 'folio': '52274', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 9, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 21, 470537), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 21, 470542), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('373.910000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('43.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('416.940000'), 'digital_stamp': 'FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[:10]***MASKED***FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[-10:] ... (46 characters truncated) ... XkhBMP9K3UR36Y4axrhInWrwAAniQiJ018E+D8W99SyQEYEKBF4ur/69wkf+8NZc+epgpmCWoeUnH1RHAm08kzb+jjGzflqBqc9x0p906gZo3UJPOSnVPCRPMK9oWwOd95a7swYdT6T8rdXFKtw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'VhvI5rMMsVGoKz5l2rkOkPM7YjA5jqlHGyDDVU0kq0UQ1A5V2tZjLfbJdG/ovNHLJ0WjSWcuz7/GAHFiVvTqWLVBq2CACMOiRkWbNIINs0PoKBWNCU27XeBo3tavxSt+fJY0cox11Sttm3h0sg6yy ... (46 characters truncated) ... mA3cU/SsCsLLzsxn2XNFwzFd7PzSc8NfvntxhRBNzUiKwJkjsm4oIPFwawHqPiiRhtz+LrXZqk3e5ZTFRr5ZzLag+YOJBqjV5690Q7n8xBqgiaTB/yHia/KxxMN5gcZXUHG8A/pPbi9xbrdkxXw==', 'sat_certificate': None, 'fiscal_folio': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 9, 5), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'xml_file_size': 5865, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:22,030 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'series': None, 'folio': '52274', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 9, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 21, 470537), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 21, 470542), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('373.910000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('43.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('416.940000'), 'digital_stamp': 'FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[:10]***MASKED***FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[-10:] ... (46 characters truncated) ... XkhBMP9K3UR36Y4axrhInWrwAAniQiJ018E+D8W99SyQEYEKBF4ur/69wkf+8NZc+epgpmCWoeUnH1RHAm08kzb+jjGzflqBqc9x0p906gZo3UJPOSnVPCRPMK9oWwOd95a7swYdT6T8rdXFKtw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'VhvI5rMMsVGoKz5l2rkOkPM7YjA5jqlHGyDDVU0kq0UQ1A5V2tZjLfbJdG/ovNHLJ0WjSWcuz7/GAHFiVvTqWLVBq2CACMOiRkWbNIINs0PoKBWNCU27XeBo3tavxSt+fJY0cox11Sttm3h0sg6yy ... (46 characters truncated) ... mA3cU/SsCsLLzsxn2XNFwzFd7PzSc8NfvntxhRBNzUiKwJkjsm4oIPFwawHqPiiRhtz+LrXZqk3e5ZTFRr5ZzLag+YOJBqjV5690Q7n8xBqgiaTB/yHia/KxxMN5gcZXUHG8A/pPbi9xbrdkxXw==', 'sat_certificate': None, 'fiscal_folio': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 9, 5), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'xml_file_size': 5865, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:22,031 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml: Failed to save invoice to database
2025-07-18 15:24:22,775 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(42) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'details': '{"filename": "D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml", "processing_time": 2.446859836578369, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.446859836578369, 'memory_usage': None, 'filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 22, 211971)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:22,776 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(42) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'details': '{"filename": "D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml", "processing_time": 2.446859836578369, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.446859836578369, 'memory_usage': None, 'filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 22, 211971)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:24,294 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'series': None, 'folio': '52011', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 40, 27), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 23, 697608), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 23, 697611), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('56.030000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('8.970000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('65.000000'), 'digital_stamp': 'LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[:10]***MASKED***LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[-10:] ... (46 characters truncated) ... 7CrY7Z9evQJzG4akjJauZ3VzbmZPtkIKauIeFASc2E8h1n1sAiqMbQG68hf0nRXBoEJvGu5Xti4sFtPSPcNYsjiSVU2hfuZxB88SABJptjjbzVRIu9NEapBx0Gk4gaWDSONzRSoKzdzRcgqSd/w==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mV2Xg7fAyiaeC/aI1hMvhnooib4tYHQVMuGQNwt6wLHjrQcfKoH8l/qXcly2j3QrpLe/fnRH9uUm4ZWgYex05lAC51KQnacN+hplGL2d2YGHWN235AIB6bWRJgyJigiNKGgdwTO6vDE7wWpQhg0ok ... (46 characters truncated) ... QXg/nr1vzXInuYePwwU1OMn+hMS9oFcBmfK8vkJqPIL1+liM7vVoAJcTs9x58I9acn42wTV8vjFxLRYr6GRzYqXiBYHzrfV0jaGZReEaE6cyoRgo/LzcBttV/fdpgXPMoFZjHeewwanHT13CHfA==', 'sat_certificate': None, 'fiscal_folio': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 40, 28), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'xml_file_size': 4999, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:24,296 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'series': None, 'folio': '52011', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 40, 27), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 23, 697608), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 23, 697611), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('56.030000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('8.970000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('65.000000'), 'digital_stamp': 'LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[:10]***MASKED***LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[-10:] ... (46 characters truncated) ... 7CrY7Z9evQJzG4akjJauZ3VzbmZPtkIKauIeFASc2E8h1n1sAiqMbQG68hf0nRXBoEJvGu5Xti4sFtPSPcNYsjiSVU2hfuZxB88SABJptjjbzVRIu9NEapBx0Gk4gaWDSONzRSoKzdzRcgqSd/w==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mV2Xg7fAyiaeC/aI1hMvhnooib4tYHQVMuGQNwt6wLHjrQcfKoH8l/qXcly2j3QrpLe/fnRH9uUm4ZWgYex05lAC51KQnacN+hplGL2d2YGHWN235AIB6bWRJgyJigiNKGgdwTO6vDE7wWpQhg0ok ... (46 characters truncated) ... QXg/nr1vzXInuYePwwU1OMn+hMS9oFcBmfK8vkJqPIL1+liM7vVoAJcTs9x58I9acn42wTV8vjFxLRYr6GRzYqXiBYHzrfV0jaGZReEaE6cyoRgo/LzcBttV/fdpgXPMoFZjHeewwanHT13CHfA==', 'sat_certificate': None, 'fiscal_folio': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 40, 28), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'xml_file_size': 4999, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:24,298 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml: Failed to save invoice to database
2025-07-18 15:24:25,047 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(43) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'details': '{"filename": "DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml", "processing_time": 1.519850730895996, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.519850730895996, 'memory_usage': None, 'filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 24, 477402)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:25,048 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(43) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'details': '{"filename": "DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml", "processing_time": 1.519850730895996, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.519850730895996, 'memory_usage': None, 'filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 24, 477402)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:26,559 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(44) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'details': '{"filename": "DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml", "processing_time": 0.7555797100067139, "item_count": 0, "success": false, "error": "DUPLICATE: UUID DC82A272-2FA8-4F2F-A807-6B6F55BDF18E already exists"}', 'execution_time': 0.7555797100067139, 'memory_usage': None, 'filename': 'DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 25, 992915)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:26,560 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(44) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'details': '{"filename": "DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml", "processing_time": 0.7555797100067139, "item_count": 0, "success": false, "error": "DUPLICATE: UUID DC82A272-2FA8-4F2F-A807-6B6F55BDF18E already exists"}', 'execution_time': 0.7555797100067139, 'memory_usage': None, 'filename': 'DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 25, 992915)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:28,090 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(45) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'details': '{"filename": "E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml", "processing_time": 0.8080518245697021, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E11056BF-CB35-41B5-AF5B-CFB0E089A32E already exists"}', 'execution_time': 0.8080518245697021, 'memory_usage': None, 'filename': 'E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 27, 546009)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:28,091 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(45) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'details': '{"filename": "E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml", "processing_time": 0.8080518245697021, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E11056BF-CB35-41B5-AF5B-CFB0E089A32E already exists"}', 'execution_time': 0.8080518245697021, 'memory_usage': None, 'filename': 'E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 27, 546009)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:29,592 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(46) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'details': '{"filename": "E507A17F-A130-4C08-8B4F-0FD300D02C85.xml", "processing_time": 0.7620401382446289, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E507A17F-A130-4C08-8B4F-0FD300D02C85 already exists"}', 'execution_time': 0.7620401382446289, 'memory_usage': None, 'filename': 'E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 29, 39520)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:29,593 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(46) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'details': '{"filename": "E507A17F-A130-4C08-8B4F-0FD300D02C85.xml", "processing_time": 0.7620401382446289, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E507A17F-A130-4C08-8B4F-0FD300D02C85 already exists"}', 'execution_time': 0.7620401382446289, 'memory_usage': None, 'filename': 'E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 29, 39520)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:31,067 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'series': None, 'folio': '52046', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 50, 14), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 30, 514746), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 30, 514750), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('12.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('12.500000'), 'digital_stamp': 'KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[:10]***MASKED***KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[-10:] ... (46 characters truncated) ... 4Dg6qzEMnuK/pqn6tsPdozJISu5bw0uXmJSMRQeWSYgjHbhooM/1r9as4EWgoUnoDplHDyJ+VP2mQc4ysk1YeJ8pH9Ap3YU+Hu/a7EwixU3/U4CgydP+Sc2vN5PZguivg2oIWy/Xok9tYa75XFA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mg1aXY/P9K8mDKOyxwlJ3Zrafn63Nwz1M45/LiAb3GjmDXbY1gaTSMDvVgnThauLS9x9yPmQkYP8E+RbojEVUuQHsl7D94Rb8O055szwW5OwWreLn45EYmg8fL/DBRdNrlY2IcFkmLYMg73HfmA2p ... (46 characters truncated) ... 0YRle7Rl3VlLaKv/8qYr3uz8S5z3cnDWYBoFvVHjnftAS1fdSzCCgu39RqKKnYTiMl6xBaKXmZGGs1c9w0NhSi0xVm/UHrjZIChq15xUkJH/xQohFrENKMwDebpWtMSYZ0CtiQn1bgj/+dU9A2A==', 'sat_certificate': None, 'fiscal_folio': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 50, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'xml_file_size': 4976, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:31,069 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'series': None, 'folio': '52046', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 50, 14), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 30, 514746), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 30, 514750), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('12.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('12.500000'), 'digital_stamp': 'KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[:10]***MASKED***KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[-10:] ... (46 characters truncated) ... 4Dg6qzEMnuK/pqn6tsPdozJISu5bw0uXmJSMRQeWSYgjHbhooM/1r9as4EWgoUnoDplHDyJ+VP2mQc4ysk1YeJ8pH9Ap3YU+Hu/a7EwixU3/U4CgydP+Sc2vN5PZguivg2oIWy/Xok9tYa75XFA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mg1aXY/P9K8mDKOyxwlJ3Zrafn63Nwz1M45/LiAb3GjmDXbY1gaTSMDvVgnThauLS9x9yPmQkYP8E+RbojEVUuQHsl7D94Rb8O055szwW5OwWreLn45EYmg8fL/DBRdNrlY2IcFkmLYMg73HfmA2p ... (46 characters truncated) ... 0YRle7Rl3VlLaKv/8qYr3uz8S5z3cnDWYBoFvVHjnftAS1fdSzCCgu39RqKKnYTiMl6xBaKXmZGGs1c9w0NhSi0xVm/UHrjZIChq15xUkJH/xQohFrENKMwDebpWtMSYZ0CtiQn1bgj/+dU9A2A==', 'sat_certificate': None, 'fiscal_folio': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 50, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'xml_file_size': 4976, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:31,070 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml: Failed to save invoice to database
2025-07-18 15:24:31,808 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(47) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'details': '{"filename": "E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml", "processing_time": 1.474799394607544, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.474799394607544, 'memory_usage': None, 'filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 31, 254190)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:31,809 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(47) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'details': '{"filename": "E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml", "processing_time": 1.474799394607544, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.474799394607544, 'memory_usage': None, 'filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 31, 254190)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:33,291 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(48) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'details': '{"filename": "FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml", "processing_time": 0.7446870803833008, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FBDD0E56-11A1-49B9-95C2-FD243E95986B already exists"}', 'execution_time': 0.7446870803833008, 'memory_usage': None, 'filename': 'FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 32, 732832)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:33,293 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(48) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'details': '{"filename": "FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml", "processing_time": 0.7446870803833008, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FBDD0E56-11A1-49B9-95C2-FD243E95986B already exists"}', 'execution_time': 0.7446870803833008, 'memory_usage': None, 'filename': 'FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 32, 732832)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:34,797 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(49) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'details': '{"filename": "FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml", "processing_time": 0.7704191207885742, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FDE6B84B-D0D2-481D-9F46-749D780FFFEE already exists"}', 'execution_time': 0.7704191207885742, 'memory_usage': None, 'filename': 'FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 34, 245950)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:34,798 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(49) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'details': '{"filename": "FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml", "processing_time": 0.7704191207885742, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FDE6B84B-D0D2-481D-9F46-749D780FFFEE already exists"}', 'execution_time': 0.7704191207885742, 'memory_usage': None, 'filename': 'FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 34, 245950)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:41,836 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'series': None, 'folio': '52122', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 9, 23), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 41, 291775), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 41, 291778), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1740.240000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1740.240000'), 'digital_stamp': 'MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[:10]***MASKED***MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[-10:] ... (46 characters truncated) ... 5st48gWkrO/xnnIPLIpHiOppaDGikcfg7N+IasEFWP7/eB0wsLQuSmxpkSLVVzNu6kXkjdIOWJCHeGyUB4bvELD6+9U/CCaEbKzJ8u9SpoYZrSiqmRrkvt8ruImiWyB/F/jD/5ftv/jeBlGysaA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'RsFcCK9pbDCK5rAjnEkBgBAbXGWnP/+6LfLgsX9XDdM+4YshuPvO/OTs5EVyG1hOwPrb9duvfUkHm2Lqpnkp2NarPq4wtQKutbLwYhmH55qWE+334Jvr8Icd9TKIvn7F/gMqbtBcdSWfrUeX8/tsY ... (46 characters truncated) ... CdK+85IUChGYBO861Tz4YRTtjZr73FmJSSkC40e8HJOkpdMtwx4+E9Tx+GcZuvY40xEaK2grpnphEib5Kh9PQAHIjTMmISjtsaJdfIT6nl3mAqnmzcOWns147RHJVw9rdu6OCQZzLHVjaChrAGw==', 'sat_certificate': None, 'fiscal_folio': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 9, 24), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'xml_file_size': 12542, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:41,838 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'series': None, 'folio': '52122', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 9, 23), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 41, 291775), 'updated_at': datetime.datetime(2025, 7, 18, 22, 24, 41, 291778), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1740.240000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1740.240000'), 'digital_stamp': 'MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[:10]***MASKED***MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[-10:] ... (46 characters truncated) ... 5st48gWkrO/xnnIPLIpHiOppaDGikcfg7N+IasEFWP7/eB0wsLQuSmxpkSLVVzNu6kXkjdIOWJCHeGyUB4bvELD6+9U/CCaEbKzJ8u9SpoYZrSiqmRrkvt8ruImiWyB/F/jD/5ftv/jeBlGysaA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'RsFcCK9pbDCK5rAjnEkBgBAbXGWnP/+6LfLgsX9XDdM+4YshuPvO/OTs5EVyG1hOwPrb9duvfUkHm2Lqpnkp2NarPq4wtQKutbLwYhmH55qWE+334Jvr8Icd9TKIvn7F/gMqbtBcdSWfrUeX8/tsY ... (46 characters truncated) ... CdK+85IUChGYBO861Tz4YRTtjZr73FmJSSkC40e8HJOkpdMtwx4+E9Tx+GcZuvY40xEaK2grpnphEib5Kh9PQAHIjTMmISjtsaJdfIT6nl3mAqnmzcOWns147RHJVw9rdu6OCQZzLHVjaChrAGw==', 'sat_certificate': None, 'fiscal_folio': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 9, 24), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'xml_file_size': 12542, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:41,839 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml: Failed to save invoice to database
2025-07-18 15:24:42,619 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(50) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'details': '{"filename": "FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml", "processing_time": 7.038869619369507, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.038869619369507, 'memory_usage': None, 'filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 42, 18221)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:42,620 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(50) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'details': '{"filename": "FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml", "processing_time": 7.038869619369507, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.038869619369507, 'memory_usage': None, 'filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 42, 18221)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:44,072 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(51) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'details': '{"filename": "db7ca908-83b2-49ab-8c86-649a9b9ba470.xml", "processing_time": 0.73099684715271, "item_count": 0, "success": false, "error": "DUPLICATE: UUID db7ca908-83b2-49ab-8c86-649a9b9ba470 already exists"}', 'execution_time': 0.73099684715271, 'memory_usage': None, 'filename': 'db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 43, 526710)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-18 15:24:44,073 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(51) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'details': '{"filename": "db7ca908-83b2-49ab-8c86-649a9b9ba470.xml", "processing_time": 0.73099684715271, "item_count": 0, "success": false, "error": "DUPLICATE: UUID db7ca908-83b2-49ab-8c86-649a9b9ba470 already exists"}', 'execution_time': 0.73099684715271, 'memory_usage': None, 'filename': 'db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 18, 22, 24, 43, 526710)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:44,044 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'details': '{"filename": "04061ab5-c50d-46f3-aba1-148bdc5c2333.xml", "processing_time": 3.865370750427246, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 04061ab5-c50d-46f3-aba1-148bdc5c2333 already exists"}', 'execution_time': 3.865370750427246, 'memory_usage': None, 'filename': '04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 43, 423317)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:44,044 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'details': '{"filename": "04061ab5-c50d-46f3-aba1-148bdc5c2333.xml", "processing_time": 3.865370750427246, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 04061ab5-c50d-46f3-aba1-148bdc5c2333 already exists"}', 'execution_time': 3.865370750427246, 'memory_usage': None, 'filename': '04061ab5-c50d-46f3-aba1-148bdc5c2333.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 43, 423317)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:45,798 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'details': '{"filename": "0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml", "processing_time": 0.8581581115722656, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 0781DA3A-D65A-4B8C-827C-104B8D3F52F8 already exists"}', 'execution_time': 0.8581581115722656, 'memory_usage': None, 'filename': '0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 45, 114598)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:45,800 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'details': '{"filename": "0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml", "processing_time": 0.8581581115722656, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 0781DA3A-D65A-4B8C-827C-104B8D3F52F8 already exists"}', 'execution_time': 0.8581581115722656, 'memory_usage': None, 'filename': '0781DA3A-D65A-4B8C-827C-104B8D3F52F8.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 45, 114598)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:54,584 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'series': None, 'folio': '52221', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 53), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 53, 916428), 'updated_at': datetime.datetime(2025, 7, 19, 21, 43, 53, 916431), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('724.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('724.000000'), 'digital_stamp': 'gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[:10]***MASKED***gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[-10:] ... (46 characters truncated) ... JYLPQdJSeXpKETRpGHVMyykXTYgEm6dUJMj6tSAnbERaeRS1Hhaq8zpK10/2HC3sgLSTLR3jfQgcQ9hPd8OBHLUwMDn6hAFuV2pXbfpu4d6PS/WcR/zSsNndBEruKcUFqXjr7M5izdxVycWoA5g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZLPyGoiFgRZmiGRStJ32HDEOSrGYDVBJJOBpqjLIaOi02K74T14XQ885lnGE4cOLn9phVwtgGtHHd0u2mi2n3xjaxSPN0B6L683ctc7CU7w12u1bDGxzo3Fp+2Drpx8OXvyb3xMngp27XBlCTWF3H ... (46 characters truncated) ... BjITV4l5CyNhstxNVYCJVFm/0XntgTaQtFbN5ZtHVBNsLcBctbmXxbyzSYVqVDlCtuNMCyUewEpX8PPR+abAf7EA5u92C/k+GBL4vpKa8WCE845IXNnSRqi5X4/1s03v3WJmFu4jozojHDmG0tA==', 'sat_certificate': None, 'fiscal_folio': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 54), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'xml_file_size': 6129, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:54,586 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(1) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'series': None, 'folio': '52221', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 53), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 53, 916428), 'updated_at': datetime.datetime(2025, 7, 19, 21, 43, 53, 916431), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('724.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('724.000000'), 'digital_stamp': 'gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[:10]***MASKED***gZa2eEJDkGJsU6SnxfKb1BEJ20AeX90+wtBQmm2v33ipb7ZN1LCR12ULHcuqyDP8cEy6sitGx82FWuwt/4inm+SOZ2E10LlRYhJKFmKeRmsxAtpjL4HZ4MPw2ynRMOoOl2lDiWE9sNgOLniHGjsnP[-10:] ... (46 characters truncated) ... JYLPQdJSeXpKETRpGHVMyykXTYgEm6dUJMj6tSAnbERaeRS1Hhaq8zpK10/2HC3sgLSTLR3jfQgcQ9hPd8OBHLUwMDn6hAFuV2pXbfpu4d6PS/WcR/zSsNndBEruKcUFqXjr7M5izdxVycWoA5g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZLPyGoiFgRZmiGRStJ32HDEOSrGYDVBJJOBpqjLIaOi02K74T14XQ885lnGE4cOLn9phVwtgGtHHd0u2mi2n3xjaxSPN0B6L683ctc7CU7w12u1bDGxzo3Fp+2Drpx8OXvyb3xMngp27XBlCTWF3H ... (46 characters truncated) ... BjITV4l5CyNhstxNVYCJVFm/0XntgTaQtFbN5ZtHVBNsLcBctbmXxbyzSYVqVDlCtuNMCyUewEpX8PPR+abAf7EA5u92C/k+GBL4vpKa8WCE845IXNnSRqi5X4/1s03v3WJmFu4jozojHDmG0tA==', 'sat_certificate': None, 'fiscal_folio': '09627427-807D-48B0-A15C-DD43CB94F1FC', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 54), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'xml_file_size': 6129, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:54,587 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 09627427-807D-48B0-A15C-DD43CB94F1FC.xml: Failed to save invoice to database
2025-07-19 14:43:55,410 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'details': '{"filename": "09627427-807D-48B0-A15C-DD43CB94F1FC.xml", "processing_time": 8.785087585449219, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 8.785087585449219, 'memory_usage': None, 'filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 54, 794475)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:55,411 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'details': '{"filename": "09627427-807D-48B0-A15C-DD43CB94F1FC.xml", "processing_time": 8.785087585449219, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 8.785087585449219, 'memory_usage': None, 'filename': '09627427-807D-48B0-A15C-DD43CB94F1FC.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 54, 794475)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:57,118 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'details': '{"filename": "109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml", "processing_time": 0.8283345699310303, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 109BCCAF-DC6E-4C71-B0B4-468D3D894E02 already exists"}', 'execution_time': 0.8283345699310303, 'memory_usage': None, 'filename': '109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 56, 440069)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:57,119 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'details': '{"filename": "109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml", "processing_time": 0.8283345699310303, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 109BCCAF-DC6E-4C71-B0B4-468D3D894E02 already exists"}', 'execution_time': 0.8283345699310303, 'memory_usage': None, 'filename': '109BCCAF-DC6E-4C71-B0B4-468D3D894E02.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 56, 440069)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:59,930 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'series': None, 'folio': '52010', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 32, 41), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 59, 212026), 'updated_at': datetime.datetime(2025, 7, 19, 21, 43, 59, 212030), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('77.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('77.000000'), 'digital_stamp': 'Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[:10]***MASKED***Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[-10:] ... (46 characters truncated) ... Yz+Lt1zvd9nMmtXq4OpOEkS+n0XbRpzg1TbFxlR8Xi5xNuw3SKDLcHk723JS/A/CTh9vrk/nKfyQakFlZu0vVeW/qwbU7woMIJB1UHftDKafuVNcOpxJi6+FFP9+XR8RsPPmybbxF8l9VV/tyzw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mCu5XSPDBNOoek+ZOA150LoylOdJ+osEeL1esq/KgIPS5+02pxuU/54eauQ/CHqOj4GEKI9DysriwF4o4rY8pwTtT/Q1PcEENX7SIN2iizxbAH+TMuiqaxJ202AfzjSKQLp4GOY/6C5IIVEoJGylp ... (46 characters truncated) ... 7vc5X/PWRtXxSkJe59bF+j22tG/ocA/peR4asfJDf6WjF7VHP4Ytmam+uaAJ28Wj2Rf2Em6I1nLtgPtxeKvQhRZpIjVC17CuR7qC/S1fzFWGlkRBXjt0o7HdO+VoHmItjN1MkphQyGP357SmELQ==', 'sat_certificate': None, 'fiscal_folio': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 32, 42), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'xml_file_size': 5355, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:59,932 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(2) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'series': None, 'folio': '52010', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 32, 41), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 43, 59, 212026), 'updated_at': datetime.datetime(2025, 7, 19, 21, 43, 59, 212030), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('77.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('77.000000'), 'digital_stamp': 'Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[:10]***MASKED***Qhs6thN3QcgNbwtvElioMu1Xw84tA9HmUgVsV0fmXLnSQssGiIY/Bo4+XnhMGcO18ifkpA/4elXK4LdnGZrFbuOxFqIbZJSjkPbRW9UH5/ROfENtuUtQq2vzvEmkXxtkYBkeDI9Cqk4S8AimiGtwh[-10:] ... (46 characters truncated) ... Yz+Lt1zvd9nMmtXq4OpOEkS+n0XbRpzg1TbFxlR8Xi5xNuw3SKDLcHk723JS/A/CTh9vrk/nKfyQakFlZu0vVeW/qwbU7woMIJB1UHftDKafuVNcOpxJi6+FFP9+XR8RsPPmybbxF8l9VV/tyzw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mCu5XSPDBNOoek+ZOA150LoylOdJ+osEeL1esq/KgIPS5+02pxuU/54eauQ/CHqOj4GEKI9DysriwF4o4rY8pwTtT/Q1PcEENX7SIN2iizxbAH+TMuiqaxJ202AfzjSKQLp4GOY/6C5IIVEoJGylp ... (46 characters truncated) ... 7vc5X/PWRtXxSkJe59bF+j22tG/ocA/peR4asfJDf6WjF7VHP4Ytmam+uaAJ28Wj2Rf2Em6I1nLtgPtxeKvQhRZpIjVC17CuR7qC/S1fzFWGlkRBXjt0o7HdO+VoHmItjN1MkphQyGP357SmELQ==', 'sat_certificate': None, 'fiscal_folio': '138216B8-116F-4B41-A4C0-296EE6B52B1D', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 32, 42), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'xml_file_size': 5355, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:43:59,934 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 138216B8-116F-4B41-A4C0-296EE6B52B1D.xml: Failed to save invoice to database
2025-07-19 14:44:00,831 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'details': '{"filename": "138216B8-116F-4B41-A4C0-296EE6B52B1D.xml", "processing_time": 2.81292462348938, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.81292462348938, 'memory_usage': None, 'filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 0, 147159)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:00,832 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'details': '{"filename": "138216B8-116F-4B41-A4C0-296EE6B52B1D.xml", "processing_time": 2.81292462348938, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.81292462348938, 'memory_usage': None, 'filename': '138216B8-116F-4B41-A4C0-296EE6B52B1D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 0, 147159)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:05,427 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'series': None, 'folio': '52185', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 25), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 4, 767971), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 4, 767973), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1489.320000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1489.320000'), 'digital_stamp': 'R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[:10]***MASKED***R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[-10:] ... (46 characters truncated) ... oppbyOvk8fHHSVqjxDoy+DIKDukU37ztcAXYkTgRdAXqT1Rcr37OP0EtcG8Om4Uw0Uc1DcB6XYcamoEnnszrKxZQKDPpZ1kMt13sX0/PXvQNKICM9GIyv/Vb8ZegLkscBeyFqImTJDoZFRSoGog==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'iPs3rAtLFvrkpxRe1HQb0XGqFsBdeuX4shi9l9e2Op7VKEvjd2b5GT8XsSDnx3MCFnbn0/QMvcfga4RxgZtuZ9Y0hIloxhn58K6jvsk6V1NJdpUZAGC/2o7b+KWeh31TZLrPnO9AXWgNsKy1lwZwV ... (46 characters truncated) ... DtTobBt0LrsAKU6LWfnCpt5N9c1EWNzc05e3xT3bUVxpTo41szvYtk0zJ3qnZKVtWykVOYGyuj+d4RqCFlmmAWvoQMhOOTDxkevntk3u7CVM/0Bw2xXr34jfPuB2pV9UDkPq8zuE0ZGIGjIqYhg==', 'sat_certificate': None, 'fiscal_folio': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 26), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'xml_file_size': 5376, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:05,429 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(3) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'series': None, 'folio': '52185', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 25), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 4, 767971), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 4, 767973), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1489.320000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1489.320000'), 'digital_stamp': 'R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[:10]***MASKED***R5ZwytdLqB56kdcd8qAC6a6X/0sDya5MGn0ZQT73lYWOCcl7k4ZRizVfd4MJeXn6hKu2coFrMYr9yAUn0bo21MLciiw544DxWJZmfHLTjynYlzhaRLtfAIvxNlzDiv1BEPWywSM2TbyQLyU4VWHvu[-10:] ... (46 characters truncated) ... oppbyOvk8fHHSVqjxDoy+DIKDukU37ztcAXYkTgRdAXqT1Rcr37OP0EtcG8Om4Uw0Uc1DcB6XYcamoEnnszrKxZQKDPpZ1kMt13sX0/PXvQNKICM9GIyv/Vb8ZegLkscBeyFqImTJDoZFRSoGog==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'iPs3rAtLFvrkpxRe1HQb0XGqFsBdeuX4shi9l9e2Op7VKEvjd2b5GT8XsSDnx3MCFnbn0/QMvcfga4RxgZtuZ9Y0hIloxhn58K6jvsk6V1NJdpUZAGC/2o7b+KWeh31TZLrPnO9AXWgNsKy1lwZwV ... (46 characters truncated) ... DtTobBt0LrsAKU6LWfnCpt5N9c1EWNzc05e3xT3bUVxpTo41szvYtk0zJ3qnZKVtWykVOYGyuj+d4RqCFlmmAWvoQMhOOTDxkevntk3u7CVM/0Bw2xXr34jfPuB2pV9UDkPq8zuE0ZGIGjIqYhg==', 'sat_certificate': None, 'fiscal_folio': '252AD822-768F-420F-BFF0-DFBECEEB3658', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 26), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'xml_file_size': 5376, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:05,431 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 252AD822-768F-420F-BFF0-DFBECEEB3658.xml: Failed to save invoice to database
2025-07-19 14:44:06,260 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'details': '{"filename": "252AD822-768F-420F-BFF0-DFBECEEB3658.xml", "processing_time": 4.597102642059326, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.597102642059326, 'memory_usage': None, 'filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 5, 621790)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:06,261 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'details': '{"filename": "252AD822-768F-420F-BFF0-DFBECEEB3658.xml", "processing_time": 4.597102642059326, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.597102642059326, 'memory_usage': None, 'filename': '252AD822-768F-420F-BFF0-DFBECEEB3658.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 5, 621790)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:07,993 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'details': '{"filename": "29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml", "processing_time": 0.8730425834655762, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F already exists"}', 'execution_time': 0.8730425834655762, 'memory_usage': None, 'filename': '29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 7, 343637)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:07,994 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'details': '{"filename": "29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml", "processing_time": 0.8730425834655762, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F already exists"}', 'execution_time': 0.8730425834655762, 'memory_usage': None, 'filename': '29E5CB35-0ED4-4048-8BBC-EAB4381BAD9F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 7, 343637)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:10,819 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'series': None, 'folio': '52047', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 11, 13, 8), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 10, 192462), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 10, 192466), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('414.260000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('414.260000'), 'digital_stamp': 'Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[:10]***MASKED***Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[-10:] ... (46 characters truncated) ... y2MnPhimpvnAXKFfTzwml0GtTN0LCTO0VoneF1A/5pK8fbfCKq+Slq1kjVEF7rZQY6lZNhOXt2lS8FvczqoDi8ez9u87/BlLkJzu4QDhvXafMoR6nC7Gn/+4ajvCWf1w6Pb1pKo6UkMo/TO6QLw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CQPuu3j+VkN3Dj7MjAMx0FOKB5VlqE6415C/27WjQBdK049zdrOmJf0paAF7FPXuOiiNO0v7QEc71F0YM9lxYRthoXPsIvtViarP7rggMFWKiyq+0Htsr5YQIcxBDwTBSVKk4yD+TrWvgQio/3Tgn ... (46 characters truncated) ... yR6ZAaUE/QzBtc1OrPqZeIhdIJWk+7fJE4UenQSp22m0uFjiz4KDZQ0XXAjj8g/3MPWnqWXsgbG1n0w/E3y2MPERF01GMOaq3hJHyQr6m4FgqJIJ9fW0aIjwmL2twyly/qmGTZO4e90YiXYyrTQ==', 'sat_certificate': None, 'fiscal_folio': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'stamp_datetime': datetime.datetime(2025, 7, 13, 12, 13, 9), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'xml_file_size': 6122, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:10,821 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(4) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'series': None, 'folio': '52047', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 11, 13, 8), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 10, 192462), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 10, 192466), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('414.260000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('414.260000'), 'digital_stamp': 'Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[:10]***MASKED***Jui51kP6r6IgVvWhf+Wwqc8AXtiL0fF9mobMbzwmlTe9FxOIxGVseSDyPR/RJciW/vHs5zM2L8Xxt7BZYIcTSn0X/C3EXboz+66vMwYiDZl0xxSNIO5TBAwvOQepxECCbrJN6nQMkdtyVLaYfkFUT[-10:] ... (46 characters truncated) ... y2MnPhimpvnAXKFfTzwml0GtTN0LCTO0VoneF1A/5pK8fbfCKq+Slq1kjVEF7rZQY6lZNhOXt2lS8FvczqoDi8ez9u87/BlLkJzu4QDhvXafMoR6nC7Gn/+4ajvCWf1w6Pb1pKo6UkMo/TO6QLw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CQPuu3j+VkN3Dj7MjAMx0FOKB5VlqE6415C/27WjQBdK049zdrOmJf0paAF7FPXuOiiNO0v7QEc71F0YM9lxYRthoXPsIvtViarP7rggMFWKiyq+0Htsr5YQIcxBDwTBSVKk4yD+TrWvgQio/3Tgn ... (46 characters truncated) ... yR6ZAaUE/QzBtc1OrPqZeIhdIJWk+7fJE4UenQSp22m0uFjiz4KDZQ0XXAjj8g/3MPWnqWXsgbG1n0w/E3y2MPERF01GMOaq3hJHyQr6m4FgqJIJ9fW0aIjwmL2twyly/qmGTZO4e90YiXYyrTQ==', 'sat_certificate': None, 'fiscal_folio': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44', 'stamp_datetime': datetime.datetime(2025, 7, 13, 12, 13, 9), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'xml_file_size': 6122, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:10,822 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml: Failed to save invoice to database
2025-07-19 14:44:11,702 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'details': '{"filename": "2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml", "processing_time": 2.8255252838134766, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.8255252838134766, 'memory_usage': None, 'filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 11, 27987)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:11,703 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'details': '{"filename": "2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml", "processing_time": 2.8255252838134766, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.8255252838134766, 'memory_usage': None, 'filename': '2EE30E68-CDC1-44ED-A1A8-3093B3D45C44.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 11, 27987)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:14,356 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'series': 'F', 'folio': '8430256535', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 20, 43, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 13, 730542), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 13, 730545), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('151.720000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('24.280000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('176.000000'), 'digital_stamp': 'SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[:10]***MASKED***SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[-10:] ... (46 characters truncated) ... IxGABS1htWPXUwJNt35iB1Bemr2LlP823qRKZ4lWulJAIEMvmPXMhk1MBp/dYWjdHwIWLd/SBJjbwcY1v7JO1pk0M647BBF0QvpIoq0O9cpuSOB7zG6OMhD0ByjVQjTJB3OmWZJcheOy0HqTRqw==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'OsyP/uN+8mozwfdUd//LYrv+MKXDLWB84808aMhKldwU+IOj/VGAelpfkznfKH4ohuA+eCbSFHE8VfmFu4NFzUK6VvbrB8znDH5B2C95yynSZP5gE+jqeqpfqnw+yrF1zGFoJfJphkoAMdnvXTz5C ... (46 characters truncated) ... F0tPmUIEc/EZa+snebHibUdv4VA9rdqopnvINg3r3Rfl36wcASj8OPkNacTRmn5WR2g00p9baBpGCjCBljpd0isPG5D/x2iHUG4QZuXqo9ZlMMn3h8pnKcuc60fIK13f/C39KSAI9gAVRpOPHyA==', 'sat_certificate': None, 'fiscal_folio': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 43, 32), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'xml_file_size': 5106, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:14,358 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(5) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'series': 'F', 'folio': '8430256535', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 20, 43, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 13, 730542), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 13, 730545), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('151.720000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('24.280000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('176.000000'), 'digital_stamp': 'SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[:10]***MASKED***SPeFLiaY7Bgnh7j9g4g4O7dtmFZKlIOyxVsWZWzcQ2z+cQw8eSgjyqzhsZSiud793uI34j+d9O6WIOz2NvVK+y/fczPWpPIVWkYCNpemKBBuS4gdM9xwxWfw8v/yPcjiNmbizPBzlYS+9vswfhX8P[-10:] ... (46 characters truncated) ... IxGABS1htWPXUwJNt35iB1Bemr2LlP823qRKZ4lWulJAIEMvmPXMhk1MBp/dYWjdHwIWLd/SBJjbwcY1v7JO1pk0M647BBF0QvpIoq0O9cpuSOB7zG6OMhD0ByjVQjTJB3OmWZJcheOy0HqTRqw==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'OsyP/uN+8mozwfdUd//LYrv+MKXDLWB84808aMhKldwU+IOj/VGAelpfkznfKH4ohuA+eCbSFHE8VfmFu4NFzUK6VvbrB8znDH5B2C95yynSZP5gE+jqeqpfqnw+yrF1zGFoJfJphkoAMdnvXTz5C ... (46 characters truncated) ... F0tPmUIEc/EZa+snebHibUdv4VA9rdqopnvINg3r3Rfl36wcASj8OPkNacTRmn5WR2g00p9baBpGCjCBljpd0isPG5D/x2iHUG4QZuXqo9ZlMMn3h8pnKcuc60fIK13f/C39KSAI9gAVRpOPHyA==', 'sat_certificate': None, 'fiscal_folio': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 43, 32), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'xml_file_size': 5106, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:14,360 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml: Failed to save invoice to database
2025-07-19 14:44:15,166 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'details': '{"filename": "37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml", "processing_time": 2.6548714637756348, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.6548714637756348, 'memory_usage': None, 'filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 14, 549998)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:15,167 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'details': '{"filename": "37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml", "processing_time": 2.6548714637756348, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.6548714637756348, 'memory_usage': None, 'filename': '37D7A4F8-D2A2-4DB2-8E2F-9B9D2C51FDCB.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 14, 549998)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:17,850 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'series': None, 'folio': '51946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 56, 56), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 17, 208108), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 17, 208112), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('184.800000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('184.800000'), 'digital_stamp': 'gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[:10]***MASKED***gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[-10:] ... (46 characters truncated) ... e+1kqtwfA+4iuiSdqhSt5suCPW+v7PQTI841ierDEewHOOVtETpZ8/Qe7n4DJyMBj2uNevgFeQ159sqSlGxhdgSxQzA7DBFR/mDv7F4muXRtHyyolGMjbR0ASvgES2ZfWfIyXcaPpLEXzwQ0+Zg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'k/qYxNSoMTFjIV6uWQRJy+tBCc1tzc3AgOcbagLSy1eca8ZitxIwxGopqI4kUgCD7xq4/BAUZoj51E5W5gl8+KLtZwoLnMjBHSHJ0yrhFKUAKKTP6E8ST9uF9FgeU0mARbYuYtJQO6E/PCK++d63q ... (46 characters truncated) ... 6mRc4RhfFCz6Y2tYDkT4KukfPcd4RxF2LVDa8a2hSaDGiar5oWALzD2mkNXLa3kQvrfOJF/e+ZhkNRJROJWdKe6d5IT5XCDkqf23wCAt3QGZyeksJSjVhQtj3GypGxkAVBGrvopIRbiLqax2X4A==', 'sat_certificate': None, 'fiscal_folio': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 56, 57), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'xml_file_size': 5720, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:17,851 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(6) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'series': None, 'folio': '51946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 56, 56), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 17, 208108), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 17, 208112), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('184.800000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('184.800000'), 'digital_stamp': 'gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[:10]***MASKED***gBvkTZrBbeD086ULhraM7jEliKd+Q/c5Q+1Q4OWqLraEallLQPvFn4nB+nSxYkmSnCrwdEhOOzAYa+g7J41aSp7Re++KgM1BmskVzTxZxSAKQUn9Ib+EQ58NpK1uUZs30jqYIy1Xs/lCuhNREkSAg[-10:] ... (46 characters truncated) ... e+1kqtwfA+4iuiSdqhSt5suCPW+v7PQTI841ierDEewHOOVtETpZ8/Qe7n4DJyMBj2uNevgFeQ159sqSlGxhdgSxQzA7DBFR/mDv7F4muXRtHyyolGMjbR0ASvgES2ZfWfIyXcaPpLEXzwQ0+Zg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'k/qYxNSoMTFjIV6uWQRJy+tBCc1tzc3AgOcbagLSy1eca8ZitxIwxGopqI4kUgCD7xq4/BAUZoj51E5W5gl8+KLtZwoLnMjBHSHJ0yrhFKUAKKTP6E8ST9uF9FgeU0mARbYuYtJQO6E/PCK++d63q ... (46 characters truncated) ... 6mRc4RhfFCz6Y2tYDkT4KukfPcd4RxF2LVDa8a2hSaDGiar5oWALzD2mkNXLa3kQvrfOJF/e+ZhkNRJROJWdKe6d5IT5XCDkqf23wCAt3QGZyeksJSjVhQtj3GypGxkAVBGrvopIRbiLqax2X4A==', 'sat_certificate': None, 'fiscal_folio': '38CBAC2B-A89B-4309-B925-4801B835A59F', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 56, 57), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'xml_file_size': 5720, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:17,853 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 38CBAC2B-A89B-4309-B925-4801B835A59F.xml: Failed to save invoice to database
2025-07-19 14:44:18,680 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'details': '{"filename": "38CBAC2B-A89B-4309-B925-4801B835A59F.xml", "processing_time": 2.683199882507324, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.683199882507324, 'memory_usage': None, 'filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 18, 50817)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:18,681 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'details': '{"filename": "38CBAC2B-A89B-4309-B925-4801B835A59F.xml", "processing_time": 2.683199882507324, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.683199882507324, 'memory_usage': None, 'filename': '38CBAC2B-A89B-4309-B925-4801B835A59F.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 18, 50817)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:26,785 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'series': 'B', 'folio': '120892235', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 19, 45, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 26, 177969), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 26, 177972), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('991.370000'), 'total_discount': Decimal('245.930000'), 'total_transferred_taxes': Decimal('119.270000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('864.710000'), 'digital_stamp': 'KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[:10]***MASKED***KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[-10:] ... (46 characters truncated) ... bt8dmNOobNN/ehF8iPvOJ8OjmRyZdKiq1ixJFZmg9OEP8Q8rt6j3tATPYQhdWQRTbYiLfgxFxZtECMQQDi4/eMK7TpWtJ69kstS4LsBPYK3vpPd/uS2VmSPGtheDluEr1fkNA39/kXA42uKkJtg==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'abRVjQq2R/iM4ChtjW3mWx0jBk1dmIbpp1OWN0V8f6K8C9bhLBfirEnJ2CnvRBjBg0BLtXYZ/ihkDZlCJ416OPdR7dFeHUHUgtapZHJxDpLPKGjQV/TLBQZukPZVn9hPdFXm+AbYRyUiZ+ZDMjD2c ... (46 characters truncated) ... qjn6cGieiOP1R79L6GIMbwYWHRYQTNcG2orU1iRQGgIqUeohD8E0lgUxfdrsYUfDsytMIWmFYR13lC2SApMpDpjNx9YlJ6bEc+YxIXkDvkOaybm4sgHgSaWhBDS4rtrP9C+NBNchIhyIRpfRyyw==', 'sat_certificate': None, 'fiscal_folio': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 45, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'xml_file_size': 6651, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:26,788 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(7) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'series': 'B', 'folio': '120892235', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 19, 45, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 26, 177969), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 26, 177972), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('991.370000'), 'total_discount': Decimal('245.930000'), 'total_transferred_taxes': Decimal('119.270000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('864.710000'), 'digital_stamp': 'KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[:10]***MASKED***KKl3MPCP37y8XM1wzPX2TxHJHDg6PnvXi3m++Jj1qYlqUfLFTZrAwoMGYzEFYCw7bPTAhBne+/f1HRuyOb5eD8W5KesjwatWiXiCZLnokXaLQSf+vUZH7Yjzs7jwuTaob9EkP1NI4CBNUvaZLhvFu[-10:] ... (46 characters truncated) ... bt8dmNOobNN/ehF8iPvOJ8OjmRyZdKiq1ixJFZmg9OEP8Q8rt6j3tATPYQhdWQRTbYiLfgxFxZtECMQQDi4/eMK7TpWtJ69kstS4LsBPYK3vpPd/uS2VmSPGtheDluEr1fkNA39/kXA42uKkJtg==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'abRVjQq2R/iM4ChtjW3mWx0jBk1dmIbpp1OWN0V8f6K8C9bhLBfirEnJ2CnvRBjBg0BLtXYZ/ihkDZlCJ416OPdR7dFeHUHUgtapZHJxDpLPKGjQV/TLBQZukPZVn9hPdFXm+AbYRyUiZ+ZDMjD2c ... (46 characters truncated) ... qjn6cGieiOP1R79L6GIMbwYWHRYQTNcG2orU1iRQGgIqUeohD8E0lgUxfdrsYUfDsytMIWmFYR13lC2SApMpDpjNx9YlJ6bEc+YxIXkDvkOaybm4sgHgSaWhBDS4rtrP9C+NBNchIhyIRpfRyyw==', 'sat_certificate': None, 'fiscal_folio': '39DFD638-CD36-4FDC-B1D4-811C1A61665B', 'stamp_datetime': datetime.datetime(2025, 7, 17, 20, 45, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'xml_file_size': 6651, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:26,789 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml: Failed to save invoice to database
2025-07-19 14:44:27,609 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'details': '{"filename": "39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml", "processing_time": 8.105765581130981, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 8.105765581130981, 'memory_usage': None, 'filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 26, 981250)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:27,610 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'details': '{"filename": "39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml", "processing_time": 8.105765581130981, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 8.105765581130981, 'memory_usage': None, 'filename': '39DFD638-CD36-4FDC-B1D4-811C1A61665B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 26, 981250)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:34,207 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'series': None, 'folio': '52009', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 28, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 33, 588533), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 33, 588536), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('634.600000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('634.600000'), 'digital_stamp': 'cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[:10]***MASKED***cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[-10:] ... (46 characters truncated) ... H9nhL5S8syZmxiuN2/Dl8ErCv7am+uSCeMKtmfVX7R0v5XZg2ptY0eLx2wF97Vcn+PuRWlAo8itLAKlvvwKtnbaoFHFNh4MxeUU2ZdJhTanuqxw+5x7yfTa7nS6pRaED3/RxspIdWk/Q39KZUVg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'SWsuq7E9Lbh1Gj4EH31OJU+TRkzxX2oM0lNi/UIhLo54sHjcvnchdxVuQ5sHxX9zNhHvaJAhH53kN8urH9Bz9f3Rpnx+sCy+1C5SvDkqgJR6dgU2gJnXl+73MDwDM8Pp2MwrRHa1ep8ZyoxABEN53 ... (46 characters truncated) ... vi8nfJtCZ+jMfXybIno8dcxxcjimbgG95PtHypOcZv9niEJupYNo3mRz5ANKoUABU6rp7idPkMD0Z1YTRdRQ2T5l1g2p8aCMJHfSAg9azN8nYSgZWtf0glU8Gjf95HVhTDgtIYyBQRZwQCw0cNA==', 'sat_certificate': None, 'fiscal_folio': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 28, 10), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'xml_file_size': 6482, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:34,209 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(8) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'series': None, 'folio': '52009', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 28, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 33, 588533), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 33, 588536), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('634.600000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('634.600000'), 'digital_stamp': 'cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[:10]***MASKED***cOSxCFrI5S2j/lLP+htzbBe2IfRDL6gbCENafRiDKrrZXbZNen07oNHFh+xVdC4TX+ij7f9CPFfZofLIvC/1dWtpolbL/cmwzoGygXc9pSwOjDsM25cLKTWt780qT+t7UnW8JEbjXNTjkH+IhSgkJ[-10:] ... (46 characters truncated) ... H9nhL5S8syZmxiuN2/Dl8ErCv7am+uSCeMKtmfVX7R0v5XZg2ptY0eLx2wF97Vcn+PuRWlAo8itLAKlvvwKtnbaoFHFNh4MxeUU2ZdJhTanuqxw+5x7yfTa7nS6pRaED3/RxspIdWk/Q39KZUVg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'SWsuq7E9Lbh1Gj4EH31OJU+TRkzxX2oM0lNi/UIhLo54sHjcvnchdxVuQ5sHxX9zNhHvaJAhH53kN8urH9Bz9f3Rpnx+sCy+1C5SvDkqgJR6dgU2gJnXl+73MDwDM8Pp2MwrRHa1ep8ZyoxABEN53 ... (46 characters truncated) ... vi8nfJtCZ+jMfXybIno8dcxxcjimbgG95PtHypOcZv9niEJupYNo3mRz5ANKoUABU6rp7idPkMD0Z1YTRdRQ2T5l1g2p8aCMJHfSAg9azN8nYSgZWtf0glU8Gjf95HVhTDgtIYyBQRZwQCw0cNA==', 'sat_certificate': None, 'fiscal_folio': '45C65D2A-1889-4BCE-93CD-10119064B54C', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 28, 10), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'xml_file_size': 6482, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:34,210 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 45C65D2A-1889-4BCE-93CD-10119064B54C.xml: Failed to save invoice to database
2025-07-19 14:44:35,024 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'details': '{"filename": "45C65D2A-1889-4BCE-93CD-10119064B54C.xml", "processing_time": 6.598853349685669, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.598853349685669, 'memory_usage': None, 'filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 34, 415866)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:35,024 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'details': '{"filename": "45C65D2A-1889-4BCE-93CD-10119064B54C.xml", "processing_time": 6.598853349685669, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.598853349685669, 'memory_usage': None, 'filename': '45C65D2A-1889-4BCE-93CD-10119064B54C.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 34, 415866)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:38,924 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'series': None, 'folio': '52187', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 51, 31), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 38, 314193), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 38, 314196), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('235.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('235.500000'), 'digital_stamp': 'Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[:10]***MASKED***Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[-10:] ... (46 characters truncated) ... ejLxZpPpZKvKxKfmcng7/rTdKGe22GHtTCcmuXvlPXtVHXzGOdLWDRcJWxG6N8euJB8Q4T5x3JbdA5LRqvwbJnXK3nR53qoJXGkZbd7eTAPehb+rLBFzAAS/lsXf6eFlK/dqyUHCQ24EW+jRwQw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'cpQ7Do7csXdZuSIWekby7gMIDslJYnYSllru1bJEf/HHaYE43IuerihfS3UadDy93skUvJv1f5zACKkZGjSaM/h08R0GtlwfOygodob5b6ih++BYcL7qaZeEGQK2pqZ9XuQ38qkrr/GMdq6LWsZu5 ... (46 characters truncated) ... vGyAltLMKmy/xs3NhU1a2lr+V8guRfVLIcvjo1u0D46dPhvuDQQxcldUi7ZZWufyMQ1cbJAzqDdsFAgtNoa2zbiukNPaMBvzY50uAjRMU5gh3FocvFLq+LTQf/BJHVzVRtJ0oLBM4ZA8Hy0XvVA==', 'sat_certificate': None, 'fiscal_folio': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 51, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'xml_file_size': 5743, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:38,926 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(9) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'series': None, 'folio': '52187', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 51, 31), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 38, 314193), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 38, 314196), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('235.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('235.500000'), 'digital_stamp': 'Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[:10]***MASKED***Lcz9U7oDKYnh7lnx3a8MwzXn3ABA1Gdp9b+sJ3byrNJkJIib7FQLMqSShvZrfxe2q1bLNVb1VsSj2WBuvHp7YeGy4H3Ift2I73sknetENrP8KfZ5aCFYc4oOhknZyi0AFnRHllNmLeTuCqLSM3DOw[-10:] ... (46 characters truncated) ... ejLxZpPpZKvKxKfmcng7/rTdKGe22GHtTCcmuXvlPXtVHXzGOdLWDRcJWxG6N8euJB8Q4T5x3JbdA5LRqvwbJnXK3nR53qoJXGkZbd7eTAPehb+rLBFzAAS/lsXf6eFlK/dqyUHCQ24EW+jRwQw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'cpQ7Do7csXdZuSIWekby7gMIDslJYnYSllru1bJEf/HHaYE43IuerihfS3UadDy93skUvJv1f5zACKkZGjSaM/h08R0GtlwfOygodob5b6ih++BYcL7qaZeEGQK2pqZ9XuQ38qkrr/GMdq6LWsZu5 ... (46 characters truncated) ... vGyAltLMKmy/xs3NhU1a2lr+V8guRfVLIcvjo1u0D46dPhvuDQQxcldUi7ZZWufyMQ1cbJAzqDdsFAgtNoa2zbiukNPaMBvzY50uAjRMU5gh3FocvFLq+LTQf/BJHVzVRtJ0oLBM4ZA8Hy0XvVA==', 'sat_certificate': None, 'fiscal_folio': '51968191-3B2B-444A-9C5E-4EC226E5FF63', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 51, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'xml_file_size': 5743, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:38,927 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 51968191-3B2B-444A-9C5E-4EC226E5FF63.xml: Failed to save invoice to database
2025-07-19 14:44:39,725 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'details': '{"filename": "51968191-3B2B-444A-9C5E-4EC226E5FF63.xml", "processing_time": 3.900867223739624, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.900867223739624, 'memory_usage': None, 'filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 39, 123594)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:39,726 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'details': '{"filename": "51968191-3B2B-444A-9C5E-4EC226E5FF63.xml", "processing_time": 3.900867223739624, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.900867223739624, 'memory_usage': None, 'filename': '51968191-3B2B-444A-9C5E-4EC226E5FF63.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 39, 123594)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:41,328 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'series': 'F', 'folio': '8430688765', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 21, 43, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 40, 720687), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 40, 720690), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('85.340000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('13.650000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('98.990000'), 'digital_stamp': 'cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[:10]***MASKED***cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[-10:] ... (46 characters truncated) ... RL3masOApqBeG3955Sov7rluDItM2zfjoNofySeoOWVBNnaKoMsV3eTDLD9VPK8W0hno39+FPLBqUI+7Sr3ZRJERef6Yz3Ib0BTDkvwevTBGbAtaZAw+D4Sn+Rrhj5JvDe1CF8962L+4QzTDv8w==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'g93X1GAC2UouRg+BS9N7SSLdpx+EGRntJXKx3C/D+XWacr3F8ZwSGzoCalpiese7+WOpLkOdCuPA6KNoIXGr2Zx6H7GaI3bGeiFgxejepAiOpSmOLMJqzHnvm37rHKuKuWBvY0lSZkZClfYNol/n2 ... (46 characters truncated) ... IPyfDrZYc9/cu9325wKg1TmqzjOOFJlE+my66s/ikj7PBYrHSaAnqs0aL6EAM1RPnxsAZvIZSWIz7QYIhNaZAYSr054ATZyPJ7hdGp0sJYG27xxlwyn5w/OtBJY37yy8+B1GbNf+LQ+f3IwLmxg==', 'sat_certificate': None, 'fiscal_folio': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 43, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'xml_file_size': 5100, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:41,330 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(10) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'series': 'F', 'folio': '8430688765', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 21, 43, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 40, 720687), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 40, 720690), 'issuer_rfc': 'TBO******2Q6', 'issuer_name': 'EXPINS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('85.340000'), 'total_discount': Decimal('0.000000'), 'total_transferred_taxes': Decimal('13.650000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('98.990000'), 'digital_stamp': 'cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[:10]***MASKED***cP/HFNjnb3dJSUZULnDeiJtI+rKsWjpy1wt6IhJxL1bNAtvMrIWh7vrR+z+b37m0hkH5PQguL4i0cwlXdE/6Jlm23hWQa4FlTTwdLb+iyFixBImfFzmjVOL8nm9Zq6aneW6m+2gEtA0Yia1z29Fem[-10:] ... (46 characters truncated) ... RL3masOApqBeG3955Sov7rluDItM2zfjoNofySeoOWVBNnaKoMsV3eTDLD9VPK8W0hno39+FPLBqUI+7Sr3ZRJERef6Yz3Ib0BTDkvwevTBGbAtaZAw+D4Sn+Rrhj5JvDe1CF8962L+4QzTDv8w==', 'certificate_number': '00001000000709598097', 'certificate': None, 'sat_seal': 'g93X1GAC2UouRg+BS9N7SSLdpx+EGRntJXKx3C/D+XWacr3F8ZwSGzoCalpiese7+WOpLkOdCuPA6KNoIXGr2Zx6H7GaI3bGeiFgxejepAiOpSmOLMJqzHnvm37rHKuKuWBvY0lSZkZClfYNol/n2 ... (46 characters truncated) ... IPyfDrZYc9/cu9325wKg1TmqzjOOFJlE+my66s/ikj7PBYrHSaAnqs0aL6EAM1RPnxsAZvIZSWIz7QYIhNaZAYSr054ATZyPJ7hdGp0sJYG27xxlwyn5w/OtBJY37yy8+B1GbNf+LQ+f3IwLmxg==', 'sat_certificate': None, 'fiscal_folio': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 43, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'xml_file_size': 5100, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:41,331 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml: Failed to save invoice to database
2025-07-19 14:44:42,164 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'details': '{"filename": "5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml", "processing_time": 1.6034173965454102, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.6034173965454102, 'memory_usage': None, 'filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 41, 531276)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:42,165 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'details': '{"filename": "5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml", "processing_time": 1.6034173965454102, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.6034173965454102, 'memory_usage': None, 'filename': '5203BBD6-0F9D-4E81-99DA-9B9D2C511BE1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 41, 531276)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:44,868 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'series': None, 'folio': '52124', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 14, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 44, 233665), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 44, 233668), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('83.940000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('83.940000'), 'digital_stamp': 'b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[:10]***MASKED***b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[-10:] ... (46 characters truncated) ... Ov4y2QecQIEwuQ1/4jSYc/+Q2JEsT6qoVxze7kJXnBV40+CzFQhHfv2t6pO0qoIT2/5/CA/ABva6RVCxvDEPvHhtt1jfFLbyI8i4JjzafLUnVPhIeL1bSqzUh62/GGBeEqFd6LsXYmZEHYCh/8Q==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'Q33Rj5Z4wz4QuCKH5/UDLd9w+vb9vn27KPsN948hTyWBi3VJoUYmfCW85ELrGJA7agM8IyAfbv8Oi1XbOcFDNCOdie5a5/nxWubds4wsL+8wg1EfwDsWLC/EBxuYSMXeJRQuKrUqhx5cU3qfm/rTt ... (46 characters truncated) ... Av+C1X0rfYblcfKwsRP9VT8EnjXsSsnvfouZrxKwRmk5YJ1lguPDXKZpWA99/FvuiOVDZWcjZ0Aeog+g4+b56+gr19wVkaBqsA+QnF0MuPHB1CNbstGi26vvtCEL1v5Th6XzG6pLa+0mEvSDzNQ==', 'sat_certificate': None, 'fiscal_folio': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 14, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'xml_file_size': 5739, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:44,869 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(11) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'series': None, 'folio': '52124', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 14, 10), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 44, 233665), 'updated_at': datetime.datetime(2025, 7, 19, 21, 44, 44, 233668), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('83.940000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('83.940000'), 'digital_stamp': 'b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[:10]***MASKED***b8R7YwpB19Ze8nlghnC3rAET1sbwS04YMuScCCQrjwtqQeBwywKS3rnt/+3r7Ki5uAYv1koBGEDdKhJI6zOMZGAzWgB1Z/pOR9dxjlMVFVKtL1rPvRTheL9b6oIn5kDeduamlCcjhxdXF+0O5P7n1[-10:] ... (46 characters truncated) ... Ov4y2QecQIEwuQ1/4jSYc/+Q2JEsT6qoVxze7kJXnBV40+CzFQhHfv2t6pO0qoIT2/5/CA/ABva6RVCxvDEPvHhtt1jfFLbyI8i4JjzafLUnVPhIeL1bSqzUh62/GGBeEqFd6LsXYmZEHYCh/8Q==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'Q33Rj5Z4wz4QuCKH5/UDLd9w+vb9vn27KPsN948hTyWBi3VJoUYmfCW85ELrGJA7agM8IyAfbv8Oi1XbOcFDNCOdie5a5/nxWubds4wsL+8wg1EfwDsWLC/EBxuYSMXeJRQuKrUqhx5cU3qfm/rTt ... (46 characters truncated) ... Av+C1X0rfYblcfKwsRP9VT8EnjXsSsnvfouZrxKwRmk5YJ1lguPDXKZpWA99/FvuiOVDZWcjZ0Aeog+g4+b56+gr19wVkaBqsA+QnF0MuPHB1CNbstGi26vvtCEL1v5Th6XzG6pLa+0mEvSDzNQ==', 'sat_certificate': None, 'fiscal_folio': '5904C04A-1AB0-43E4-A13D-C955C3AC758D', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 14, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'xml_file_size': 5739, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:44,871 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml: Failed to save invoice to database
2025-07-19 14:44:45,692 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'details': '{"filename": "5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml", "processing_time": 2.7036545276641846, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.7036545276641846, 'memory_usage': None, 'filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 45, 66580)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:45,693 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'details': '{"filename": "5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml", "processing_time": 2.7036545276641846, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.7036545276641846, 'memory_usage': None, 'filename': '5904C04A-1AB0-43E4-A13D-C955C3AC758D.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 45, 66580)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:47,396 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'details': '{"filename": "5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml", "processing_time": 0.8499536514282227, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6 already exists"}', 'execution_time': 0.8499536514282227, 'memory_usage': None, 'filename': '5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 46, 744986)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:44:47,397 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'details': '{"filename": "5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml", "processing_time": 0.8499536514282227, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6 already exists"}', 'execution_time': 0.8499536514282227, 'memory_usage': None, 'filename': '5A6AB4C5-995F-46F3-B7D7-BED6C80AEFD6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 44, 46, 744986)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:02,334 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5EF48096-4938-424D-A25F-FB33575C2180', 'series': None, 'folio': '52045', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 20, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 1, 91549), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 1, 91552), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1006.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1006.960000'), 'digital_stamp': 'EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[:10]***MASKED***EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[-10:] ... (46 characters truncated) ... Di8WxNWW797Sg7qcx77Hn2YdrO9uyTkpmVQswY4mbxKKBiriJ6raNcfdRwdP/j9fFHOTZC+DZSg5QrapFNoPnGP/Cw3lD0Ki55BR3EuBEMazG778XGOecBetatA58Ct5wS/0GjdXmEjE1in64nQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'DZ0zh0G2ENJSczU4Q2PvLxa6FiB6XjCIgcu45AzM2DxpVU+kPbIuDqyXZGsoEodqe0eW0w27KXM+SExT6UasFSRTXTjhWqGa1DBTysB+DDqYU6/W52zlcEOAVg4JVventBUtWUASMoT0e+s6FCbhP ... (46 characters truncated) ... abmtPb6ANITcsFNRAd4pJF7tGA+0tIA+3po8DbtM5uthpJCX4hRZ7OL/a7msjhq6HpKwKPi8iqfOpU94TL5/Gr1T9TAmFeeyNKpCpOhXyrZ+4/lqul+JKEDN2089gFUqrLhSEwup5cozgzGD+kA==', 'sat_certificate': None, 'fiscal_folio': '5EF48096-4938-424D-A25F-FB33575C2180', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 20, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'xml_file_size': 9128, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:02,336 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(12) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '5EF48096-4938-424D-A25F-FB33575C2180', 'series': None, 'folio': '52045', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 20, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 1, 91549), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 1, 91552), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1006.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1006.960000'), 'digital_stamp': 'EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[:10]***MASKED***EfDDgi8aQdXyu8FGSlnJU+ik4ZQp99LH/EXyE3UKvY3XE/K0oD7vyUOsgW0vKkHgxIVpZ7mH1/xH+iNdqqgKZAi7RDyvotDx5XfIvqeLXF0gOAKfiVkcHs8fqltTQcV+etqLUcu8FcAI6FvEOWdh1[-10:] ... (46 characters truncated) ... Di8WxNWW797Sg7qcx77Hn2YdrO9uyTkpmVQswY4mbxKKBiriJ6raNcfdRwdP/j9fFHOTZC+DZSg5QrapFNoPnGP/Cw3lD0Ki55BR3EuBEMazG778XGOecBetatA58Ct5wS/0GjdXmEjE1in64nQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'DZ0zh0G2ENJSczU4Q2PvLxa6FiB6XjCIgcu45AzM2DxpVU+kPbIuDqyXZGsoEodqe0eW0w27KXM+SExT6UasFSRTXTjhWqGa1DBTysB+DDqYU6/W52zlcEOAVg4JVventBUtWUASMoT0e+s6FCbhP ... (46 characters truncated) ... abmtPb6ANITcsFNRAd4pJF7tGA+0tIA+3po8DbtM5uthpJCX4hRZ7OL/a7msjhq6HpKwKPi8iqfOpU94TL5/Gr1T9TAmFeeyNKpCpOhXyrZ+4/lqul+JKEDN2089gFUqrLhSEwup5cozgzGD+kA==', 'sat_certificate': None, 'fiscal_folio': '5EF48096-4938-424D-A25F-FB33575C2180', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 20, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'xml_file_size': 9128, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:02,337 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5EF48096-4938-424D-A25F-FB33575C2180.xml: Failed to save invoice to database
2025-07-19 14:45:03,532 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5EF48096-4938-424D-A25F-FB33575C2180.xml', 'details': '{"filename": "5EF48096-4938-424D-A25F-FB33575C2180.xml", "processing_time": 14.93785309791565, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 14.93785309791565, 'memory_usage': None, 'filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 2, 921452)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:03,532 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 5EF48096-4938-424D-A25F-FB33575C2180.xml', 'details': '{"filename": "5EF48096-4938-424D-A25F-FB33575C2180.xml", "processing_time": 14.93785309791565, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 14.93785309791565, 'memory_usage': None, 'filename': '5EF48096-4938-424D-A25F-FB33575C2180.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 2, 921452)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:10,235 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'series': None, 'folio': '52220', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 9, 660090), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 9, 660093), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('970.580000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('970.580000'), 'digital_stamp': 'VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[:10]***MASKED***VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[-10:] ... (46 characters truncated) ... xldewdCxxwaMYlRYfFPk9BbVMf/Ep7rVDiBMknjq3GXd8opsxzm4+LAVgPS7Fa9+PmmbDAZf+PlPU0QXHU4krDpX92jleHKwa1LAPqKcJUoMNrIqAbLKKVRiZiBivXhlva3mzVBkHXecX1wv/Gw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ULv/oCJLkbYUNM7xpb9xgZRomeqf2C2pE+tf2LeNIi87yuif+ox33qjwRxn/TzcTeYzGU7Aq73FA/J9u0nCH23SvjxJWKVTj7CKLlSaoEeVRpQ4eenvrh5MmMyxorkAZBRacm3SGWb/WvtdpDc0jr ... (46 characters truncated) ... vx3OKnr80IfWwpoOj7Bq0W07thQ5BOcmzLBoNj2Nv2HQ9fLfhewoLPzEMx+NOkGNwV8V2ZeQF6rGh+Il2HAnradpamkEgvQfjKx8gIDDtvsl1MjN0cXPlze/UWVqinq7pYCRp9wdvs6xRngFQiA==', 'sat_certificate': None, 'fiscal_folio': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'xml_file_size': 8012, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:10,237 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(13) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'series': None, 'folio': '52220', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 33, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 9, 660090), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 9, 660093), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('970.580000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('970.580000'), 'digital_stamp': 'VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[:10]***MASKED***VjH783/7CLeQ9CV71zUZU7G3c8Mto6hveisMuehLErOm0NZnS8aof5lN4cm930IYD0dmcdafwD+86Z4xUXpL6TA4GoxV1MiQ3RKM/0y5pmbb0sXCdVGHucy/qsW9f/0N15nsoBLByrD2DnPGKi3DN[-10:] ... (46 characters truncated) ... xldewdCxxwaMYlRYfFPk9BbVMf/Ep7rVDiBMknjq3GXd8opsxzm4+LAVgPS7Fa9+PmmbDAZf+PlPU0QXHU4krDpX92jleHKwa1LAPqKcJUoMNrIqAbLKKVRiZiBivXhlva3mzVBkHXecX1wv/Gw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ULv/oCJLkbYUNM7xpb9xgZRomeqf2C2pE+tf2LeNIi87yuif+ox33qjwRxn/TzcTeYzGU7Aq73FA/J9u0nCH23SvjxJWKVTj7CKLlSaoEeVRpQ4eenvrh5MmMyxorkAZBRacm3SGWb/WvtdpDc0jr ... (46 characters truncated) ... vx3OKnr80IfWwpoOj7Bq0W07thQ5BOcmzLBoNj2Nv2HQ9fLfhewoLPzEMx+NOkGNwV8V2ZeQF6rGh+Il2HAnradpamkEgvQfjKx8gIDDtvsl1MjN0cXPlze/UWVqinq7pYCRp9wdvs6xRngFQiA==', 'sat_certificate': None, 'fiscal_folio': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 33, 33), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'xml_file_size': 8012, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:10,238 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml: Failed to save invoice to database
2025-07-19 14:45:11,004 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'details': '{"filename": "61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml", "processing_time": 6.703737735748291, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.703737735748291, 'memory_usage': None, 'filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 10, 426897)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:11,005 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'details': '{"filename": "61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml", "processing_time": 6.703737735748291, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.703737735748291, 'memory_usage': None, 'filename': '61BB3E35-1C9B-4CFC-B7A2-A0F23456D040.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 10, 426897)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:15,440 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'series': 'AA', 'folio': '98310', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 46, 43), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 14, 852695), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 14, 852698), 'issuer_rfc': 'AAE******3E6', 'issuer_name': 'ABASTECEDORA DE ALIMENTOS Y EMBUTIDOS VALLE HERMANOS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('2642.760000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('2642.760000'), 'digital_stamp': 'eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[:10]***MASKED***eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[-10:] ... (46 characters truncated) ... RrIJSadcJ3mzkuDdQPidA044+IzxtdR39XllOHhu6jOQx8xYNbD9yTkkLY7l41siqGOfBk1qy5g/ljtE+QeM24Oiv1jtsBWVNwj4utibT1YCDsu+3bdGIT42d1fyh8QkXcy0xTbbtnBegU1kY7A==', 'certificate_number': '00001000000514916510', 'certificate': None, 'sat_seal': 'G8ZhU7xmP1x6ezossLC1pwNDxLCPOz5PnIvHtS8a7zmzXs3+jG/zeZn42rVXj41+AhCTTm+JRLEB4D8rS2LfI/6RFQEas1mqyFOOoW2Uh7MQ052nvb/0q3LRMjc3rpeVIOCGFqRSQExPvz+HjnwaL ... (46 characters truncated) ... geNm9rffGT2s1Ms7S1X9DAJuIgyWsltA1oAotcizT6KkbVRBEVhUs5FgbqimZ+zp7eUjJuju5Z+EdZGejgvBBQrEyuOy3yXpQJC0fjmxE9wZAhG6RM9foQORRKdMnQ5DSphBT0oYF3Dq5Z5S/gQ==', 'sat_certificate': None, 'fiscal_folio': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 46, 48), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'xml_file_size': 6778, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:15,442 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(14) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'series': 'AA', 'folio': '98310', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 46, 43), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 14, 852695), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 14, 852698), 'issuer_rfc': 'AAE******3E6', 'issuer_name': 'ABASTECEDORA DE ALIMENTOS Y EMBUTIDOS VALLE HERMANOS', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('2642.760000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('2642.760000'), 'digital_stamp': 'eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[:10]***MASKED***eDdgQSal2kbLTtXDQlTHxsfp5MVRETR+u1iuW1aoKEhm0qDvfMfGYLjAcQTXox/JaEVbNG0PFBlMhbftBrs0hnkZ/LLFdqwBS/rK0pw95icEnl84fFLBqAYtAaP2/T+yNYYBBur3qQa212qAGo2Oi[-10:] ... (46 characters truncated) ... RrIJSadcJ3mzkuDdQPidA044+IzxtdR39XllOHhu6jOQx8xYNbD9yTkkLY7l41siqGOfBk1qy5g/ljtE+QeM24Oiv1jtsBWVNwj4utibT1YCDsu+3bdGIT42d1fyh8QkXcy0xTbbtnBegU1kY7A==', 'certificate_number': '00001000000514916510', 'certificate': None, 'sat_seal': 'G8ZhU7xmP1x6ezossLC1pwNDxLCPOz5PnIvHtS8a7zmzXs3+jG/zeZn42rVXj41+AhCTTm+JRLEB4D8rS2LfI/6RFQEas1mqyFOOoW2Uh7MQ052nvb/0q3LRMjc3rpeVIOCGFqRSQExPvz+HjnwaL ... (46 characters truncated) ... geNm9rffGT2s1Ms7S1X9DAJuIgyWsltA1oAotcizT6KkbVRBEVhUs5FgbqimZ+zp7eUjJuju5Z+EdZGejgvBBQrEyuOy3yXpQJC0fjmxE9wZAhG6RM9foQORRKdMnQ5DSphBT0oYF3Dq5Z5S/gQ==', 'sat_certificate': None, 'fiscal_folio': '67b6c2f6-b8d5-484e-9b17-f613b448f10b', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 46, 48), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'xml_file_size': 6778, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:15,443 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml: Failed to save invoice to database
2025-07-19 14:45:16,212 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'details': '{"filename": "67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml", "processing_time": 4.436429738998413, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.436429738998413, 'memory_usage': None, 'filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 15, 635542)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:16,212 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'details': '{"filename": "67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml", "processing_time": 4.436429738998413, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.436429738998413, 'memory_usage': None, 'filename': '67b6c2f6-b8d5-484e-9b17-f613b448f10b.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 15, 635542)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:21,713 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'series': None, 'folio': '51945', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 52, 28), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 21, 131747), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 21, 131751), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1108.300000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1108.300000'), 'digital_stamp': 'Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[:10]***MASKED***Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[-10:] ... (46 characters truncated) ... mO9yDGU8akqDctY9B40EdtXVfHif28phhO/haaeykGdaUVzDdWgDlXYqOWbHKIrpy2JXm+EO/SlACi1W/iohfgfmtDSat15nbw09YHBD9tDFOUZ4r2SZ0WcXwqX1bVHG09Ks+a6cZst/804/knw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WgSqOde5Bid5CM5dNiF7Q6HeDUtwwLL5AeF2yJwTpd4usxMT3LXbM1K8tZTTRT+2VtOQvtbUrJoGv4PZ0RSH0pDBYVEmPrKxcy4Ql1VUdbMIv7/cIIRRt7z0aAv52B7NNJRP2qd4sVmXoLa0P7OcJ ... (46 characters truncated) ... ZJryhPEssFMGfVx9qB/zvYqnBaoGHjEfd+q7Q0mYf7zYpBZsUA9eMNDy0JPEccBFrOhAIwUr11qR9nTfP72aQwQ8eASpodfR1tPQ+HTcI13E5Bpj5QGDgcVv31Uh2tChfvOXB3U5nvZAtfXkD8g==', 'sat_certificate': None, 'fiscal_folio': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 52, 29), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'xml_file_size': 6503, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:21,715 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(15) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'series': None, 'folio': '51945', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 52, 28), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 21, 131747), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 21, 131751), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1108.300000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1108.300000'), 'digital_stamp': 'Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[:10]***MASKED***Z7xZA/mxYZLBSNRbAv8rS2EOgAD/UpvmiiwsP5CJAJ8ZF1asJOyUJj6Ut3A8cwBNYodpcnbKX1u+lzuNP+7XyXw5QQpgJ6Vc44x7nizVvUv5mNhbElo97X6uENtdzSYVH67Hs/7K7N+GsuX5Eqetx[-10:] ... (46 characters truncated) ... mO9yDGU8akqDctY9B40EdtXVfHif28phhO/haaeykGdaUVzDdWgDlXYqOWbHKIrpy2JXm+EO/SlACi1W/iohfgfmtDSat15nbw09YHBD9tDFOUZ4r2SZ0WcXwqX1bVHG09Ks+a6cZst/804/knw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WgSqOde5Bid5CM5dNiF7Q6HeDUtwwLL5AeF2yJwTpd4usxMT3LXbM1K8tZTTRT+2VtOQvtbUrJoGv4PZ0RSH0pDBYVEmPrKxcy4Ql1VUdbMIv7/cIIRRt7z0aAv52B7NNJRP2qd4sVmXoLa0P7OcJ ... (46 characters truncated) ... ZJryhPEssFMGfVx9qB/zvYqnBaoGHjEfd+q7Q0mYf7zYpBZsUA9eMNDy0JPEccBFrOhAIwUr11qR9nTfP72aQwQ8eASpodfR1tPQ+HTcI13E5Bpj5QGDgcVv31Uh2tChfvOXB3U5nvZAtfXkD8g==', 'sat_certificate': None, 'fiscal_folio': '68D6BCE1-2F64-4366-A174-68AB5975FD04', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 52, 29), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'xml_file_size': 6503, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:21,717 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 68D6BCE1-2F64-4366-A174-68AB5975FD04.xml: Failed to save invoice to database
2025-07-19 14:45:22,500 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'details': '{"filename": "68D6BCE1-2F64-4366-A174-68AB5975FD04.xml", "processing_time": 5.5024919509887695, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 5.5024919509887695, 'memory_usage': None, 'filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 21, 898677)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:22,501 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'details': '{"filename": "68D6BCE1-2F64-4366-A174-68AB5975FD04.xml", "processing_time": 5.5024919509887695, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 5.5024919509887695, 'memory_usage': None, 'filename': '68D6BCE1-2F64-4366-A174-68AB5975FD04.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 21, 898677)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:25,084 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'series': None, 'folio': '012540015832846946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 0, 8, 4), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 24, 494322), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 24, 494325), 'issuer_rfc': 'BBA******LJ2', 'issuer_name': 'BBVA MEXICO, S.A., INSTITUCION DE BANCA MULTIPLE, GRUPO FINANCIERO BBVA MEXICO', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('0'), 'subtotal': Decimal('0.010000'), 'total_discount': Decimal('0.010000'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('0.000000'), 'digital_stamp': 'VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[:10]***MASKED***VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[-10:] ... (46 characters truncated) ... vKVUZwi6lhOLQRalJ4+1dHSayrOAC9t65uyGM7sp3LZnlSRVp2bB8uQRl7QBRMKB+72pDe46ovnRMoZyH1vhZtxVhLPffiIfWsu53F67UG9C5GuuQGW9BeCyCUVyJNiBZTwlWWJX2N5nseNoWbA==', 'certificate_number': '00001000000509478830', 'certificate': None, 'sat_seal': 'YY8ddVn3C615+iRMXrnaaHnI6S5XteXgZCuHwXVTCydxr8TSZwNhg36KMuPGv4k0E4jgEDGMehJ5qDGfqhlu1tt7Yign4pqRvKUrnt9MdwLLiVg5MMvOsg4SJqlNLquybsGtDydDIf2q51Vm7Evj5 ... (46 characters truncated) ... LmNxst5S6qB2jr6agF+7heNBgzHaLGQi8vGxBKMc8fi4Rz8b3Gbtro5k2dnNgBIz+wF8c3PuRJc6JPEecX50TP/AmqXzpzWAszR5qNvLrBee6tVydJuVNLc9QBLMqBweE8jp/kc5D3zThy6nv0g==', 'sat_certificate': None, 'fiscal_folio': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'stamp_datetime': datetime.datetime(2025, 7, 16, 5, 46, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'xml_file_size': 4838, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:25,086 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(16) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'series': None, 'folio': '012540015832846946', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 0, 8, 4), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 24, 494322), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 24, 494325), 'issuer_rfc': 'BBA******LJ2', 'issuer_name': 'BBVA MEXICO, S.A., INSTITUCION DE BANCA MULTIPLE, GRUPO FINANCIERO BBVA MEXICO', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('0'), 'subtotal': Decimal('0.010000'), 'total_discount': Decimal('0.010000'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('0.000000'), 'digital_stamp': 'VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[:10]***MASKED***VTAUTiebVLc+ucecg0BCd1+3V7+YC2m5qxwAuJVCZQ3FoRlOZUAgDegOTHx8C6ZwlmZjmIzSgjER1b1qc92hnikEIwvc35yTYvvu47tN8RqO/02Zu8O8p20mqMB521adDUVUdbYEh7tFLSDnrKS+E[-10:] ... (46 characters truncated) ... vKVUZwi6lhOLQRalJ4+1dHSayrOAC9t65uyGM7sp3LZnlSRVp2bB8uQRl7QBRMKB+72pDe46ovnRMoZyH1vhZtxVhLPffiIfWsu53F67UG9C5GuuQGW9BeCyCUVyJNiBZTwlWWJX2N5nseNoWbA==', 'certificate_number': '00001000000509478830', 'certificate': None, 'sat_seal': 'YY8ddVn3C615+iRMXrnaaHnI6S5XteXgZCuHwXVTCydxr8TSZwNhg36KMuPGv4k0E4jgEDGMehJ5qDGfqhlu1tt7Yign4pqRvKUrnt9MdwLLiVg5MMvOsg4SJqlNLquybsGtDydDIf2q51Vm7Evj5 ... (46 characters truncated) ... LmNxst5S6qB2jr6agF+7heNBgzHaLGQi8vGxBKMc8fi4Rz8b3Gbtro5k2dnNgBIz+wF8c3PuRJc6JPEecX50TP/AmqXzpzWAszR5qNvLrBee6tVydJuVNLc9QBLMqBweE8jp/kc5D3zThy6nv0g==', 'sat_certificate': None, 'fiscal_folio': '72B0960A-EDD1-4BEB-B9DA-461E1F893116', 'stamp_datetime': datetime.datetime(2025, 7, 16, 5, 46, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'xml_file_size': 4838, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:25,088 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml: Failed to save invoice to database
2025-07-19 14:45:25,860 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'details': '{"filename": "72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml", "processing_time": 2.5851399898529053, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5851399898529053, 'memory_usage': None, 'filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 25, 275578)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:25,861 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'details': '{"filename": "72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml", "processing_time": 2.5851399898529053, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.5851399898529053, 'memory_usage': None, 'filename': '72B0960A-EDD1-4BEB-B9DA-461E1F893116.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 25, 275578)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:40,634 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'series': None, 'folio': '51947', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 57, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 39, 993327), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 39, 993330), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1063.180000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('31.720000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1094.900000'), 'digital_stamp': 'ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[:10]***MASKED***ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[-10:] ... (46 characters truncated) ... svl4JqGr5qfTiM7l2o32lR0gFNMv2KNiq6cnPNaAiaSZQdvrIf271TeB6gp83M9oQS9EpxkNFqr0OvCbgThlhQ8dh5FtIDgyaA0vAvwPcbtc+KqquKN1/lwPchtC/ffh55o3ar6I8RAs9TST8AQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CjF0ytYBzw4YQ4xvIbLpJK/02beDv7gWBYn2x1Gy+X3KasW5G3ygdRBfiIg9whVAYViNENDjSWt/eciWg4ggUGKoOrp87jdimiC1ZJx0/M/8m2u7eI+BcE3K8UiiJ5j34ZR8T+lTy6/CKnuP7E/+q ... (46 characters truncated) ... X7W2kcac//52/9Yncf2QA7eQiaqDuh0Jf6lyLg/Me8ywOSTf7oNqYPb6UeYdqLPuAzt6Wjn5vBkGixBLQmQrhrwT09YwI6IAZHs0sqqxkPlvnP12NmwAh8f6xMDY+kTs9ZXkhKAr8Fcju4amvnQ==', 'sat_certificate': None, 'fiscal_folio': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 57, 31), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'xml_file_size': 9661, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:40,636 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(17) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'series': None, 'folio': '51947', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 57, 30), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 39, 993327), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 39, 993330), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1063.180000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('31.720000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1094.900000'), 'digital_stamp': 'ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[:10]***MASKED***ZJiR1mKJYpwQiYsBdysvl7GXneuH5rhh4ojUAwJ7x9M35Yazttq4XFALu/rJ10M06aeWBDxpL0yeIkT1qnoXz7mFXzvdafprqjbCF2tkYs+3O1ELwnNgN9QyVrNOQ/Ufz/r6nWmnmrCIBISG5b4Hj[-10:] ... (46 characters truncated) ... svl4JqGr5qfTiM7l2o32lR0gFNMv2KNiq6cnPNaAiaSZQdvrIf271TeB6gp83M9oQS9EpxkNFqr0OvCbgThlhQ8dh5FtIDgyaA0vAvwPcbtc+KqquKN1/lwPchtC/ffh55o3ar6I8RAs9TST8AQ==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'CjF0ytYBzw4YQ4xvIbLpJK/02beDv7gWBYn2x1Gy+X3KasW5G3ygdRBfiIg9whVAYViNENDjSWt/eciWg4ggUGKoOrp87jdimiC1ZJx0/M/8m2u7eI+BcE3K8UiiJ5j34ZR8T+lTy6/CKnuP7E/+q ... (46 characters truncated) ... X7W2kcac//52/9Yncf2QA7eQiaqDuh0Jf6lyLg/Me8ywOSTf7oNqYPb6UeYdqLPuAzt6Wjn5vBkGixBLQmQrhrwT09YwI6IAZHs0sqqxkPlvnP12NmwAh8f6xMDY+kTs9ZXkhKAr8Fcju4amvnQ==', 'sat_certificate': None, 'fiscal_folio': '7B1900C2-4AEF-4FCE-99B7-66FA98462557', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 57, 31), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'xml_file_size': 9661, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:40,638 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml: Failed to save invoice to database
2025-07-19 14:45:41,884 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'details': '{"filename": "7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml", "processing_time": 14.775121927261353, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 14.775121927261353, 'memory_usage': None, 'filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 40, 852101)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:41,885 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'details': '{"filename": "7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml", "processing_time": 14.775121927261353, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 14.775121927261353, 'memory_usage': None, 'filename': '7B1900C2-4AEF-4FCE-99B7-66FA98462557.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 40, 852101)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:45,677 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'series': None, 'folio': '51953', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 10, 17, 59), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 45, 87064), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 45, 87067), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3012.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3012.000000'), 'digital_stamp': 'I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[:10]***MASKED***I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[-10:] ... (46 characters truncated) ... W6254ZP+Jln31/46JIEITcQyaqb2QAJIC13oTUHqz2sn7uj+P3Gp+iUL1WR31hlwFOgjsjFTAPSVDxVtwGSsYsRIVKL7DfoXKf0yo88aopqTBazkM7WWmjFVPHazUy3EjVcHn/hAp8GyDyY67+g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'IA0LuN8ESSsldx/mrPnytSLLQj7Y9k64t5rKRn8vp3qOogrYyUV1AWMpZ+7TmLh8G7SPRHzQB78Zu5Y/epOBwQIGUh342rPB/8JiwtjNn3Ts3WuUy4SH5lq2HDW1r8prCzk/yr95bp2uIxg67Qe5D ... (46 characters truncated) ... omPHjnGQp6rQf8K345N0RMcFE6dGp+v9GgXU4vbhl19ntbNBpGdULDGsWTCl84Xq2zOnI8B/GcjSlr9I/2uKLQcNfDauwrYLcA+s8nCNv6VUJokis4x7b69cnv95tCM36rLBLfX83soKghAAEdA==', 'sat_certificate': None, 'fiscal_folio': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'stamp_datetime': datetime.datetime(2025, 7, 11, 11, 18), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'xml_file_size': 5362, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:45,679 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(18) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'series': None, 'folio': '51953', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 10, 17, 59), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 45, 87064), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 45, 87067), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3012.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3012.000000'), 'digital_stamp': 'I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[:10]***MASKED***I7rb2FChTf2aUpV+Ez22JjHCZsKpJDByHfyrn/0X90dbOQOCFIeXlLLaAcQHFQKSHS2Aw3yv0WKClyFHT6jxQSD4d8OKZbj7q4yZLbvoXq5g5vb9t+pIFYljb833szgttqulQf/Ho1eHwxv6pcho3[-10:] ... (46 characters truncated) ... W6254ZP+Jln31/46JIEITcQyaqb2QAJIC13oTUHqz2sn7uj+P3Gp+iUL1WR31hlwFOgjsjFTAPSVDxVtwGSsYsRIVKL7DfoXKf0yo88aopqTBazkM7WWmjFVPHazUy3EjVcHn/hAp8GyDyY67+g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'IA0LuN8ESSsldx/mrPnytSLLQj7Y9k64t5rKRn8vp3qOogrYyUV1AWMpZ+7TmLh8G7SPRHzQB78Zu5Y/epOBwQIGUh342rPB/8JiwtjNn3Ts3WuUy4SH5lq2HDW1r8prCzk/yr95bp2uIxg67Qe5D ... (46 characters truncated) ... omPHjnGQp6rQf8K345N0RMcFE6dGp+v9GgXU4vbhl19ntbNBpGdULDGsWTCl84Xq2zOnI8B/GcjSlr9I/2uKLQcNfDauwrYLcA+s8nCNv6VUJokis4x7b69cnv95tCM36rLBLfX83soKghAAEdA==', 'sat_certificate': None, 'fiscal_folio': '7C7ADAA8-D609-49EC-A136-064B76B76857', 'stamp_datetime': datetime.datetime(2025, 7, 11, 11, 18), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'xml_file_size': 5362, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:45,680 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7C7ADAA8-D609-49EC-A136-064B76B76857.xml: Failed to save invoice to database
2025-07-19 14:45:46,454 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'details': '{"filename": "7C7ADAA8-D609-49EC-A136-064B76B76857.xml", "processing_time": 3.7932941913604736, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.7932941913604736, 'memory_usage': None, 'filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 45, 861734)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:46,455 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'details': '{"filename": "7C7ADAA8-D609-49EC-A136-064B76B76857.xml", "processing_time": 3.7932941913604736, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.7932941913604736, 'memory_usage': None, 'filename': '7C7ADAA8-D609-49EC-A136-064B76B76857.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 45, 861734)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:50,960 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'series': None, 'folio': '52014', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 59, 20), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 50, 376879), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 50, 376882), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('261.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('261.000000'), 'digital_stamp': 'G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[:10]***MASKED***G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[-10:] ... (46 characters truncated) ... 2+ACWYOMvUC5obLOu3CdV+yvn7JvtSIvsZ4LNAHVLR0pj0NS00wqPAMNlyejo1WKyKlhso5YonRVAdbQRHuVI4RWeSW7KgZh4rNWUhgfkO//A4Khu7WIhC17aBLGZJfT8o5Jn5tA1R/5u5DzKCA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WuKCjGMjNryqj9spYRpB28VhACtB+TYM6g5PtkEZBc6i7Fi+4kaDcsxiGj7QJlo5auaeTeVY1qqzGvRKPUhZQfXaFjk3Z/EEZyl+HvSIvIPLNWkrazNtPgwzjp7rfewGkhBndIyC9lhXKCTfocc03 ... (46 characters truncated) ... X5k4nWT/KrRHwDNUe5jnBbAXCAs4NfRaW/dDjVai3kG9ojzk5CQDxlrfk99HWqOgKBxB8q2JOi+88q0yj8cSX0MCYR/e+l8GRnkAkQRh1ZkKVLnAoaF6iuK+XhPxqueDT9uF4nljvBj7IobUqsQ==', 'sat_certificate': None, 'fiscal_folio': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 59, 21), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'xml_file_size': 6884, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:50,962 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(19) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'series': None, 'folio': '52014', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 59, 20), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 50, 376879), 'updated_at': datetime.datetime(2025, 7, 19, 21, 45, 50, 376882), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('261.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('261.000000'), 'digital_stamp': 'G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[:10]***MASKED***G5d7C6pt5NEkRHvCGNzQw1wFOmQAOTun+A1YwHlBqLDiQlS4x81ApD3OASyr6mZOH7nyquQfbXXy5vt/27lsf2EmvSriPgDwfRqsNCHoPPUKnyYVx7AN2Bb165cfl7Sx5mMHM9GWB+g3wSUB9o9JI[-10:] ... (46 characters truncated) ... 2+ACWYOMvUC5obLOu3CdV+yvn7JvtSIvsZ4LNAHVLR0pj0NS00wqPAMNlyejo1WKyKlhso5YonRVAdbQRHuVI4RWeSW7KgZh4rNWUhgfkO//A4Khu7WIhC17aBLGZJfT8o5Jn5tA1R/5u5DzKCA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'WuKCjGMjNryqj9spYRpB28VhACtB+TYM6g5PtkEZBc6i7Fi+4kaDcsxiGj7QJlo5auaeTeVY1qqzGvRKPUhZQfXaFjk3Z/EEZyl+HvSIvIPLNWkrazNtPgwzjp7rfewGkhBndIyC9lhXKCTfocc03 ... (46 characters truncated) ... X5k4nWT/KrRHwDNUe5jnBbAXCAs4NfRaW/dDjVai3kG9ojzk5CQDxlrfk99HWqOgKBxB8q2JOi+88q0yj8cSX0MCYR/e+l8GRnkAkQRh1ZkKVLnAoaF6iuK+XhPxqueDT9uF4nljvBj7IobUqsQ==', 'sat_certificate': None, 'fiscal_folio': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 59, 21), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'xml_file_size': 6884, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:50,964 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml: Failed to save invoice to database
2025-07-19 14:45:51,771 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'details': '{"filename": "7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml", "processing_time": 4.506935119628906, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.506935119628906, 'memory_usage': None, 'filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 51, 162317)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:51,772 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'details': '{"filename": "7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml", "processing_time": 4.506935119628906, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.506935119628906, 'memory_usage': None, 'filename': '7D3FEAA7-7FC4-4467-B0D6-1104CB18336E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 51, 162317)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:53,362 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'details': '{"filename": "7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml", "processing_time": 0.806349515914917, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 7EC2C80D-447B-41D7-A5D7-64B42CFE6860 already exists"}', 'execution_time': 0.806349515914917, 'memory_usage': None, 'filename': '7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 52, 771673)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:53,363 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'details': '{"filename": "7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml", "processing_time": 0.806349515914917, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 7EC2C80D-447B-41D7-A5D7-64B42CFE6860 already exists"}', 'execution_time': 0.806349515914917, 'memory_usage': None, 'filename': '7EC2C80D-447B-41D7-A5D7-64B42CFE6860.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 52, 771673)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:54,931 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'details': '{"filename": "86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml", "processing_time": 0.7758879661560059, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6 already exists"}', 'execution_time': 0.7758879661560059, 'memory_usage': None, 'filename': '86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 54, 324163)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:45:54,932 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'details': '{"filename": "86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml", "processing_time": 0.7758879661560059, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6 already exists"}', 'execution_time': 0.7758879661560059, 'memory_usage': None, 'filename': '86BDC7C8-B9C2-4FB8-952C-40A975B0E4D6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 45, 54, 324163)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:04,221 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'series': None, 'folio': '52275', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 14, 18), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 3, 480822), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 3, 480825), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3138.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3138.200000'), 'digital_stamp': 'JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[:10]***MASKED***JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[-10:] ... (46 characters truncated) ... 60yEVtjwdAwTZrLiaNcaAft67dVl+XIBpiXEgwtCXcxphW3cZbZYpThwAzpC3S9ObSQ7rF3Pv1SxyFLE5pSohnuziFHlNDJ8RTIE/bSr/F3qwzuJsENncFCcOw+DZhRttCjZgNCDS8WfRK6Bldw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'h6DA6XLBQsUGGT+itnd+6ChhvF2FK3ZtnwCVDPBQ4/vs1AvKWt2ktiF4SBgS+dHlwbRxbZ1QNOOpDxQTYWrFIxUBojnYTAY/l8tUnb3NyzNgXOqPMIdLuOxkHQPA9CzUMEadRrIGtwGrxxahSCVyD ... (46 characters truncated) ... rK8mw2/E+PMRQ6Xk5LrI2OzxnHiT5/cyuB3YMuKjLc1Haw+sqXH5uWP+b1YF/quxTL2HIZ3gLeG71ReOnXi9kGEsN45zRZNqnVJdmNb1iZtpBQEDU0epRo8EAcrAnD1rnPINGgIcRpJ5firks1Q==', 'sat_certificate': None, 'fiscal_folio': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 14, 19), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'xml_file_size': 8765, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:04,222 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(20) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'series': None, 'folio': '52275', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 14, 18), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 3, 480822), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 3, 480825), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('3138.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('3138.200000'), 'digital_stamp': 'JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[:10]***MASKED***JtF2IynJJtKbMe6kMV3HQSKlGXU2+VaSb0dn1WCk4u/vm/L3sCjwa4MwGMjsb5r2Ibwgzg7xwPhcBeOQCsG3626h60mw9kMRTY7ZupWbOgHuumEpPKMfj+UHQWgUBPc4VuD6ya5U0CvHfXEAnJbA6[-10:] ... (46 characters truncated) ... 60yEVtjwdAwTZrLiaNcaAft67dVl+XIBpiXEgwtCXcxphW3cZbZYpThwAzpC3S9ObSQ7rF3Pv1SxyFLE5pSohnuziFHlNDJ8RTIE/bSr/F3qwzuJsENncFCcOw+DZhRttCjZgNCDS8WfRK6Bldw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'h6DA6XLBQsUGGT+itnd+6ChhvF2FK3ZtnwCVDPBQ4/vs1AvKWt2ktiF4SBgS+dHlwbRxbZ1QNOOpDxQTYWrFIxUBojnYTAY/l8tUnb3NyzNgXOqPMIdLuOxkHQPA9CzUMEadRrIGtwGrxxahSCVyD ... (46 characters truncated) ... rK8mw2/E+PMRQ6Xk5LrI2OzxnHiT5/cyuB3YMuKjLc1Haw+sqXH5uWP+b1YF/quxTL2HIZ3gLeG71ReOnXi9kGEsN45zRZNqnVJdmNb1iZtpBQEDU0epRo8EAcrAnD1rnPINGgIcRpJ5firks1Q==', 'sat_certificate': None, 'fiscal_folio': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 14, 19), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'xml_file_size': 8765, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:04,224 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml: Failed to save invoice to database
2025-07-19 14:46:05,270 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'details': '{"filename": "890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml", "processing_time": 9.289423942565918, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 9.289423942565918, 'memory_usage': None, 'filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 4, 509298)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:05,271 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'details': '{"filename": "890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml", "processing_time": 9.289423942565918, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 9.289423942565918, 'memory_usage': None, 'filename': '890A39E7-BAC2-4F94-B9C5-F511D2CCD259.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 4, 509298)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:12,144 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'series': None, 'folio': '52044', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 8, 50, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 11, 427876), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 11, 427879), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('109.380000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('109.380000'), 'digital_stamp': 'SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[:10]***MASKED***SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[-10:] ... (46 characters truncated) ... MfJr0ycOzaOntLYC7fqdFLbR0/IhbMXRre5/fEPC1H5hL/i/6oYsVBzp7Y1p6PoUhyxpQwnF9qCyvz/XBzwPQl6zBwPzkxyDUlPW/4dfIxtyXx3eqRufHbQhT9z/634GK9fBqf6YH1WQKmPgLkg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'H9SavebmCHIfU1/97lrmkbggBXHfxYasyiDJ8LzWpbMPfAWADJtJ+aBDsGeoTuWS/0tDpLM3ovvA9D7y/mc1MGVAG9YEEj571vi4oGjWw3+3S1kNtWnDRZzgLZ5kNbaHTCEj4Uf+UgY2ofMmYYeyL ... (46 characters truncated) ... M5Q75/moBKfVYKfAmQ49Gubw31wMexiLoIdzGXUCK0o6yCJ7RepZ8tWcEop84HqWrqxODdXcw2pXv9dQQB0ZZ6ghjW+PKielcctszhga4khRTCDalYTx/yrfEr27pkzWrvZ2R6wDQ7TtpAS0KNA==', 'sat_certificate': None, 'fiscal_folio': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'stamp_datetime': datetime.datetime(2025, 7, 13, 9, 50, 34), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'xml_file_size': 5737, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:12,146 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(21) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'series': None, 'folio': '52044', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 8, 50, 32), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 11, 427876), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 11, 427879), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('109.380000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('109.380000'), 'digital_stamp': 'SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[:10]***MASKED***SQ284977hUK2C/DF+Dg5BbHmU7bF6GHDia3TbBBygzTdwhbUx74pQw6SAl7YznkugN4O3ZDGJ7QAGgXZNrvf1ZPxeyt9EeQJMsMRcVHLtTcsmS12s5k7b/d4AMLVkXHu2ZeSC3BqkCSAOKyHfmSGL[-10:] ... (46 characters truncated) ... MfJr0ycOzaOntLYC7fqdFLbR0/IhbMXRre5/fEPC1H5hL/i/6oYsVBzp7Y1p6PoUhyxpQwnF9qCyvz/XBzwPQl6zBwPzkxyDUlPW/4dfIxtyXx3eqRufHbQhT9z/634GK9fBqf6YH1WQKmPgLkg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'H9SavebmCHIfU1/97lrmkbggBXHfxYasyiDJ8LzWpbMPfAWADJtJ+aBDsGeoTuWS/0tDpLM3ovvA9D7y/mc1MGVAG9YEEj571vi4oGjWw3+3S1kNtWnDRZzgLZ5kNbaHTCEj4Uf+UgY2ofMmYYeyL ... (46 characters truncated) ... M5Q75/moBKfVYKfAmQ49Gubw31wMexiLoIdzGXUCK0o6yCJ7RepZ8tWcEop84HqWrqxODdXcw2pXv9dQQB0ZZ6ghjW+PKielcctszhga4khRTCDalYTx/yrfEr27pkzWrvZ2R6wDQ7TtpAS0KNA==', 'sat_certificate': None, 'fiscal_folio': '89159A29-A821-4C4F-BD54-DCA2988FF3CD', 'stamp_datetime': datetime.datetime(2025, 7, 13, 9, 50, 34), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'xml_file_size': 5737, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:12,147 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml: Failed to save invoice to database
2025-07-19 14:46:12,988 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'details': '{"filename": "89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml", "processing_time": 6.874510288238525, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.874510288238525, 'memory_usage': None, 'filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 12, 353212)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:12,989 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'details': '{"filename": "89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml", "processing_time": 6.874510288238525, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.874510288238525, 'memory_usage': None, 'filename': '89159A29-A821-4C4F-BD54-DCA2988FF3CD.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 12, 353212)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:14,697 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'series': None, 'folio': '52281', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 14, 7, 38), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 14, 47642), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 14, 47645), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('163.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('163.200000'), 'digital_stamp': 'e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[:10]***MASKED***e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[-10:] ... (46 characters truncated) ... CKrdmJe7xZGjKk0P2UsG+6Zf9ardhKFbQ4o+LqasilLiEgmJMiqXQmxTmIOwv7p4EPkXZKOIQOAVUiVQ700xWdK9mTgcNW2pomcUAhxrgh0PnU0GfKE14W3zJv/gZ/4pnvP+mTr/JOe45lIdlDw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZtU/d9gaFDsoZPP837B5qfKCelTW7aNJzUAKMZfgZ2kBaTWT/aQl0q0gqGQ/HZ4Z4tJe+MzjUehK0o3basJ7LTdr+R5v5gRowVP1hm96amerwV1HRRa5dXBMhebTKtKno5xjNgEpR39Ya2yGIhz7i ... (46 characters truncated) ... H/pphRyJXacTC61Wpe4FFPCdt7sRONFvJdapIkUHfl7o1/0LADPQATrGFnRjlAscUB75xDRnquJeqbeRLSJxiKLO/eOyEFsfH5XWnqZThK7WvVINPDv/dpwrh8SO5TRzoApVWT329wfSRx9335Q==', 'sat_certificate': None, 'fiscal_folio': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'stamp_datetime': datetime.datetime(2025, 7, 18, 15, 7, 39), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'xml_file_size': 4979, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:14,698 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(22) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'series': None, 'folio': '52281', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 14, 7, 38), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 14, 47642), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 14, 47645), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('163.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('163.200000'), 'digital_stamp': 'e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[:10]***MASKED***e5VCl3MEIvpwNDGHPRKzf/Z6swCBUQTrmpEK5Yup1yWxPHE1Qk2OmDDgFcvYcZA8ptVgo5mQOl9VKiFWqseEUnmiVN83lGBwsxGTYP4go/FGWjA3A0dQ03kjEA9P8zh53RtcJob6ZMmnr+4oEnvjj[-10:] ... (46 characters truncated) ... CKrdmJe7xZGjKk0P2UsG+6Zf9ardhKFbQ4o+LqasilLiEgmJMiqXQmxTmIOwv7p4EPkXZKOIQOAVUiVQ700xWdK9mTgcNW2pomcUAhxrgh0PnU0GfKE14W3zJv/gZ/4pnvP+mTr/JOe45lIdlDw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'ZtU/d9gaFDsoZPP837B5qfKCelTW7aNJzUAKMZfgZ2kBaTWT/aQl0q0gqGQ/HZ4Z4tJe+MzjUehK0o3basJ7LTdr+R5v5gRowVP1hm96amerwV1HRRa5dXBMhebTKtKno5xjNgEpR39Ya2yGIhz7i ... (46 characters truncated) ... H/pphRyJXacTC61Wpe4FFPCdt7sRONFvJdapIkUHfl7o1/0LADPQATrGFnRjlAscUB75xDRnquJeqbeRLSJxiKLO/eOyEFsfH5XWnqZThK7WvVINPDv/dpwrh8SO5TRzoApVWT329wfSRx9335Q==', 'sat_certificate': None, 'fiscal_folio': '902249AE-87F3-4B59-BF33-8AD5F888DFC1', 'stamp_datetime': datetime.datetime(2025, 7, 18, 15, 7, 39), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'xml_file_size': 4979, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:14,700 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml: Failed to save invoice to database
2025-07-19 14:46:15,531 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'details': '{"filename": "902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml", "processing_time": 1.708543300628662, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.708543300628662, 'memory_usage': None, 'filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 14, 906241)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:15,532 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'details': '{"filename": "902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml", "processing_time": 1.708543300628662, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.708543300628662, 'memory_usage': None, 'filename': '902249AE-87F3-4B59-BF33-8AD5F888DFC1.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 14, 906241)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:19,521 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'series': None, 'folio': '52012', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 52, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 18, 878984), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 18, 878987), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('242.880000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('9.120000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('252.000000'), 'digital_stamp': 'gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[:10]***MASKED***gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[-10:] ... (46 characters truncated) ... VwAu/nayKPSJNzbZu7Gf3tlq0ox/j5qD7oQwOxGYC8y9vzkfZaizM1Q3n1ViGkI9z7ppGQVMbZDouNlBEuCZRYZmErD4AWlI0b8yBU1fis4NpTUpEkEcnhoEC81romCGvKYMuR7BVl/AX+l7H8A==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'dTccMvYzlKfBjQl2lh+gLHUlulpRI7iIyy9GG7+Rg61o+NFGQnLCekPKtrWLxYMvYfCWZocFhZ2lAeQkOZYqNOdzEMSsjFhBNv4dbsEbksL1cowkDXr45PsnA8XS5rRNC646U/Ggmu7rYYi+/E7bm ... (46 characters truncated) ... RvLu1CRy94JhZNe4usp26Ns1wRSwHYxPG+xkXvxjkSsfNIpI6qaYVeB2f1Vwgrm+VfagEVUY9dR9YkvVFfxMOPY8VDPR3kQpVtwjwW13n2Uq2En53xdQHEo2CfL0N2D50qRt5yDNqeTJk/r76DQ==', 'sat_certificate': None, 'fiscal_folio': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 52, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'xml_file_size': 5862, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:19,522 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(23) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'series': None, 'folio': '52012', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 52, 12), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 18, 878984), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 18, 878987), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('242.880000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('9.120000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('252.000000'), 'digital_stamp': 'gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[:10]***MASKED***gq+toB7G63ptGF/qp5MMPfKVinfmMHRVSeNNZlY/cBHVVxNEyqJqsCXL6Zn9XOO3U2QGusolgFmhZvB0IVdMNuVK68jLLDU+bYp3fNpMqzWIKqT5uJLG3VwNCRC45g2pMGqsrqJWm8qnxlD5SsyJa[-10:] ... (46 characters truncated) ... VwAu/nayKPSJNzbZu7Gf3tlq0ox/j5qD7oQwOxGYC8y9vzkfZaizM1Q3n1ViGkI9z7ppGQVMbZDouNlBEuCZRYZmErD4AWlI0b8yBU1fis4NpTUpEkEcnhoEC81romCGvKYMuR7BVl/AX+l7H8A==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'dTccMvYzlKfBjQl2lh+gLHUlulpRI7iIyy9GG7+Rg61o+NFGQnLCekPKtrWLxYMvYfCWZocFhZ2lAeQkOZYqNOdzEMSsjFhBNv4dbsEbksL1cowkDXr45PsnA8XS5rRNC646U/Ggmu7rYYi+/E7bm ... (46 characters truncated) ... RvLu1CRy94JhZNe4usp26Ns1wRSwHYxPG+xkXvxjkSsfNIpI6qaYVeB2f1Vwgrm+VfagEVUY9dR9YkvVFfxMOPY8VDPR3kQpVtwjwW13n2Uq2En53xdQHEo2CfL0N2D50qRt5yDNqeTJk/r76DQ==', 'sat_certificate': None, 'fiscal_folio': '91726F17-192C-440F-B346-C2D75CE9D8F5', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 52, 13), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'xml_file_size': 5862, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:19,524 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 91726F17-192C-440F-B346-C2D75CE9D8F5.xml: Failed to save invoice to database
2025-07-19 14:46:20,370 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'details': '{"filename": "91726F17-192C-440F-B346-C2D75CE9D8F5.xml", "processing_time": 3.9897871017456055, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.9897871017456055, 'memory_usage': None, 'filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 19, 727801)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:20,371 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'details': '{"filename": "91726F17-192C-440F-B346-C2D75CE9D8F5.xml", "processing_time": 3.9897871017456055, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.9897871017456055, 'memory_usage': None, 'filename': '91726F17-192C-440F-B346-C2D75CE9D8F5.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 19, 727801)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:22,089 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'details': '{"filename": "978d18b7-b0c4-420d-9529-6c3eb2cac218.xml", "processing_time": 0.8715248107910156, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 978d18b7-b0c4-420d-9529-6c3eb2cac218 already exists"}', 'execution_time': 0.8715248107910156, 'memory_usage': None, 'filename': '978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 21, 453351)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:22,090 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'details': '{"filename": "978d18b7-b0c4-420d-9529-6c3eb2cac218.xml", "processing_time": 0.8715248107910156, "item_count": 0, "success": false, "error": "DUPLICATE: UUID 978d18b7-b0c4-420d-9529-6c3eb2cac218 already exists"}', 'execution_time': 0.8715248107910156, 'memory_usage': None, 'filename': '978d18b7-b0c4-420d-9529-6c3eb2cac218.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 21, 453351)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:32,163 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'series': None, 'folio': '52013', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 58, 3), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 31, 563172), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 31, 563174), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1161.560000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1161.560000'), 'digital_stamp': 'eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[:10]***MASKED***eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[-10:] ... (46 characters truncated) ... GXr/JXM+M2F8kEDw0vkyNg+QJDL6fmWHXRtZQOYhfwO2zl2CN/w2zulKTjVLyH6ZY80+zrOSS8nz6IS7yNNldcH6TDgnQDxOF1XZmkoid4AC0WlHy9MRXRFQGGspYN7CXHmhFI76st2mWf4Pw8g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'BXwFOlIe4jWApHegUiUNupFX8guKtCkFPnQKuhiDZqOzUn7iJjD+bw67KVHuDg29419PScHapzGhYk50P+tjmb51pqjKOgsgkGJdeCBsBdORM7aaP6XV62g2rcSiU6vLrPmzuqarZlfJvWRO6Ujxu ... (46 characters truncated) ... MFkd6Ncmx/DY63ZzdpJcfyxYHVDP505OqEbg8I0Vg1EPYpxDfEcdsgHvlBrQGBtXRIe3sEQubXIhvK13sIgGPCOkkxvQnHz36UeTCvpOXBSWaSia5vt6smhurjx6JVH0JkmKaHCr4bUy4fsV28g==', 'sat_certificate': None, 'fiscal_folio': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 58, 4), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'xml_file_size': 9502, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:32,164 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(24) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'series': None, 'folio': '52013', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 58, 3), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 31, 563172), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 31, 563174), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1161.560000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1161.560000'), 'digital_stamp': 'eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[:10]***MASKED***eSyi3/yFy5pdZZS9IfrIovy1d1xdJ9Zb3YpgSVn9Jsw/2HQVQoTmonODUkSzvUwo3J2ETc1l+kKBPHwmODH3IcIZMQ2oqocJISysjpFuuQJyh25znjnqpsaBBoPKlei5GSLOl9foAMwGRtmzRdn/g[-10:] ... (46 characters truncated) ... GXr/JXM+M2F8kEDw0vkyNg+QJDL6fmWHXRtZQOYhfwO2zl2CN/w2zulKTjVLyH6ZY80+zrOSS8nz6IS7yNNldcH6TDgnQDxOF1XZmkoid4AC0WlHy9MRXRFQGGspYN7CXHmhFI76st2mWf4Pw8g==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'BXwFOlIe4jWApHegUiUNupFX8guKtCkFPnQKuhiDZqOzUn7iJjD+bw67KVHuDg29419PScHapzGhYk50P+tjmb51pqjKOgsgkGJdeCBsBdORM7aaP6XV62g2rcSiU6vLrPmzuqarZlfJvWRO6Ujxu ... (46 characters truncated) ... MFkd6Ncmx/DY63ZzdpJcfyxYHVDP505OqEbg8I0Vg1EPYpxDfEcdsgHvlBrQGBtXRIe3sEQubXIhvK13sIgGPCOkkxvQnHz36UeTCvpOXBSWaSia5vt6smhurjx6JVH0JkmKaHCr4bUy4fsV28g==', 'sat_certificate': None, 'fiscal_folio': '9C9D1343-FB84-4382-9F9C-81DC34C317CE', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 58, 4), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'xml_file_size': 9502, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:32,166 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml: Failed to save invoice to database
2025-07-19 14:46:32,961 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'details': '{"filename": "9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml", "processing_time": 10.07380223274231, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 10.07380223274231, 'memory_usage': None, 'filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 32, 356037)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:32,962 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'details': '{"filename": "9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml", "processing_time": 10.07380223274231, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 10.07380223274231, 'memory_usage': None, 'filename': '9C9D1343-FB84-4382-9F9C-81DC34C317CE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 32, 356037)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:38,775 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'series': None, 'folio': '52123', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 13, 26), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 38, 131947), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 38, 131950), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('468.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('75.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('543.990000'), 'digital_stamp': 'bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[:10]***MASKED***bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[-10:] ... (46 characters truncated) ... uPLImTofyDHIhR0Pn/U8TYfHzwq+ws56BI02Sg5t8w7wsiPo1X4kY72vsG+kF2ru+L3KfgO658alO5i4hlyiqFlonp87Go1+1lSF+IhgCOg/UNyPvZJ3fJyzlsCcl2Y8/nSMxzgwQZrkqpmSzsg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'QNrrWbSpBVgvlpJ/H1S80LpmsRtxhxSBHz5IB/x8lnpidM8ViyBU/2iYDl3FvwVPwGbakBuIn1NS9LDY00IUGRkcOAM0koKJgwapvWf4ww6/OCGbq7irGDQtyUJMUd1BaARMBfLSC5AN90EqqoMJ1 ... (46 characters truncated) ... vt9dVZEHi9yuXsvFvYhZEO//y+aZJPyngmwQ+y/Jf4NpMRtUqhi1cOy4CcC3T+iaMIbna0j4aiptj7G2iHsg9l5KTMf9Tu5SCXpQLU+6AShk9wlNPiC7rmhikWEyuuJZzOwk7EK2capbtTatziQ==', 'sat_certificate': None, 'fiscal_folio': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 13, 27), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'xml_file_size': 5787, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:38,777 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(25) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'series': None, 'folio': '52123', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 13, 26), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 38, 131947), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 38, 131950), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('468.960000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('75.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('543.990000'), 'digital_stamp': 'bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[:10]***MASKED***bnY0Lq/UBu2qJ7LkgH4MLdJ7EQWVRStUJhTqk20SZrSJqfr+OhnwnIxnbBGcaNSQouQlyUn6MO2rlBOM1wUhBnEEmtn2AeoiTjYWk3jbi1Ha2U+Eo5TAp0aio6SpsY3us/auX6b2cG96SP0DiONEp[-10:] ... (46 characters truncated) ... uPLImTofyDHIhR0Pn/U8TYfHzwq+ws56BI02Sg5t8w7wsiPo1X4kY72vsG+kF2ru+L3KfgO658alO5i4hlyiqFlonp87Go1+1lSF+IhgCOg/UNyPvZJ3fJyzlsCcl2Y8/nSMxzgwQZrkqpmSzsg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'QNrrWbSpBVgvlpJ/H1S80LpmsRtxhxSBHz5IB/x8lnpidM8ViyBU/2iYDl3FvwVPwGbakBuIn1NS9LDY00IUGRkcOAM0koKJgwapvWf4ww6/OCGbq7irGDQtyUJMUd1BaARMBfLSC5AN90EqqoMJ1 ... (46 characters truncated) ... vt9dVZEHi9yuXsvFvYhZEO//y+aZJPyngmwQ+y/Jf4NpMRtUqhi1cOy4CcC3T+iaMIbna0j4aiptj7G2iHsg9l5KTMf9Tu5SCXpQLU+6AShk9wlNPiC7rmhikWEyuuJZzOwk7EK2capbtTatziQ==', 'sat_certificate': None, 'fiscal_folio': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 13, 27), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'xml_file_size': 5787, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:38,778 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml: Failed to save invoice to database
2025-07-19 14:46:39,575 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'details': '{"filename": "9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml", "processing_time": 5.813813209533691, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 5.813813209533691, 'memory_usage': None, 'filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 38, 967694)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:39,576 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process 9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'details': '{"filename": "9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml", "processing_time": 5.813813209533691, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 5.813813209533691, 'memory_usage': None, 'filename': '9D0B44EB-855E-44F2-BBF7-8D6D00815E62.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 38, 967694)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:43,262 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'series': None, 'folio': '51948', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 58, 1), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 42, 637868), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 42, 637872), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('189.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('189.000000'), 'digital_stamp': 'M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[:10]***MASKED***M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[-10:] ... (46 characters truncated) ... q4kbt1HC6I8reGPsNE7XRtWGIlFxI+e+XlobsY0q5f0jUjUT5nFgbkRY6aHzO3/6NpLsUNk3PWLZX9BReLfzRz+GD43kXkz6L/vD9aftcbIw3fA6TT+iz7lJQdTNoI49e1eOZcpBy8/ze8uBkbA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'HsDEFchuSNrTOT8mjInqTIokbfeg8FGZ9ZqdFfspO6sS4Ni1N9QvgZL6dwdcQqU6kLUVsnj117kPX9pIjPs9NwUFgtjtQrKOL/gfws7frnh6w5zDVAOfFJ1cFLdlAGMkeKzPNmYgGjxFrorr0ARzb ... (46 characters truncated) ... SQ+mF+5cYZhB2fkceduIPv3rYWUrjBGXVzcgEAtMYDCoO2LZKNFlailMlQCWDrm+wiwrcoFJ8WnLpAQtVkDaFbK8/3f7wa7MyvS0c+PWPjjb1pwQkeZiUB/M5szIG/nI0st03hFDth9IJUzJyug==', 'sat_certificate': None, 'fiscal_folio': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 58, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'xml_file_size': 6490, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:43,264 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(26) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'series': None, 'folio': '51948', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 11, 9, 58, 1), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 42, 637868), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 42, 637872), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('189.000000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('189.000000'), 'digital_stamp': 'M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[:10]***MASKED***M7stS8NgC/JUoZ+9RN5WbrF7cFF/Dk44QbAkFRRV/Uadmu4Ta3fDu1B9fHO/4zhwsow/sTosWow9y7bBEtsRL+MFyxEksR08klbbASIs3KcxIc8Y2AJ0qKPgXqa2IlIbEn4F/LFDOm8F/CnhVfk1U[-10:] ... (46 characters truncated) ... q4kbt1HC6I8reGPsNE7XRtWGIlFxI+e+XlobsY0q5f0jUjUT5nFgbkRY6aHzO3/6NpLsUNk3PWLZX9BReLfzRz+GD43kXkz6L/vD9aftcbIw3fA6TT+iz7lJQdTNoI49e1eOZcpBy8/ze8uBkbA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'HsDEFchuSNrTOT8mjInqTIokbfeg8FGZ9ZqdFfspO6sS4Ni1N9QvgZL6dwdcQqU6kLUVsnj117kPX9pIjPs9NwUFgtjtQrKOL/gfws7frnh6w5zDVAOfFJ1cFLdlAGMkeKzPNmYgGjxFrorr0ARzb ... (46 characters truncated) ... SQ+mF+5cYZhB2fkceduIPv3rYWUrjBGXVzcgEAtMYDCoO2LZKNFlailMlQCWDrm+wiwrcoFJ8WnLpAQtVkDaFbK8/3f7wa7MyvS0c+PWPjjb1pwQkeZiUB/M5szIG/nI0st03hFDth9IJUzJyug==', 'sat_certificate': None, 'fiscal_folio': 'A2176A66-1047-4B31-B9D7-46930A70BB71', 'stamp_datetime': datetime.datetime(2025, 7, 11, 10, 58, 2), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'xml_file_size': 6490, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:43,265 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process A2176A66-1047-4B31-B9D7-46930A70BB71.xml: Failed to save invoice to database
2025-07-19 14:46:44,097 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'details': '{"filename": "A2176A66-1047-4B31-B9D7-46930A70BB71.xml", "processing_time": 3.6877505779266357, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.6877505779266357, 'memory_usage': None, 'filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 43, 470992)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:44,098 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'details': '{"filename": "A2176A66-1047-4B31-B9D7-46930A70BB71.xml", "processing_time": 3.6877505779266357, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.6877505779266357, 'memory_usage': None, 'filename': 'A2176A66-1047-4B31-B9D7-46930A70BB71.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 43, 470992)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:48,991 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'series': 'B', 'folio': '120734893', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 20, 45), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 48, 358785), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 48, 358787), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('763.780000'), 'total_discount': Decimal('157.920000'), 'total_transferred_taxes': Decimal('96.930000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('702.790000'), 'digital_stamp': 'TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[:10]***MASKED***TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[-10:] ... (46 characters truncated) ... gYDBzhaGv6XsXSyLUKJomBlcLycVpWPotn14TUQeyolnwTceXiKF1c9DzJdM3WStPzjj4mTrqI6Gm9nbxAZsMcP1iWsrxOVw8sVfKDMF/VqqGoB1MkcD9QGON8tXY8VGYBeMsDsiblvgRCTZSAw==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'Dm2TiMEfHoq4sN+G35WGpGRW2k4cKdbAyH9K7GSnXxTTKPVPpmUVSRrPnP1IJMLsAJ2225CrUQv5rNTdUb5mg1pthcMDwS/uvjZCEK+cxuNwGRk/dBlMj0xptSDmQRdEGYWWOs2D82clKLVTxc6nP ... (46 characters truncated) ... UjSvdYQGln2UUu5I3pCBEvq5oLnOsF5SANYQqg0vfbnJh3kEl6G+wo3z2kzLkaO1tsIfZeOZhx2ipX1P4eYGMcvO01VsYp0ItKnccpKCjwI3Do4HieSULXnQ+WHT576/Vo+xMwi7cSXhm58OASA==', 'sat_certificate': None, 'fiscal_folio': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 45, 1), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'xml_file_size': 6164, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:48,992 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(27) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'series': 'B', 'folio': '120734893', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 10, 20, 45), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 48, 358785), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 48, 358787), 'issuer_rfc': 'CCM******UU1', 'issuer_name': 'CERVEZAS CUAUHTEMOC MOCTEZUMA', 'issuer_fiscal_regime': '601', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '01', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('763.780000'), 'total_discount': Decimal('157.920000'), 'total_transferred_taxes': Decimal('96.930000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('702.790000'), 'digital_stamp': 'TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[:10]***MASKED***TVOBbTI/U11w0oK40MV3OwCPG8MJPvkBinU97qVuEy91YHnXI53X2NUz16ZO5hU76PPCx03aXm4dht549Sw5sXbGNtLhu0iIs3zPJ8h2xM62/5/Yh5dEfK5TtDis+LAvzNSWDMhabl5FpmHmOTVii[-10:] ... (46 characters truncated) ... gYDBzhaGv6XsXSyLUKJomBlcLycVpWPotn14TUQeyolnwTceXiKF1c9DzJdM3WStPzjj4mTrqI6Gm9nbxAZsMcP1iWsrxOVw8sVfKDMF/VqqGoB1MkcD9QGON8tXY8VGYBeMsDsiblvgRCTZSAw==', 'certificate_number': '00001000000709590036', 'certificate': None, 'sat_seal': 'Dm2TiMEfHoq4sN+G35WGpGRW2k4cKdbAyH9K7GSnXxTTKPVPpmUVSRrPnP1IJMLsAJ2225CrUQv5rNTdUb5mg1pthcMDwS/uvjZCEK+cxuNwGRk/dBlMj0xptSDmQRdEGYWWOs2D82clKLVTxc6nP ... (46 characters truncated) ... UjSvdYQGln2UUu5I3pCBEvq5oLnOsF5SANYQqg0vfbnJh3kEl6G+wo3z2kzLkaO1tsIfZeOZhx2ipX1P4eYGMcvO01VsYp0ItKnccpKCjwI3Do4HieSULXnQ+WHT576/Vo+xMwi7cSXhm58OASA==', 'sat_certificate': None, 'fiscal_folio': 'AE64C43A-6733-4033-A3B7-18926E1210E7', 'stamp_datetime': datetime.datetime(2025, 7, 10, 21, 45, 1), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'xml_file_size': 6164, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:48,994 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process AE64C43A-6733-4033-A3B7-18926E1210E7.xml: Failed to save invoice to database
2025-07-19 14:46:49,825 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'details': '{"filename": "AE64C43A-6733-4033-A3B7-18926E1210E7.xml", "processing_time": 4.89403223991394, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.89403223991394, 'memory_usage': None, 'filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 49, 192767)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:49,826 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'details': '{"filename": "AE64C43A-6733-4033-A3B7-18926E1210E7.xml", "processing_time": 4.89403223991394, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.89403223991394, 'memory_usage': None, 'filename': 'AE64C43A-6733-4033-A3B7-18926E1210E7.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 49, 192767)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:53,615 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'series': None, 'folio': '52186', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 52, 981405), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 52, 981407), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1298.820000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1298.820000'), 'digital_stamp': 'fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[:10]***MASKED***fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[-10:] ... (46 characters truncated) ... d55GvEOk1N4ja85crGISWLczobZfciP3r/LnEs1+XHWAAWdB85LDms0wkdBxkdO0+3oBNUFPp01Bun760LIQOCcNVsSXGYC2V5dGa5p66ZfLNNBjL7Q3sT63Fng0Xq44fHhYME6njqkY5Laguxw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'lLhkkLQxANilHuVth2NFoQmCEVzA4vpxyE8bzqhEHQqL3eraltIatqu/30vzKD/P76vETZm/jpq+oFjNRL1DPbp3UEqZUdAwXnX+uqqJa86h+O+KrcuHKQMSCJydGajaAanbeAtz8H1KffCB+53G+ ... (46 characters truncated) ... hdP4bHpukDDb1v/Oap6M1PcwX9AI6rRqKuvNqfHCR2xhqayxahaSnvnzeqHhrFGClJLG8ouETK0FFQAU6rsd/drPQ80HUS0+ieY8C8+gL81kjp6WUQkpohfVk7M7+3hs6TpuEnNiV4CS7ka1LWg==', 'sat_certificate': None, 'fiscal_folio': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'xml_file_size': 9151, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:53,617 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(28) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'series': None, 'folio': '52186', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 16, 15, 50, 58), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 52, 981405), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 52, 981407), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '28', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1298.820000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1298.820000'), 'digital_stamp': 'fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[:10]***MASKED***fOFYe19CCmwvllREn02QlCxTxNF66868r0foU97Ioo4fGPg2Lm5eP7eCr6hsrm4hb/Gjoo0rjRQIpz66TTDsfAkAzbkbRALdXDIVWNvmPGciwIPaocdHHy8FWf0LfZFwFxs3emwBrX3NEImtj/uil[-10:] ... (46 characters truncated) ... d55GvEOk1N4ja85crGISWLczobZfciP3r/LnEs1+XHWAAWdB85LDms0wkdBxkdO0+3oBNUFPp01Bun760LIQOCcNVsSXGYC2V5dGa5p66ZfLNNBjL7Q3sT63Fng0Xq44fHhYME6njqkY5Laguxw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'lLhkkLQxANilHuVth2NFoQmCEVzA4vpxyE8bzqhEHQqL3eraltIatqu/30vzKD/P76vETZm/jpq+oFjNRL1DPbp3UEqZUdAwXnX+uqqJa86h+O+KrcuHKQMSCJydGajaAanbeAtz8H1KffCB+53G+ ... (46 characters truncated) ... hdP4bHpukDDb1v/Oap6M1PcwX9AI6rRqKuvNqfHCR2xhqayxahaSnvnzeqHhrFGClJLG8ouETK0FFQAU6rsd/drPQ80HUS0+ieY8C8+gL81kjp6WUQkpohfVk7M7+3hs6TpuEnNiV4CS7ka1LWg==', 'sat_certificate': None, 'fiscal_folio': 'B49EEC1E-7D05-4096-918C-0969423EB0C6', 'stamp_datetime': datetime.datetime(2025, 7, 16, 16, 50, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'xml_file_size': 9151, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:53,618 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B49EEC1E-7D05-4096-918C-0969423EB0C6.xml: Failed to save invoice to database
2025-07-19 14:46:54,442 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'details': '{"filename": "B49EEC1E-7D05-4096-918C-0969423EB0C6.xml", "processing_time": 3.7902486324310303, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.7902486324310303, 'memory_usage': None, 'filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 53, 824347)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:54,443 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'details': '{"filename": "B49EEC1E-7D05-4096-918C-0969423EB0C6.xml", "processing_time": 3.7902486324310303, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 3.7902486324310303, 'memory_usage': None, 'filename': 'B49EEC1E-7D05-4096-918C-0969423EB0C6.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 53, 824347)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:56,093 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(37) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'details': '{"filename": "B696B7FF-E66C-46CF-A45D-D819C44431A3.xml", "processing_time": 0.842052698135376, "item_count": 0, "success": false, "error": "DUPLICATE: UUID B696B7FF-E66C-46CF-A45D-D819C44431A3 already exists"}', 'execution_time': 0.842052698135376, 'memory_usage': None, 'filename': 'B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 55, 487035)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:56,094 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(37) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'details': '{"filename": "B696B7FF-E66C-46CF-A45D-D819C44431A3.xml", "processing_time": 0.842052698135376, "item_count": 0, "success": false, "error": "DUPLICATE: UUID B696B7FF-E66C-46CF-A45D-D819C44431A3 already exists"}', 'execution_time': 0.842052698135376, 'memory_usage': None, 'filename': 'B696B7FF-E66C-46CF-A45D-D819C44431A3.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 55, 487035)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:58,953 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'series': None, 'folio': '52276', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 15, 9), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 58, 317163), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 58, 317166), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('126.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('126.200000'), 'digital_stamp': 'QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[:10]***MASKED***QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[-10:] ... (46 characters truncated) ... 9OBxoARV9UOwuuIluhsdCghci3A7UFkcvmqIrCycRrCoGPXz1DQoL4KrXaV92JJ5zzZ/Y4dhOZNZ2tzv0wZiSzgBghFcRTRPlQR+stheXmdcfoWugctW+LB2OWJd1V2xPX/5f5FxeKhlvSJWaUg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'JE84V/hN1QmEfBvvEoFl3mP7MJSrHQvcvc0dQmikBSIxXdzUVmbV6U3oI0aZrujiqPhMPAdwHaZGFz5XH77/fpdr00SxMmmMUa9AnE9D0PR90IMIUBhGNOEMgm+F9UE7UuKfFZPr2TLE9Ih7sremo ... (46 characters truncated) ... DGa1jGznmkijxCfPeoiBaB63wwjnU6KLVHbeJfZPZD+Zfm/iqPWG6wB3ZIkSvPR1cD+b/xtnjHyCJUlEK+rYWLYOSB31chmADdj27BDzVwlfinZPmFsl3+ft4kyz4lio0g53vhDtrIqhHhi0nuA==', 'sat_certificate': None, 'fiscal_folio': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 15, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'xml_file_size': 6101, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:58,955 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(29) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'series': None, 'folio': '52276', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 15, 9), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 58, 317163), 'updated_at': datetime.datetime(2025, 7, 19, 21, 46, 58, 317166), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('126.200000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('126.200000'), 'digital_stamp': 'QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[:10]***MASKED***QkOT6AH6wGUzoLLMpZ7p5BENteWxgubolI35GAgR+SVz6pGZTixQ6/QpUoA0YoV+JGIj0ziP94OEO3UchYgH7eaCaDNx3i1QiniQMzGpH7WBROwH7QMqeJk19PfAXiK2WSwWmcJY4zurP3jHBUwxM[-10:] ... (46 characters truncated) ... 9OBxoARV9UOwuuIluhsdCghci3A7UFkcvmqIrCycRrCoGPXz1DQoL4KrXaV92JJ5zzZ/Y4dhOZNZ2tzv0wZiSzgBghFcRTRPlQR+stheXmdcfoWugctW+LB2OWJd1V2xPX/5f5FxeKhlvSJWaUg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'JE84V/hN1QmEfBvvEoFl3mP7MJSrHQvcvc0dQmikBSIxXdzUVmbV6U3oI0aZrujiqPhMPAdwHaZGFz5XH77/fpdr00SxMmmMUa9AnE9D0PR90IMIUBhGNOEMgm+F9UE7UuKfFZPr2TLE9Ih7sremo ... (46 characters truncated) ... DGa1jGznmkijxCfPeoiBaB63wwjnU6KLVHbeJfZPZD+Zfm/iqPWG6wB3ZIkSvPR1cD+b/xtnjHyCJUlEK+rYWLYOSB31chmADdj27BDzVwlfinZPmFsl3+ft4kyz4lio0g53vhDtrIqhHhi0nuA==', 'sat_certificate': None, 'fiscal_folio': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 15, 11), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'xml_file_size': 6101, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:58,956 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml: Failed to save invoice to database
2025-07-19 14:46:59,802 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(38) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'details': '{"filename": "B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml", "processing_time": 2.8607585430145264, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.8607585430145264, 'memory_usage': None, 'filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 59, 162151)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:46:59,803 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(38) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'details': '{"filename": "B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml", "processing_time": 2.8607585430145264, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.8607585430145264, 'memory_usage': None, 'filename': 'B7A7B0CE-5ACA-42E7-AFF4-570ABAC3BC54.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 46, 59, 162151)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:06,617 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'series': None, 'folio': '52015', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 0, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 5, 991865), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 5, 991867), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('358.330000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('7.170000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('365.500000'), 'digital_stamp': 'Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[:10]***MASKED***Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[-10:] ... (46 characters truncated) ... 74s62OKvM5FdxLfo13KQ2o5rny+5aE6UI2oAOM7txqfOIzcg5BKuRjdtfbwEgzvsOdR2DIeUATeL/ZJ6jhnQQLGmwme5tklegIBDKGiUUVHEbqn04z/r9iom8MxEAIaBVT4MqViTAxZoV3wQ0yg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'MmVxeJlWCNV91IBkiq5F8WWcEMW42NI8mIJ2gvfiBaj17zSB+aJXT74sSsC7pKTW9LwNSfhOyxpHLik94ZGcp3SKP4YyikLGkhMaEY9vBE0pr2DiCGcAYK1x61ANLb5SFI5D6Ggr/6V393NW3/KXT ... (46 characters truncated) ... Oi4eTmd+q91gvVTh7Z1IMuZzrOina/dG0o/EnHJCsxswOk2sVUFCWS03oVM5wZzct9jZvNrzim5Co1tlHlJbDOQc/YVj9GJWnXa3J5v0bjdiiOBzaxXeYXuFDsqJH8KX8KhzdfRwvWFHKnLCFYQ==', 'sat_certificate': None, 'fiscal_folio': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 0, 6), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'xml_file_size': 7351, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:06,619 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(30) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'series': None, 'folio': '52015', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 12, 0, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 5, 991865), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 5, 991867), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('358.330000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('7.170000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('365.500000'), 'digital_stamp': 'Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[:10]***MASKED***Yh7adzoLmJwMBqJ+Slp5EF2Inv9i/nPld/3zUhWN/0oLBxvn0Ez+7lHWaCfLwdq1ScJZSlFUybybD0uRBk840U2j1qEwWg9feihZEgzRThphqRYPOI9wDK3Ke+kOX2XuZaW+uooGKzpc8SzeJHDkX[-10:] ... (46 characters truncated) ... 74s62OKvM5FdxLfo13KQ2o5rny+5aE6UI2oAOM7txqfOIzcg5BKuRjdtfbwEgzvsOdR2DIeUATeL/ZJ6jhnQQLGmwme5tklegIBDKGiUUVHEbqn04z/r9iom8MxEAIaBVT4MqViTAxZoV3wQ0yg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'MmVxeJlWCNV91IBkiq5F8WWcEMW42NI8mIJ2gvfiBaj17zSB+aJXT74sSsC7pKTW9LwNSfhOyxpHLik94ZGcp3SKP4YyikLGkhMaEY9vBE0pr2DiCGcAYK1x61ANLb5SFI5D6Ggr/6V393NW3/KXT ... (46 characters truncated) ... Oi4eTmd+q91gvVTh7Z1IMuZzrOina/dG0o/EnHJCsxswOk2sVUFCWS03oVM5wZzct9jZvNrzim5Co1tlHlJbDOQc/YVj9GJWnXa3J5v0bjdiiOBzaxXeYXuFDsqJH8KX8KhzdfRwvWFHKnLCFYQ==', 'sat_certificate': None, 'fiscal_folio': 'B8A1090C-497D-43EE-B109-CC42BF5CC627', 'stamp_datetime': datetime.datetime(2025, 7, 12, 13, 0, 6), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'xml_file_size': 7351, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:06,621 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B8A1090C-497D-43EE-B109-CC42BF5CC627.xml: Failed to save invoice to database
2025-07-19 14:47:07,438 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(39) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'details': '{"filename": "B8A1090C-497D-43EE-B109-CC42BF5CC627.xml", "processing_time": 6.816276550292969, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.816276550292969, 'memory_usage': None, 'filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 6, 812789)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:07,439 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(39) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'details': '{"filename": "B8A1090C-497D-43EE-B109-CC42BF5CC627.xml", "processing_time": 6.816276550292969, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.816276550292969, 'memory_usage': None, 'filename': 'B8A1090C-497D-43EE-B109-CC42BF5CC627.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 6, 812789)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:10,141 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'series': None, 'folio': '52121', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 6, 57), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 9, 522713), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 9, 522717), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('233.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('233.500000'), 'digital_stamp': 'GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[:10]***MASKED***GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[-10:] ... (46 characters truncated) ... NWauWmeETJKBI9Rww6O4b7iIvrMOPD1nR59TIqKPdGU3rpPUBspyius8on+KwzZyWliF4qp8Ef3RC+CYGJc2HeLAB/kCoJz7IW4vwYCSDcsWPcjjGeVLJDs7qMJ3Lyx2HuUTtdtPSSIl9XvzCNg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mFfQWP5GPGORG3IIxE9ChCUSA8PJ7PXmpkc5JIb0o/SeEd1PTfEzpT3nKo4se2v02U8t5/0oSloabruEJeUaMA6KVbxbqmDosZlXGaCQ8GY+Xk6aTpOEM60PaYXx/UyHZXFTb0J37BLnjM8TL0+W2 ... (46 characters truncated) ... O5By9F0ffS+eIhg7Cxb/TZiZMxTUmU5TiI2svqRFP19pKAz2PWWROFiiTB71j0yVZcm5Pz9Q8G26RigByU2lsGkd44LEFQwSxwU28NVgimmIZBOvj6VwyL9RIS+Aa4hPrUyispTiNthHoUfXYtg==', 'sat_certificate': None, 'fiscal_folio': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 6, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'xml_file_size': 5357, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:10,142 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(31) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'series': None, 'folio': '52121', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 6, 57), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 9, 522713), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 9, 522717), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('233.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('233.500000'), 'digital_stamp': 'GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[:10]***MASKED***GfP0693s/31O0IAFEAIpAXpcUh9Zm7CeE5udZxrx/VFvYAFgoliVXbMTcctfwJu8Ewh+nw/77hbraDJ411UpfE9BhoiGQZSyqHyv1QbkQNYGwTpVSd+fSa/f5afNw4pW6J4vH+nzQrWg7g7HC0f/S[-10:] ... (46 characters truncated) ... NWauWmeETJKBI9Rww6O4b7iIvrMOPD1nR59TIqKPdGU3rpPUBspyius8on+KwzZyWliF4qp8Ef3RC+CYGJc2HeLAB/kCoJz7IW4vwYCSDcsWPcjjGeVLJDs7qMJ3Lyx2HuUTtdtPSSIl9XvzCNg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mFfQWP5GPGORG3IIxE9ChCUSA8PJ7PXmpkc5JIb0o/SeEd1PTfEzpT3nKo4se2v02U8t5/0oSloabruEJeUaMA6KVbxbqmDosZlXGaCQ8GY+Xk6aTpOEM60PaYXx/UyHZXFTb0J37BLnjM8TL0+W2 ... (46 characters truncated) ... O5By9F0ffS+eIhg7Cxb/TZiZMxTUmU5TiI2svqRFP19pKAz2PWWROFiiTB71j0yVZcm5Pz9Q8G26RigByU2lsGkd44LEFQwSxwU28NVgimmIZBOvj6VwyL9RIS+Aa4hPrUyispTiNthHoUfXYtg==', 'sat_certificate': None, 'fiscal_folio': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 6, 59), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'xml_file_size': 5357, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:10,144 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml: Failed to save invoice to database
2025-07-19 14:47:10,947 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(40) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'details': '{"filename": "B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml", "processing_time": 2.7025797367095947, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.7025797367095947, 'memory_usage': None, 'filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 10, 341481)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:10,948 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(40) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'details': '{"filename": "B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml", "processing_time": 2.7025797367095947, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 2.7025797367095947, 'memory_usage': None, 'filename': 'B9061A21-B67A-41C7-A0B2-6EA24E281E7A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 10, 341481)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:15,062 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'series': None, 'folio': '52222', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 34, 11), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 14, 398048), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 14, 398052), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('206.900000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('33.100000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('240.000000'), 'digital_stamp': 'coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[:10]***MASKED***coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[-10:] ... (46 characters truncated) ... OXcfwHyoA9Bx99yeoIu7v9I/7DjZL9o/wJKjuMKQ6rFUK3zbehC5zTX4MfGWG/3+HKwMPC2B/gM1iBVmRw5NuuAPCkw8T5iE4+7PKcFzneLzUPn5hm+d6owe6EpG0BRyzAuqFqGN59Kq1ZJXKwg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'XvFKCYfPYPoGkwKTAYa2L+lvQQuQ0TueGBZRz6gCBY3ZFFfJQSIXpAm5tXUU/v7GPgWIFBaw/iCYH/lLnI2Pb6aE5ZGYOdrUH9mZPzIOfpnu8jcHNB7Ym/OKF8GvZkoW8PW3togWnsFsLeLnRAeEq ... (46 characters truncated) ... AcBxVlutJhP7YXN0HepTCsT+CUWVklPI4FkIP7u6GpB8LTRSkyo+lbsn4Abt9fs30h/WOu8t3emZnLaqnHMIpMy/9Oga8wPnFUOsfn+zG1Jq+t/ReoecvVkBM2msXBLCgUMaXIsSj5eaGKBhS1A==', 'sat_certificate': None, 'fiscal_folio': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 34, 12), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'xml_file_size': 5388, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:15,064 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(32) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'series': None, 'folio': '52222', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 17, 10, 34, 11), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 14, 398048), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 14, 398052), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('206.900000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('33.100000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('240.000000'), 'digital_stamp': 'coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[:10]***MASKED***coYXPIF4kkob1btiFp4FKQP9nly1eGdTlUKF3nVrDoDoOZbtBbPwq9u9qHkY6Da+erefN1jq93W3Fii8h5WrPFvem9ei52C7gTKbwMum2X+YleL0MfAP6UcRaO7Zlu+cV1sc9V1hjAbA/MV5KY881[-10:] ... (46 characters truncated) ... OXcfwHyoA9Bx99yeoIu7v9I/7DjZL9o/wJKjuMKQ6rFUK3zbehC5zTX4MfGWG/3+HKwMPC2B/gM1iBVmRw5NuuAPCkw8T5iE4+7PKcFzneLzUPn5hm+d6owe6EpG0BRyzAuqFqGN59Kq1ZJXKwg==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'XvFKCYfPYPoGkwKTAYa2L+lvQQuQ0TueGBZRz6gCBY3ZFFfJQSIXpAm5tXUU/v7GPgWIFBaw/iCYH/lLnI2Pb6aE5ZGYOdrUH9mZPzIOfpnu8jcHNB7Ym/OKF8GvZkoW8PW3togWnsFsLeLnRAeEq ... (46 characters truncated) ... AcBxVlutJhP7YXN0HepTCsT+CUWVklPI4FkIP7u6GpB8LTRSkyo+lbsn4Abt9fs30h/WOu8t3emZnLaqnHMIpMy/9Oga8wPnFUOsfn+zG1Jq+t/ReoecvVkBM2msXBLCgUMaXIsSj5eaGKBhS1A==', 'sat_certificate': None, 'fiscal_folio': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24', 'stamp_datetime': datetime.datetime(2025, 7, 17, 11, 34, 12), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'xml_file_size': 5388, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:15,065 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml: Failed to save invoice to database
2025-07-19 14:47:16,129 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(41) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'details': '{"filename": "CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml", "processing_time": 4.114545822143555, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.114545822143555, 'memory_usage': None, 'filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 15, 272357)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:16,130 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(41) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'details': '{"filename": "CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml", "processing_time": 4.114545822143555, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 4.114545822143555, 'memory_usage': None, 'filename': 'CCCAE06E-9FEB-42E3-BF0E-79311FE78E24.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 15, 272357)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:22,645 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'series': None, 'folio': '52274', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 9, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 21, 998363), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 21, 998367), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('373.910000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('43.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('416.940000'), 'digital_stamp': 'FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[:10]***MASKED***FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[-10:] ... (46 characters truncated) ... XkhBMP9K3UR36Y4axrhInWrwAAniQiJ018E+D8W99SyQEYEKBF4ur/69wkf+8NZc+epgpmCWoeUnH1RHAm08kzb+jjGzflqBqc9x0p906gZo3UJPOSnVPCRPMK9oWwOd95a7swYdT6T8rdXFKtw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'VhvI5rMMsVGoKz5l2rkOkPM7YjA5jqlHGyDDVU0kq0UQ1A5V2tZjLfbJdG/ovNHLJ0WjSWcuz7/GAHFiVvTqWLVBq2CACMOiRkWbNIINs0PoKBWNCU27XeBo3tavxSt+fJY0cox11Sttm3h0sg6yy ... (46 characters truncated) ... mA3cU/SsCsLLzsxn2XNFwzFd7PzSc8NfvntxhRBNzUiKwJkjsm4oIPFwawHqPiiRhtz+LrXZqk3e5ZTFRr5ZzLag+YOJBqjV5690Q7n8xBqgiaTB/yHia/KxxMN5gcZXUHG8A/pPbi9xbrdkxXw==', 'sat_certificate': None, 'fiscal_folio': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 9, 5), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'xml_file_size': 5865, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:22,646 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(33) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'series': None, 'folio': '52274', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 18, 12, 9, 5), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 21, 998363), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 21, 998367), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '99', 'payment_method_desc': None, 'payment_terms': 'PPD', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('373.910000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('43.030000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('416.940000'), 'digital_stamp': 'FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[:10]***MASKED***FrI11fwHF+4QmC8VvvlcmRPcqq1+9apIFie+AdbpVmFsS4pDmNwkmdsqwBQsujF/qdZ+pD06jk0xsFve2spItX2lsRWEnT4Sc3BxuprWmONAeqx7GrUd24Ed3HJE5gYWaGCS87BxU92YeajwYtLwy[-10:] ... (46 characters truncated) ... XkhBMP9K3UR36Y4axrhInWrwAAniQiJ018E+D8W99SyQEYEKBF4ur/69wkf+8NZc+epgpmCWoeUnH1RHAm08kzb+jjGzflqBqc9x0p906gZo3UJPOSnVPCRPMK9oWwOd95a7swYdT6T8rdXFKtw==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'VhvI5rMMsVGoKz5l2rkOkPM7YjA5jqlHGyDDVU0kq0UQ1A5V2tZjLfbJdG/ovNHLJ0WjSWcuz7/GAHFiVvTqWLVBq2CACMOiRkWbNIINs0PoKBWNCU27XeBo3tavxSt+fJY0cox11Sttm3h0sg6yy ... (46 characters truncated) ... mA3cU/SsCsLLzsxn2XNFwzFd7PzSc8NfvntxhRBNzUiKwJkjsm4oIPFwawHqPiiRhtz+LrXZqk3e5ZTFRr5ZzLag+YOJBqjV5690Q7n8xBqgiaTB/yHia/KxxMN5gcZXUHG8A/pPbi9xbrdkxXw==', 'sat_certificate': None, 'fiscal_folio': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68', 'stamp_datetime': datetime.datetime(2025, 7, 18, 13, 9, 5), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'xml_file_size': 5865, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:22,648 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml: Failed to save invoice to database
2025-07-19 14:47:23,495 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(42) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'details': '{"filename": "D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml", "processing_time": 6.51604962348938, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.51604962348938, 'memory_usage': None, 'filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 22, 852347)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:23,496 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(42) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'details': '{"filename": "D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml", "processing_time": 6.51604962348938, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 6.51604962348938, 'memory_usage': None, 'filename': 'D2F22A55-85F4-4941-BD22-DABCF9BE7F68.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 22, 852347)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:25,180 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'series': None, 'folio': '52011', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 40, 27), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 24, 543748), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 24, 543751), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('56.030000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('8.970000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('65.000000'), 'digital_stamp': 'LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[:10]***MASKED***LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[-10:] ... (46 characters truncated) ... 7CrY7Z9evQJzG4akjJauZ3VzbmZPtkIKauIeFASc2E8h1n1sAiqMbQG68hf0nRXBoEJvGu5Xti4sFtPSPcNYsjiSVU2hfuZxB88SABJptjjbzVRIu9NEapBx0Gk4gaWDSONzRSoKzdzRcgqSd/w==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mV2Xg7fAyiaeC/aI1hMvhnooib4tYHQVMuGQNwt6wLHjrQcfKoH8l/qXcly2j3QrpLe/fnRH9uUm4ZWgYex05lAC51KQnacN+hplGL2d2YGHWN235AIB6bWRJgyJigiNKGgdwTO6vDE7wWpQhg0ok ... (46 characters truncated) ... QXg/nr1vzXInuYePwwU1OMn+hMS9oFcBmfK8vkJqPIL1+liM7vVoAJcTs9x58I9acn42wTV8vjFxLRYr6GRzYqXiBYHzrfV0jaGZReEaE6cyoRgo/LzcBttV/fdpgXPMoFZjHeewwanHT13CHfA==', 'sat_certificate': None, 'fiscal_folio': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 40, 28), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'xml_file_size': 4999, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:25,182 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(34) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'series': None, 'folio': '52011', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 12, 11, 40, 27), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 24, 543748), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 24, 543751), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('56.030000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('8.970000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('65.000000'), 'digital_stamp': 'LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[:10]***MASKED***LClkjTQK3cNi3c2qzj7y8XBBE+jcQMwFdsOH2Wc1RgxVRNlfEfvfQBlbCOB1I82LW4MbpezTi5pwPYf2672YvAkH0iVUuz2Q1p5VZTR/xi7+Uc+EE2IxTeDwoRzJGmA3DzZTZFQrIdkihAv6pnYsm[-10:] ... (46 characters truncated) ... 7CrY7Z9evQJzG4akjJauZ3VzbmZPtkIKauIeFASc2E8h1n1sAiqMbQG68hf0nRXBoEJvGu5Xti4sFtPSPcNYsjiSVU2hfuZxB88SABJptjjbzVRIu9NEapBx0Gk4gaWDSONzRSoKzdzRcgqSd/w==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mV2Xg7fAyiaeC/aI1hMvhnooib4tYHQVMuGQNwt6wLHjrQcfKoH8l/qXcly2j3QrpLe/fnRH9uUm4ZWgYex05lAC51KQnacN+hplGL2d2YGHWN235AIB6bWRJgyJigiNKGgdwTO6vDE7wWpQhg0ok ... (46 characters truncated) ... QXg/nr1vzXInuYePwwU1OMn+hMS9oFcBmfK8vkJqPIL1+liM7vVoAJcTs9x58I9acn42wTV8vjFxLRYr6GRzYqXiBYHzrfV0jaGZReEaE6cyoRgo/LzcBttV/fdpgXPMoFZjHeewwanHT13CHfA==', 'sat_certificate': None, 'fiscal_folio': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A', 'stamp_datetime': datetime.datetime(2025, 7, 12, 12, 40, 28), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'xml_file_size': 4999, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:25,183 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml: Failed to save invoice to database
2025-07-19 14:47:26,017 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(43) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'details': '{"filename": "DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml", "processing_time": 1.6855149269104004, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.6855149269104004, 'memory_usage': None, 'filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 25, 380043)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:26,018 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(43) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'details': '{"filename": "DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml", "processing_time": 1.6855149269104004, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.6855149269104004, 'memory_usage': None, 'filename': 'DAFBE3B7-BEDE-4D25-8655-FC99E08BC51A.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 25, 380043)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:27,752 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(44) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'details': '{"filename": "DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml", "processing_time": 0.9084792137145996, "item_count": 0, "success": false, "error": "DUPLICATE: UUID DC82A272-2FA8-4F2F-A807-6B6F55BDF18E already exists"}', 'execution_time': 0.9084792137145996, 'memory_usage': None, 'filename': 'DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 27, 128185)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:27,753 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(44) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'details': '{"filename": "DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml", "processing_time": 0.9084792137145996, "item_count": 0, "success": false, "error": "DUPLICATE: UUID DC82A272-2FA8-4F2F-A807-6B6F55BDF18E already exists"}', 'execution_time': 0.9084792137145996, 'memory_usage': None, 'filename': 'DC82A272-2FA8-4F2F-A807-6B6F55BDF18E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 27, 128185)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:29,431 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(45) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'details': '{"filename": "E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml", "processing_time": 0.8523461818695068, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E11056BF-CB35-41B5-AF5B-CFB0E089A32E already exists"}', 'execution_time': 0.8523461818695068, 'memory_usage': None, 'filename': 'E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 28, 805515)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:29,432 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(45) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'details': '{"filename": "E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml", "processing_time": 0.8523461818695068, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E11056BF-CB35-41B5-AF5B-CFB0E089A32E already exists"}', 'execution_time': 0.8523461818695068, 'memory_usage': None, 'filename': 'E11056BF-CB35-41B5-AF5B-CFB0E089A32E.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 28, 805515)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:31,124 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(46) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'details': '{"filename": "E507A17F-A130-4C08-8B4F-0FD300D02C85.xml", "processing_time": 0.8669953346252441, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E507A17F-A130-4C08-8B4F-0FD300D02C85 already exists"}', 'execution_time': 0.8669953346252441, 'memory_usage': None, 'filename': 'E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 30, 509352)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:31,124 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(46) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'details': '{"filename": "E507A17F-A130-4C08-8B4F-0FD300D02C85.xml", "processing_time": 0.8669953346252441, "item_count": 0, "success": false, "error": "DUPLICATE: UUID E507A17F-A130-4C08-8B4F-0FD300D02C85 already exists"}', 'execution_time': 0.8669953346252441, 'memory_usage': None, 'filename': 'E507A17F-A130-4C08-8B4F-0FD300D02C85.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 30, 509352)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:32,790 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'series': None, 'folio': '52046', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 50, 14), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 32, 158337), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 32, 158340), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('12.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('12.500000'), 'digital_stamp': 'KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[:10]***MASKED***KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[-10:] ... (46 characters truncated) ... 4Dg6qzEMnuK/pqn6tsPdozJISu5bw0uXmJSMRQeWSYgjHbhooM/1r9as4EWgoUnoDplHDyJ+VP2mQc4ysk1YeJ8pH9Ap3YU+Hu/a7EwixU3/U4CgydP+Sc2vN5PZguivg2oIWy/Xok9tYa75XFA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mg1aXY/P9K8mDKOyxwlJ3Zrafn63Nwz1M45/LiAb3GjmDXbY1gaTSMDvVgnThauLS9x9yPmQkYP8E+RbojEVUuQHsl7D94Rb8O055szwW5OwWreLn45EYmg8fL/DBRdNrlY2IcFkmLYMg73HfmA2p ... (46 characters truncated) ... 0YRle7Rl3VlLaKv/8qYr3uz8S5z3cnDWYBoFvVHjnftAS1fdSzCCgu39RqKKnYTiMl6xBaKXmZGGs1c9w0NhSi0xVm/UHrjZIChq15xUkJH/xQohFrENKMwDebpWtMSYZ0CtiQn1bgj/+dU9A2A==', 'sat_certificate': None, 'fiscal_folio': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 50, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'xml_file_size': 4976, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:32,792 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(35) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'series': None, 'folio': '52046', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 13, 9, 50, 14), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 32, 158337), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 32, 158340), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('12.500000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('12.500000'), 'digital_stamp': 'KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[:10]***MASKED***KsRRLAMLN4ZLqsXoQdO+oWwutKzLOSUOZB6zzF/6Tjp4ESx7FtcyicliIZfVlJTYw/T9JUZKevXiDjlgHyXF1lJnXyJWcTlF8QrqMACabYwA27TZ1STfQ7C0zMceASDjKt9UnpfNPMHtBOTjXCLvw[-10:] ... (46 characters truncated) ... 4Dg6qzEMnuK/pqn6tsPdozJISu5bw0uXmJSMRQeWSYgjHbhooM/1r9as4EWgoUnoDplHDyJ+VP2mQc4ysk1YeJ8pH9Ap3YU+Hu/a7EwixU3/U4CgydP+Sc2vN5PZguivg2oIWy/Xok9tYa75XFA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'mg1aXY/P9K8mDKOyxwlJ3Zrafn63Nwz1M45/LiAb3GjmDXbY1gaTSMDvVgnThauLS9x9yPmQkYP8E+RbojEVUuQHsl7D94Rb8O055szwW5OwWreLn45EYmg8fL/DBRdNrlY2IcFkmLYMg73HfmA2p ... (46 characters truncated) ... 0YRle7Rl3VlLaKv/8qYr3uz8S5z3cnDWYBoFvVHjnftAS1fdSzCCgu39RqKKnYTiMl6xBaKXmZGGs1c9w0NhSi0xVm/UHrjZIChq15xUkJH/xQohFrENKMwDebpWtMSYZ0CtiQn1bgj/+dU9A2A==', 'sat_certificate': None, 'fiscal_folio': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28', 'stamp_datetime': datetime.datetime(2025, 7, 13, 10, 50, 15), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'xml_file_size': 4976, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:32,793 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml: Failed to save invoice to database
2025-07-19 14:47:33,608 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(47) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'details': '{"filename": "E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml", "processing_time": 1.666799783706665, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.666799783706665, 'memory_usage': None, 'filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 32, 991754)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:33,609 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(47) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'details': '{"filename": "E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml", "processing_time": 1.666799783706665, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 1.666799783706665, 'memory_usage': None, 'filename': 'E8C018C8-9115-4D32-854C-0C25DFF9FA28.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 32, 991754)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:35,259 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(48) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'details': '{"filename": "FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml", "processing_time": 0.8318397998809814, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FBDD0E56-11A1-49B9-95C2-FD243E95986B already exists"}', 'execution_time': 0.8318397998809814, 'memory_usage': None, 'filename': 'FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 34, 651219)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:35,259 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(48) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'details': '{"filename": "FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml", "processing_time": 0.8318397998809814, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FBDD0E56-11A1-49B9-95C2-FD243E95986B already exists"}', 'execution_time': 0.8318397998809814, 'memory_usage': None, 'filename': 'FBDD0E56-11A1-49B9-95C2-FD243E95986B.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 34, 651219)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:36,898 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(49) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'details': '{"filename": "FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml", "processing_time": 0.8267731666564941, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FDE6B84B-D0D2-481D-9F46-749D780FFFEE already exists"}', 'execution_time': 0.8267731666564941, 'memory_usage': None, 'filename': 'FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 36, 278749)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:36,899 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(49) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'details': '{"filename": "FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml", "processing_time": 0.8267731666564941, "item_count": 0, "success": false, "error": "DUPLICATE: UUID FDE6B84B-D0D2-481D-9F46-749D780FFFEE already exists"}', 'execution_time': 0.8267731666564941, 'memory_usage': None, 'filename': 'FDE6B84B-D0D2-481D-9F46-749D780FFFEE.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 36, 278749)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:44,018 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'series': None, 'folio': '52122', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 9, 23), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 43, 385483), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 43, 385486), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1740.240000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1740.240000'), 'digital_stamp': 'MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[:10]***MASKED***MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[-10:] ... (46 characters truncated) ... 5st48gWkrO/xnnIPLIpHiOppaDGikcfg7N+IasEFWP7/eB0wsLQuSmxpkSLVVzNu6kXkjdIOWJCHeGyUB4bvELD6+9U/CCaEbKzJ8u9SpoYZrSiqmRrkvt8ruImiWyB/F/jD/5ftv/jeBlGysaA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'RsFcCK9pbDCK5rAjnEkBgBAbXGWnP/+6LfLgsX9XDdM+4YshuPvO/OTs5EVyG1hOwPrb9duvfUkHm2Lqpnkp2NarPq4wtQKutbLwYhmH55qWE+334Jvr8Icd9TKIvn7F/gMqbtBcdSWfrUeX8/tsY ... (46 characters truncated) ... CdK+85IUChGYBO861Tz4YRTtjZr73FmJSSkC40e8HJOkpdMtwx4+E9Tx+GcZuvY40xEaK2grpnphEib5Kh9PQAHIjTMmISjtsaJdfIT6nl3mAqnmzcOWns147RHJVw9rdu6OCQZzLHVjaChrAGw==', 'sat_certificate': None, 'fiscal_folio': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 9, 24), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'xml_file_size': 12542, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:44,020 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "invoices_pkey"
DETAIL:  Key (id)=(36) already exists.

[SQL: INSERT INTO invoices (uuid, series, folio, invoice_type, version, issue_date, certification_date, created_at, updated_at, issuer_rfc, issuer_name, issuer_fiscal_regime, issuer_use_cfdi, issuer_residence, issuer_tax_id, receiver_rfc, receiver_name, receiver_fiscal_address, receiver_residence, receiver_tax_id, receiver_use_cfdi, payment_method, payment_method_desc, payment_terms, payment_conditions, currency, exchange_rate, subtotal, total_discount, total_transferred_taxes, total_withheld_taxes, total_amount, digital_stamp, certificate_number, certificate, sat_seal, sat_certificate, fiscal_folio, stamp_datetime, expedition_place, export_operation, confirmation, source_filename, xml_file_size, confidence_score, processing_time, processing_status) VALUES (%(uuid)s, %(series)s, %(folio)s, %(invoice_type)s, %(version)s, %(issue_date)s, %(certification_date)s, %(created_at)s, %(updated_at)s, %(issuer_rfc)s, %(issuer_name)s, %(issuer_fiscal_regime)s, %(issuer_use_cfdi)s, %(issuer_residence)s, %(issuer_tax_id)s, %(receiver_rfc)s, %(receiver_name)s, %(receiver_fiscal_address)s, %(receiver_residence)s, %(receiver_tax_id)s, %(receiver_use_cfdi)s, %(payment_method)s, %(payment_method_desc)s, %(payment_terms)s, %(payment_conditions)s, %(currency)s, %(exchange_rate)s, %(subtotal)s, %(total_discount)s, %(total_transferred_taxes)s, %(total_withheld_taxes)s, %(total_amount)s, %(digital_stamp)s, %(certificate_number)s, %(certificate)s, %(sat_seal)s, %(sat_certificate)s, %(fiscal_folio)s, %(stamp_datetime)s, %(expedition_place)s, %(export_operation)s, %(confirmation)s, %(source_filename)s, %(xml_file_size)s, %(confidence_score)s, %(processing_time)s, %(processing_status)s) RETURNING invoices.id]
[parameters: {'uuid': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'series': None, 'folio': '52122', 'invoice_type': 'I', 'version': '4.0', 'issue_date': datetime.datetime(2025, 7, 15, 11, 9, 23), 'certification_date': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 43, 385483), 'updated_at': datetime.datetime(2025, 7, 19, 21, 47, 43, 385486), 'issuer_rfc': 'PIVV******RR4', 'issuer_name': 'VANESSA IVON PIÑUELAS VERDUGO', 'issuer_fiscal_regime': '612', 'issuer_use_cfdi': None, 'issuer_residence': None, 'issuer_tax_id': None, 'receiver_rfc': 'YUGY******FK4', 'receiver_name': 'YASSER YUSSIF GONZALEZ', 'receiver_fiscal_address': '23300', 'receiver_residence': None, 'receiver_tax_id': None, 'receiver_use_cfdi': None, 'payment_method': '03', 'payment_method_desc': None, 'payment_terms': 'PUE', 'payment_conditions': None, 'currency': 'MXN', 'exchange_rate': Decimal('1.000000'), 'subtotal': Decimal('1740.240000'), 'total_discount': Decimal('0'), 'total_transferred_taxes': Decimal('0.000000'), 'total_withheld_taxes': Decimal('0.000000'), 'total_amount': Decimal('1740.240000'), 'digital_stamp': 'MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[:10]***MASKED***MunvZrE6/VednuMH6sj9dM9D/OWcc73gDz6Stthb/0japkL7o07fT8TIRO0uBOOj3ISWjSPqgriu0NPeC2zxlMilyvq3Xpuw9wEww8LJJ7uGLc2KjaYOZc8uzBg6986kUfXAA35zEEuSDEQxPmM9b[-10:] ... (46 characters truncated) ... 5st48gWkrO/xnnIPLIpHiOppaDGikcfg7N+IasEFWP7/eB0wsLQuSmxpkSLVVzNu6kXkjdIOWJCHeGyUB4bvELD6+9U/CCaEbKzJ8u9SpoYZrSiqmRrkvt8ruImiWyB/F/jD/5ftv/jeBlGysaA==', 'certificate_number': '00001000000705018977', 'certificate': None, 'sat_seal': 'RsFcCK9pbDCK5rAjnEkBgBAbXGWnP/+6LfLgsX9XDdM+4YshuPvO/OTs5EVyG1hOwPrb9duvfUkHm2Lqpnkp2NarPq4wtQKutbLwYhmH55qWE+334Jvr8Icd9TKIvn7F/gMqbtBcdSWfrUeX8/tsY ... (46 characters truncated) ... CdK+85IUChGYBO861Tz4YRTtjZr73FmJSSkC40e8HJOkpdMtwx4+E9Tx+GcZuvY40xEaK2grpnphEib5Kh9PQAHIjTMmISjtsaJdfIT6nl3mAqnmzcOWns147RHJVw9rdu6OCQZzLHVjaChrAGw==', 'sat_certificate': None, 'fiscal_folio': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF', 'stamp_datetime': datetime.datetime(2025, 7, 15, 12, 9, 24), 'expedition_place': None, 'export_operation': None, 'confirmation': None, 'source_filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'xml_file_size': 12542, 'confidence_score': None, 'processing_time': None, 'processing_status': 'processed'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:44,021 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml: Failed to save invoice to database
2025-07-19 14:47:44,846 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(50) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'details': '{"filename": "FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml", "processing_time": 7.120465993881226, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.120465993881226, 'memory_usage': None, 'filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 44, 219881)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:44,847 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(50) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'details': '{"filename": "FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml", "processing_time": 7.120465993881226, "item_count": 0, "success": false, "error": "Failed to save invoice to database"}', 'execution_time': 7.120465993881226, 'memory_usage': None, 'filename': 'FEDAA6F6-8DFE-475B-9875-530CF5EB5CFF.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 44, 219881)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:46,488 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(51) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'details': '{"filename": "db7ca908-83b2-49ab-8c86-649a9b9ba470.xml", "processing_time": 0.8251588344573975, "item_count": 0, "success": false, "error": "DUPLICATE: UUID db7ca908-83b2-49ab-8c86-649a9b9ba470 already exists"}', 'execution_time': 0.8251588344573975, 'memory_usage': None, 'filename': 'db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 45, 872980)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-19 14:47:46,489 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "processing_logs_pkey"
DETAIL:  Key (id)=(51) already exists.

[SQL: INSERT INTO processing_logs (invoice_id, log_level, component, operation, message, details, execution_time, memory_usage, filename, item_line_number, created_at) VALUES (%(invoice_id)s, %(log_level)s, %(component)s, %(operation)s, %(message)s, %(details)s::JSON, %(execution_time)s, %(memory_usage)s, %(filename)s, %(item_line_number)s, %(created_at)s) RETURNING processing_logs.id]
[parameters: {'invoice_id': None, 'log_level': 'ERROR', 'component': 'batch_processor', 'operation': 'process_file', 'message': 'Failed to process db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'details': '{"filename": "db7ca908-83b2-49ab-8c86-649a9b9ba470.xml", "processing_time": 0.8251588344573975, "item_count": 0, "success": false, "error": "DUPLICATE: UUID db7ca908-83b2-49ab-8c86-649a9b9ba470 already exists"}', 'execution_time': 0.8251588344573975, 'memory_usage': None, 'filename': 'db7ca908-83b2-49ab-8c86-649a9b9ba470.xml', 'item_line_number': None, 'created_at': datetime.datetime(2025, 7, 19, 21, 47, 45, 872980)}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-07-29 17:56:25,148 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:56:25,149 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Error checking duplicate for UUID 12A18CCF-E484-4793-91B1-53E33B4814B1: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:56:44,870 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:56:44,871 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_14c77eea_50414500_kale: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:56:47,275 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_09573e71_50417006_arugula: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:48,692 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f6ce5c99_50404600_lechuga_mixta: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:50,612 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_6b45f921_50404600_lechuga_romana_baby: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:52,222 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_4770c1ef_50402800_acelga: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:53,710 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_11cd495e_50401700_aguacate: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:55,307 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_c1ceb28c_50221002_harina_selecta: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:57,055 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_bd6f7e4b_50112010_pierna_de_pollo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:56:58,740 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9d78fad1_50404100_perejil_liso: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:57:00,454 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a88cb11c_50402500_zanahoria: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:57:01,920 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:57:23,779 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:57:23,780 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:57:23,780 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 12A18CCF-E484-4793-91B1-53E33B4814B1.xml: Failed to save invoice to database
2025-07-29 17:57:43,500 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:57:43,501 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:58:03,450 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:58:03,450 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Error checking duplicate for UUID 2DF504B2-C78F-461B-931F-9B9D2C51E155: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:58:03,451 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e3b92121_81141601_servicios_integrales_de_logistica_v0: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:58:24,702 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:58:24,703 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:58:24,703 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 2DF504B2-C78F-461B-931F-9B9D2C51E155.xml: Failed to save invoice to database
2025-07-29 17:58:44,675 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:58:44,676 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:59:04,383 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:59:04,383 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Error checking duplicate for UUID 40231da6-e4d7-40ea-b78f-f7eabc4efb9e: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:59:04,384 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9758ee3a_50131800_queso_ricotta_belgioioso_cube_226kg_180: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:06,497 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e901a8d6_50307213_aceituna_kalamata_shueso_mid_east_2kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:08,123 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_6d91e188_50112009_jamon_serrano_rebanado_far_500gr_14846: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:09,828 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_71a083bd_50221002_harina_higluten_sir_lancelot_ka_3052_lb: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:11,851 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e2dd89d6_50406500_tomate_entero_pelado_piancone_289kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:13,755 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_8d0019cc_50151513_aceite_oliva_pomace_genco_plast_378_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:15,173 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_84019792_50367218_aceituna_manzmorron_destino_227_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:17,262 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_dfb48d26_50151513_aceite_vegetal_king_fry_cero_20lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 17:59:39,198 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:59:39,199 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:59:39,199 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 40231da6-e4d7-40ea-b78f-f7eabc4efb9e.xml: Failed to save invoice to database
2025-07-29 17:59:58,906 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 17:59:58,907 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:00:18,892 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:00:18,893 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Error checking duplicate for UUID 52305A60-466D-4FC8-8FD4-D38F8E3FD7F3: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:00:18,894 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_1f4e72fe_50202200_licor_campari_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:20,701 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_fea1842c_50202207_licor_aperol_700_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:22,684 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_bf0e5c87_50202310_agua_peafiel_175_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:24,227 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_b82361ec_52152102_vaso_vicrila_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:26,126 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_90227216_52152001_jarra_glassia_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:27,752 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_391690ea_50202205_vino_cinzano_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:29,570 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_ed3b6142_24101510_contenedor_plastic_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:31,275 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f8a2f1d9_52152001_vaso_rosan_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:32,916 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_1e732763_50202200_vermouth_cinzano_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:34,376 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_cdbb35fc_50202301_agua_ciel_15_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:36,319 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_38306929_50202201_cerveza_samuel_adams_473_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:37,636 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_b3fa37ae_52152104_copa_glassia_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:39,188 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_0d47ce79_50202200_licor_fernet_branca_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:40,876 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_843459c8_47131600_fibra_vileda_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:00:42,682 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_0e6607c2_52151600_pinza_la_reina_del_hogar_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:01:04,197 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:01:04,198 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:01:04,198 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 52305A60-466D-4FC8-8FD4-D38F8E3FD7F3.xml: Failed to save invoice to database
2025-07-29 18:01:23,908 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:01:23,908 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Failed to log processing result: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:01:43,894 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:01:43,894 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Error checking duplicate for UUID 5AEBB621-B005-4032-B182-E5AB714B4912: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:01:43,895 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9694c503_50403500_berenjena: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:01:45,495 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_2c4b8293_50401800_frijol_refrito_negros: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:01:47,711 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_69568bdb_50202301_agua_gasificada: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:01:49,402 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9cbcb068_50405104_tomatillo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:01:50,818 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_3760e993_50171800_queso_crema_philadelfhia: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:01:52,521 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e8e5b06d_50221001_arroz_verde_valle: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:02:14,606 - src.data.database - ERROR - File: database.py - File: database.py - File: database.py - File: database.py - File: database.py - Database session error: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:02:14,607 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - Database save failed: (psycopg2.OperationalError) connection to server at "db-postgresql-ams3-84868-do-user-23729043-0.l.db.ondigitalocean.com" (164.90.192.177), port 25060 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-29 18:02:14,607 - src.processing.batch_processor - ERROR - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - File: batch_processor.py - [ERROR] Failed to process 5AEBB621-B005-4032-B182-E5AB714B4912.xml: Failed to save invoice to database
2025-07-29 18:16:22,524 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_2c4b8293_50401800_frijol_refrito_negros: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:16:24,513 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_69568bdb_50202301_agua_gasificada: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:16:26,166 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9cbcb068_50405104_tomatillo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:16:27,420 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_3760e993_50171800_queso_crema_philadelfhia: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:16:28,816 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e8e5b06d_50221001_arroz_verde_valle: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:22,545 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_09573e71_50417006_arugula: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:24,185 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f6ce5c99_50404600_lechuga_mixta: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:26,132 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_6b45f921_50404600_lechuga_romana_baby: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:27,488 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_4770c1ef_50402800_acelga: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:28,707 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_11cd495e_50401700_aguacate: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:30,245 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_c1ceb28c_50221002_harina_selecta: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:31,749 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_bd6f7e4b_50112010_pierna_de_pollo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:32,991 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9d78fad1_50404100_perejil_liso: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:34,394 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a88cb11c_50402500_zanahoria: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:35,576 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:45,749 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_1f4e72fe_50202200_licor_campari_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:47,228 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_fea1842c_50202207_licor_aperol_700_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:48,692 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_bf0e5c87_50202310_agua_peafiel_175_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:50,131 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_b82361ec_52152102_vaso_vicrila_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:51,373 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_90227216_52152001_jarra_glassia_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:52,698 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_391690ea_50202205_vino_cinzano_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:54,305 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_ed3b6142_24101510_contenedor_plastic_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:55,654 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f8a2f1d9_52152001_vaso_rosan_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:57,193 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_1e732763_50202200_vermouth_cinzano_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:17:58,547 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_cdbb35fc_50202301_agua_ciel_15_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:00,302 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_38306929_50202201_cerveza_samuel_adams_473_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:01,654 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_b3fa37ae_52152104_copa_glassia_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:02,879 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_0d47ce79_50202200_licor_fernet_branca_750_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:06,045 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_843459c8_47131600_fibra_vileda_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:07,885 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_0e6607c2_52151600_pinza_la_reina_del_hogar_1_pza: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:16,130 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a5f46d94_50131800_queso_mozzarella_rdo_grande_227kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:17,708 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_3bc1d59c_14111703_toalla_interdoblada_sanitas_20100pz: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:24,116 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_4d8ff92b_50404600_lechuga_bola: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:25,799 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_4bbffe27_50131612_huevo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:27,576 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_80bf8a82_50401900_betabel: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:28,893 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_75903dde_50404803_champiñon: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:30,274 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_4c4ccb55_50405625_jalapeño: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:31,866 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_13ef3cfa_53131608_jabon_axion: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:33,085 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_c0496069_50406500_tomate_salades: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:34,579 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_3823c19d_50405300_cebolla_blanca: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:36,237 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_15acbdb3_50404125_tomillo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:37,673 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_65d00f8a_50404101_albahaca: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:39,292 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_93d1e48d_50405600_morron_rojo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:40,601 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_547ba3ea_50171551_sal_la_fina: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:41,914 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_ffa51a90_50131800_queso_mozzarella: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:48,143 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_fdb96f1d_50131700_crema_acida_500ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:50,043 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_2cfb47f3_50131800_queso_manchego: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:51,406 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_5fdb5cfc_47131821_desengrasante_liquido: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:18:52,879 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_41aa2a1f_50191500_sopa_barilla_espaguetti_500gr: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:02,289 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9a57e1c2_50304100_limon_sin_semilla: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:08,746 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_3c681831_50111500_costillas_baby_back_de_cerdo_swift_costil: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:15,340 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_5f188ef1_50131800_queso_cabra: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:16,915 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f355fb89_50403800_ajo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:18,370 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9f7ef12b_52121602_servilleta_delsey: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:19,913 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_70ae329c_50301500_manzana_verde: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:26,604 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_141a86f5_10161506_naranja: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:33,732 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_561f6ebe_50404114_menta: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:35,070 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_880e50ef_50171548_romero: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:36,360 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_07ae298e_50304100_limon_amarillo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:37,703 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a61a9167_24111503_bolsa_basura_negras: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:44,193 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_41ff9b27_50404106_cilantro: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:45,485 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_6e09edc1_50171548_chai: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:47,511 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_5a200fb8_50131800_queso_cheddar_cheddar_fuerte: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:48,891 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f95bb8a3_50307024_pepino: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:50,102 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_bb7381f7_50171800_capsup_heinz: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:51,565 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_14ba8258_50404800_jengibre: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:53,079 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_d8b29b14_53131608_jabon_roma_5kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:54,568 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_202902ee_50151605_manteca_kuino_1kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:55,909 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_dcdec2fc_50151605_manteca_kuino_12: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:19:57,094 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a4789c1d_50307200_aceituna_sin_hueso: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:03,418 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_eecad753_50181708_levadura_rojo: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:04,784 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_44f0bbec_50403900_calabaza_negra: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:06,056 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9694c503_50403500_berenjena: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:12,234 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a27a1c68_24111503_vitafil: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:13,545 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_6ec9c23c_50405625_chile_jalapeño: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:15,020 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_a11bdc4e_50112009_tocino_kirkland: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:21,320 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_05104581_50112004_carne_de_deshebrar: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:23,061 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_5261c9e9_50403900_calabacita: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:24,458 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e943c485_50221001_arroz: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:30,943 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_c5538cbc_50202306_coca_cola_lata_355_ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:32,565 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_44259369_50202310_topochico_355mil_vidrio: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:39,192 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_eca51e58_50202201_bohemia_obscura_obscura_4x6_bot_355ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:40,504 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_41de13be_50202201_bohemia_cristal_4x6_bot_355ml: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:46,726 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9758ee3a_50131800_queso_ricotta_belgioioso_cube_226kg_180: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:48,172 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f9d3f52a_50131700_mantequilla_ssal_challenge_454gr: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:49,588 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_8330c5d1_50112023_salami_deshidratado_molinari_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:50,900 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_0356f92a_50221300_harina_artisan_sir_galahad_ka_3028_50lb: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:52,327 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_71a083bd_50221002_harina_higluten_sir_lancelot_ka_3052_lb: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:54,391 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9e127426_50171830_peperoncini_del_destino_379lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:55,676 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_2a368b68_50406500_tomate_san_marzano_di_napoli_289_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:57,204 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_1789b909_50151500_aceite_puro_de_palma_palmina_20lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:20:58,652 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e0ea9ff1_50367024_pepinillo_rebanado_san_miguel_394_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-07-29 18:21:00,559 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_cac0d44d_50171832_mayonesa_wilsey_imp_378_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:40:45,546 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_45f8bf30_50193105_pan_molido_clasico: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:40:47,821 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_4d8ff92b_50404600_lechuga_bola: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:40:49,128 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_5ac938a8_50221300_tortilla_maiz: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:40:55,116 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_428a499a_53103000_play_cab_bones_cr_mc_3700m_verde_olivo_2x: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:40:57,669 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_56bd5e1c_53103000_play_cab_bones_cr_mc_3700m_canela_vintage: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:41:03,474 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e3b92121_81141601_servicios_integrales_de_logistica_v0: '_GeneratorContextManager' object has no attribute 'args'
2025-07-30 13:41:09,051 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_14c77eea_50414500_kale: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:42,952 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9b6e4c31_50131800_queso_parmesano_en_cuartos_grande_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:44,986 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_8330c5d1_50112023_salami_deshidratado_molinari_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:46,387 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_f9d3f52a_50131700_mantequilla_ssal_challenge_454gr: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:47,938 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_c77c74c9_50171800_ketchup_bolsa_heinz_3kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:49,652 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_39ed0331_50171550_especia_pimienta_negra_molida_454gr_80217: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:51,331 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_de114efd_50192900_pasta_de_ajonjoli_tahini_roland_907gr: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:52,962 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_9e127426_50171830_peperoncini_del_destino_379lt: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:54,226 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_cac0d44d_50171832_mayonesa_wilsey_imp_378_lt: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:55,500 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_e0ea9ff1_50367024_pepinillo_rebanado_san_miguel_394_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:57,414 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_850bbd66_10151600_arroz_arborio_agronature_1kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:52:58,645 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_2a368b68_50406500_tomate_san_marzano_di_napoli_289_kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-01 14:53:00,054 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_cd6eaffd_50171551_curador_psalchicha_1_maker_2lb: '_GeneratorContextManager' object has no attribute 'args'
2025-08-04 18:01:26,294 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_141a86f5_10161506_naranja: '_GeneratorContextManager' object has no attribute 'args'
2025-08-04 18:01:27,894 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_64cd09d0_50202302_hielo_bolsa_de_hielo_5kg: '_GeneratorContextManager' object has no attribute 'args'
2025-08-04 18:01:29,123 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_8e2d1945_50202301_agua_peñafil_sifon: '_GeneratorContextManager' object has no attribute 'args'
2025-08-07 11:37:47,941 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_58a6dd02_50112009_jamon_cerdo_kowi: '_GeneratorContextManager' object has no attribute 'args'
2025-08-07 11:37:50,812 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_533a5897_50221300_tortilla_de_harina: '_GeneratorContextManager' object has no attribute 'args'
2025-08-07 11:37:52,671 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_3823c19d_50405300_cebolla_blanca: '_GeneratorContextManager' object has no attribute 'args'
2025-08-07 11:37:59,986 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_32602b39_50111500_pepperoni_rebanado_tyson_pescadero_62: '_GeneratorContextManager' object has no attribute 'args'
2025-08-07 11:38:01,669 - src.processing.gemini_classifier - ERROR - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - [gemini_classifier] File: gemini_classifier.py - Error checking approved SKU sku_b7d7513f_50111500_costillas_baby_back_de_cerdo_swift_costil: '_GeneratorContextManager' object has no attribute 'args'
